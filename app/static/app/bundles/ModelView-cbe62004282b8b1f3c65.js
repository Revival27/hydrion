/*! For license information please see ModelView-cbe62004282b8b1f3c65.js.LICENSE.txt */
(()=>{var t={4378:t=>{t.exports={gettext:window.gettext,_:window.gettext,interpolate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return window.interpolate(t,e,!0)},get_format:function(t){return window.get_format(t)}}},4177:()=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}var e=THREE,n=e.BufferAttribute,o=e.BufferGeometry,i=e.FileLoader,r=e.Loader,s=function(t){r.call(this,t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};s.prototype=Object.assign(Object.create(r.prototype),{constructor:s,setDecoderPath:function(t){return this.decoderPath=t,this},setDecoderConfig:function(t){return this.decoderConfig=t,this},setWorkerLimit:function(t){return this.workerLimit=t,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(t,e,n,o){var r=this,s=new i(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(t){var n={attributeIDs:r.defaultAttributeIDs,attributeTypes:r.defaultAttributeTypes,useUniqueIDs:!1};r.decodeGeometry(t,n).then(e).catch(o)}),n,o)},decodeDracoFile:function(t,e,n,o){var i={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:o||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(t,i).then(e)},decodeGeometry:function(t,e){var n=this;for(var o in e.attributeTypes){var i=e.attributeTypes[o];void 0!==i.BYTES_PER_ELEMENT&&(e.attributeTypes[o]=i.name)}var r,a=JSON.stringify(e);if(s.taskCache.has(t)){var l=s.taskCache.get(t);if(l.key===a)return l.promise;if(0===t.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var u=this.workerNextTaskID++,c=t.byteLength,h=this._getWorker(u,c).then((function(n){return r=n,new Promise((function(n,o){r._callbacks[u]={resolve:n,reject:o},r.postMessage({type:"decode",id:u,taskConfig:e,buffer:t},[t])}))})).then((function(t){return n._createGeometry(t.geometry)}));return h.catch((function(){return!0})).then((function(){r&&u&&n._releaseTask(r,u)})),s.taskCache.set(t,{key:a,promise:h}),h},_createGeometry:function(t){var e=new o;t.index&&e.setIndex(new n(t.index.array,1));for(var i=0;i<t.attributes.length;i++){var r=t.attributes[i],s=r.name,a=r.array,l=r.itemSize;e.setAttribute(s,new n(a,l))}return e},_loadLibrary:function(t,e){var n=new i(this.manager);return n.setPath(this.decoderPath),n.setResponseType(e),n.setWithCredentials(this.withCredentials),new Promise((function(e,o){n.load(t,e,void 0,o)}))},preload:function(){return this._initDecoder(),this},_initDecoder:function(){var e=this;if(this.decoderPending)return this.decoderPending;var n="object"!==("undefined"==typeof WebAssembly?"undefined":t(WebAssembly))||"js"===this.decoderConfig.type,o=[];return n?o.push(this._loadLibrary("draco_decoder.js","text")):(o.push(this._loadLibrary("draco_wasm_wrapper.js","text")),o.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(o).then((function(t){var o=t[0];n||(e.decoderConfig.wasmBinary=t[1]);var i=s.DRACOWorker.toString(),r=["/* draco decoder */",o,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([r]))})),this.decoderPending},_getWorker:function(t,e){var n=this;return this._initDecoder().then((function(){var o;return n.workerPool.length<n.workerLimit?((o=new Worker(n.workerSourceURL))._callbacks={},o._taskCosts={},o._taskLoad=0,o.postMessage({type:"init",decoderConfig:n.decoderConfig}),o.onmessage=function(t){var e=t.data;switch(e.type){case"decode":o._callbacks[e.id].resolve(e);break;case"error":o._callbacks[e.id].reject(e);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+e.type+'"')}},n.workerPool.push(o)):n.workerPool.sort((function(t,e){return t._taskLoad>e._taskLoad?-1:1})),(o=n.workerPool[n.workerPool.length-1])._taskCosts[t]=e,o._taskLoad+=e,o}))},_releaseTask:function(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]},debug:function(){console.log("Task load: ",this.workerPool.map((function(t){return t._taskLoad})))},dispose:function(){for(var t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this}}),s.DRACOWorker=function(){var t,e;function n(t,e,n,o,i,r){var s=r.num_components(),a=n.num_points()*s,l=a*i.BYTES_PER_ELEMENT,u=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32}}(t,i),c=t._malloc(l);e.GetAttributeDataArrayForAllPoints(n,r,u,l,c);var h=new i(t.HEAPF32.buffer,c,a).slice();return t._free(c),{name:o,array:h,itemSize:s}}onmessage=function(o){var i=o.data;switch(i.type){case"init":t=i.decoderConfig,e=new Promise((function(e){t.onModuleLoaded=function(t){e({draco:t})},DracoDecoderModule(t)}));break;case"decode":var r=i.buffer,s=i.taskConfig;e.then((function(t){var e=t.draco,o=new e.Decoder,a=new e.DecoderBuffer;a.Init(new Int8Array(r),r.byteLength);try{var l=function(t,e,o,i){var r,s,a=i.attributeIDs,l=i.attributeTypes,u=e.GetEncodedGeometryType(o);if(u===t.TRIANGULAR_MESH)r=new t.Mesh,s=e.DecodeBufferToMesh(o,r);else{if(u!==t.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");r=new t.PointCloud,s=e.DecodeBufferToPointCloud(o,r)}if(!s.ok()||0===r.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+s.error_msg());var c={index:null,attributes:[]};for(var h in a){var p,f,d=self[l[h]];if(i.useUniqueIDs)f=a[h],p=e.GetAttributeByUniqueId(r,f);else{if(-1===(f=e.GetAttributeId(r,t[a[h]])))continue;p=e.GetAttribute(r,f)}c.attributes.push(n(t,e,r,h,d,p))}return u===t.TRIANGULAR_MESH&&(c.index=function(t,e,n){var o=3*n.num_faces(),i=4*o,r=t._malloc(i);e.GetTrianglesUInt32Array(n,i,r);var s=new Uint32Array(t.HEAPF32.buffer,r,o).slice();return t._free(r),{array:s,itemSize:1}}(t,e,r)),t.destroy(r),c}(e,o,a,s),u=l.attributes.map((function(t){return t.array.buffer}));l.index&&u.push(l.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:l},u)}catch(t){console.error(t),self.postMessage({type:"error",id:i.id,error:t.message})}finally{e.destroy(a),e.destroy(o)}}))}}},s.taskCache=new WeakMap,s.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},s.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},s.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},s.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")},THREE.DRACOLoader=s},4499:()=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}var e=THREE,n=e.AnimationClip,o=e.Bone,i=e.Box3,r=e.BufferAttribute,s=e.BufferGeometry,a=e.CanvasTexture,l=e.ClampToEdgeWrapping,u=e.Color,c=e.DirectionalLight,h=e.DoubleSide,p=e.FileLoader,f=e.FrontSide,d=e.Group,m=e.ImageBitmapLoader,_=e.InterleavedBuffer,v=e.InterleavedBufferAttribute,g=e.Interpolant,y=e.InterpolateDiscrete,b=e.InterpolateLinear,w=e.Line,x=e.LineBasicMaterial,T=e.LineLoop,E=e.LineSegments,P=e.LinearFilter,L=e.LinearMipmapLinearFilter,S=e.LinearMipmapNearestFilter,k=e.Loader,M=e.LoaderUtils,C=e.Material,O=e.MathUtils,A=e.Matrix4,R=e.Mesh,j=e.MeshBasicMaterial,I=e.MeshPhysicalMaterial,B=e.MeshStandardMaterial,D=e.MirroredRepeatWrapping,N=e.NearestFilter,z=e.NearestMipmapLinearFilter,F=e.NearestMipmapNearestFilter,H=e.NumberKeyframeTrack,Z=e.Object3D,U=e.OrthographicCamera,G=e.PerspectiveCamera,V=e.PointLight,W=e.Points,q=e.PointsMaterial,K=e.PropertyBinding,X=e.QuaternionKeyframeTrack,$=e.RGBFormat,J=e.RepeatWrapping,Y=e.Skeleton,Q=e.SkinnedMesh,tt=e.Sphere,et=e.SpotLight,nt=e.TangentSpaceNormalMap,ot=e.TextureLoader,it=e.TriangleFanDrawMode,rt=e.TriangleStripDrawMode,st=e.Vector2,at=e.Vector3,lt=e.VectorKeyframeTrack,ut=(e.sRGBEncoding,function(){function e(t){k.call(this,t),this.dracoLoader=null,this.ddsLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(t){return new dt(t)})),this.register((function(t){return new _t(t)})),this.register((function(t){return new vt(t)})),this.register((function(t){return new mt(t)})),this.register((function(t){return new pt(t)})),this.register((function(t){return new gt(t)}))}function ut(){var t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}e.prototype=Object.assign(Object.create(k.prototype),{constructor:e,load:function(t,e,n,o){var i,r=this;i=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:M.extractUrlBase(t),this.manager.itemStart(t);var s=function(e){o?o(e):console.error(e),r.manager.itemError(t),r.manager.itemEnd(t)},a=new p(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,(function(n){try{r.parse(n,i,(function(n){e(n),r.manager.itemEnd(t)}),s)}catch(t){s(t)}}),n,s)},setDRACOLoader:function(t){return this.dracoLoader=t,this},setDDSLoader:function(t){return this.ddsLoader=t,this},setKTX2Loader:function(t){return this.ktx2Loader=t,this},setMeshoptDecoder:function(t){return this.meshoptDecoder=t,this},register:function(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this},unregister:function(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this},parse:function(t,e,n,o){var i,r={},s={};if("string"==typeof t)i=t;else if(M.decodeText(new Uint8Array(t,0,4))===yt){try{r[ct.KHR_BINARY_GLTF]=new xt(t)}catch(t){return void(o&&o(t))}i=r[ct.KHR_BINARY_GLTF].content}else i=M.decodeText(new Uint8Array(t));var a=JSON.parse(i);if(void 0===a.asset||a.asset.version[0]<2)o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var l=new Zt(a,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(var u=0;u<this.pluginCallbacks.length;u++){var c=this.pluginCallbacks[u](l);s[c.name]=c,r[c.name]=!0}if(a.extensionsUsed)for(u=0;u<a.extensionsUsed.length;++u){var h=a.extensionsUsed[u],p=a.extensionsRequired||[];switch(h){case ct.KHR_MATERIALS_UNLIT:r[h]=new ft;break;case ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:r[h]=new St;break;case ct.KHR_DRACO_MESH_COMPRESSION:r[h]=new Et(a,this.dracoLoader);break;case ct.MSFT_TEXTURE_DDS:r[h]=new ht(this.ddsLoader);break;case ct.KHR_TEXTURE_TRANSFORM:r[h]=new Pt;break;case ct.KHR_MESH_QUANTIZATION:r[h]=new kt;break;case ct.CESIUM_RTC:r[h]=new Tt(a);break;default:p.indexOf(h)>=0&&void 0===s[h]&&console.warn('THREE.GLTFLoader: Unknown extension "'+h+'".')}}l.setExtensions(r),l.setPlugins(s),l.parse(n,o)}}});var ct={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",MSFT_TEXTURE_DDS:"MSFT_texture_dds",CESIUM_RTC:"CESIUM_RTC"};function ht(t){if(!t)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=ct.MSFT_TEXTURE_DDS,this.ddsLoader=t}function pt(t){this.parser=t,this.name=ct.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function ft(){this.name=ct.KHR_MATERIALS_UNLIT}function dt(t){this.parser=t,this.name=ct.KHR_MATERIALS_CLEARCOAT}function mt(t){this.parser=t,this.name=ct.KHR_MATERIALS_TRANSMISSION}function _t(t){this.parser=t,this.name=ct.KHR_TEXTURE_BASISU}function vt(t){this.parser=t,this.name=ct.EXT_TEXTURE_WEBP,this.isSupported=null}function gt(t){this.name=ct.EXT_MESHOPT_COMPRESSION,this.parser=t}pt.prototype._markDefs=function(){for(var t=this.parser,e=this.parser.json.nodes||[],n=0,o=e.length;n<o;n++){var i=e[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&t._addNodeRef(this.cache,i.extensions[this.name].light)}},pt.prototype._loadLight=function(t){var e=this.parser,n="light:"+t,o=e.cache.get(n);if(o)return o;var i,r=e.json,s=((r.extensions&&r.extensions[this.name]||{}).lights||[])[t],a=new u(16777215);void 0!==s.color&&a.fromArray(s.color);var l=void 0!==s.range?s.range:0;switch(s.type){case"directional":(i=new c(a)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new V(a)).distance=l;break;case"spot":(i=new et(a)).distance=l,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,i.angle=s.spot.outerConeAngle,i.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return i.position.set(0,0,0),i.decay=2,void 0!==s.intensity&&(i.intensity=s.intensity),i.name=e.createUniqueName(s.name||"light_"+t),o=Promise.resolve(i),e.cache.add(n,o),o},pt.prototype.createNodeAttachment=function(t){var e=this,n=this.parser,o=n.json.nodes[t],i=(o.extensions&&o.extensions[this.name]||{}).light;return void 0===i?null:this._loadLight(i).then((function(t){return n._getNodeRef(e.cache,i,t)}))},ft.prototype.getMaterialType=function(){return j},ft.prototype.extendParams=function(t,e,n){var o=[];t.color=new u(1,1,1),t.opacity=1;var i=e.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var r=i.baseColorFactor;t.color.fromArray(r),t.opacity=r[3]}void 0!==i.baseColorTexture&&o.push(n.assignTexture(t,"map",i.baseColorTexture))}return Promise.all(o)},dt.prototype.getMaterialType=function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?I:null},dt.prototype.extendMaterialParams=function(t,e){var n=this.parser,o=n.json.materials[t];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();var i=[],r=o.extensions[this.name];if(void 0!==r.clearcoatFactor&&(e.clearcoat=r.clearcoatFactor),void 0!==r.clearcoatTexture&&i.push(n.assignTexture(e,"clearcoatMap",r.clearcoatTexture)),void 0!==r.clearcoatRoughnessFactor&&(e.clearcoatRoughness=r.clearcoatRoughnessFactor),void 0!==r.clearcoatRoughnessTexture&&i.push(n.assignTexture(e,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),void 0!==r.clearcoatNormalTexture&&(i.push(n.assignTexture(e,"clearcoatNormalMap",r.clearcoatNormalTexture)),void 0!==r.clearcoatNormalTexture.scale)){var s=r.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new st(s,s)}return Promise.all(i)},mt.prototype.getMaterialType=function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?I:null},mt.prototype.extendMaterialParams=function(t,e){var n=this.parser,o=n.json.materials[t];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();var i=[],r=o.extensions[this.name];return void 0!==r.transmissionFactor&&(e.transmission=r.transmissionFactor),void 0!==r.transmissionTexture&&i.push(n.assignTexture(e,"transmissionMap",r.transmissionTexture)),Promise.all(i)},_t.prototype.loadTexture=function(t){var e=this.parser,n=e.json,o=n.textures[t];if(!o.extensions||!o.extensions[this.name])return null;var i=o.extensions[this.name],r=n.images[i.source],s=e.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,r,s)},vt.prototype.loadTexture=function(t){var e=this.name,n=this.parser,o=n.json,i=o.textures[t];if(!i.extensions||!i.extensions[e])return null;var r=i.extensions[e],s=o.images[r.source],a=s.uri?n.options.manager.getHandler(s.uri):n.textureLoader;return this.detectSupport().then((function(i){if(i)return n.loadTextureImage(t,s,a);if(o.extensionsRequired&&o.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)}))},vt.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(t){var e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported},gt.prototype.loadBufferView=function(t){var e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){var o=n.extensions[this.name],i=this.parser.getDependency("buffer",o.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,r.ready]).then((function(t){var e=o.byteOffset||0,n=o.byteLength||0,i=o.count,s=o.byteStride,a=new ArrayBuffer(i*s),l=new Uint8Array(t[0],e,n);return r.decodeGltfBuffer(new Uint8Array(a),i,s,l,o.mode,o.filter),a}))}return null};var yt="glTF",bt=12,wt={JSON:1313821514,BIN:5130562};function xt(t){this.name=ct.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(t,0,bt);if(this.header={magic:M.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==yt)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=new DataView(t,bt),o=0;o<n.byteLength;){var i=n.getUint32(o,!0);o+=4;var r=n.getUint32(o,!0);if(o+=4,r===wt.JSON){var s=new Uint8Array(t,bt+o,i);this.content=M.decodeText(s)}else if(r===wt.BIN){var a=bt+o;this.body=t.slice(a,a+i)}o+=i}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function Tt(t){this.name=ct.CESIUM_RTC,this.center=t.extensions.CESIUM_RTC.center}function Et(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ct.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}function Pt(){this.name=ct.KHR_TEXTURE_TRANSFORM}function Lt(t){B.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var e=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),o=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),r=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),s={specular:{value:(new u).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(t){for(var a in s)t.uniforms[a]=s[a];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",e).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",o).replace("#include <metalnessmap_fragment>",i).replace("#include <lights_physical_fragment>",r)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(t){s.specular.value=t}},specularMap:{get:function(){return s.specularMap.value},set:function(t){s.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return s.glossiness.value},set:function(t){s.glossiness.value=t}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(t){s.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function St(){return{name:ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return Lt},extendParams:function(t,e,n){var o=e.extensions[this.name];t.color=new u(1,1,1),t.opacity=1;var i=[];if(Array.isArray(o.diffuseFactor)){var r=o.diffuseFactor;t.color.fromArray(r),t.opacity=r[3]}if(void 0!==o.diffuseTexture&&i.push(n.assignTexture(t,"map",o.diffuseTexture)),t.emissive=new u(0,0,0),t.glossiness=void 0!==o.glossinessFactor?o.glossinessFactor:1,t.specular=new u(1,1,1),Array.isArray(o.specularFactor)&&t.specular.fromArray(o.specularFactor),void 0!==o.specularGlossinessTexture){var s=o.specularGlossinessTexture;i.push(n.assignTexture(t,"glossinessMap",s)),i.push(n.assignTexture(t,"specularMap",s))}return Promise.all(i)},createMaterial:function(t){var e=new Lt(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=nt,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}}function kt(){this.name=ct.KHR_MESH_QUANTIZATION}function Mt(t,e,n,o){g.call(this,t,e,n,o)}Et.prototype.decodePrimitive=function(t,e){var n=this.json,o=this.dracoLoader,i=t.extensions[this.name].bufferView,r=t.extensions[this.name].attributes,s={},a={},l={};for(var u in r){var c=jt[u]||u.toLowerCase();s[c]=r[u]}for(u in t.attributes)if(c=jt[u]||u.toLowerCase(),void 0!==r[u]){var h=n.accessors[t.attributes[u]],p=Ct[h.componentType];l[c]=p,a[c]=!0===h.normalized}return e.getDependency("bufferView",i).then((function(t){return new Promise((function(e){o.decodeDracoFile(t,(function(t){for(var n in t.attributes){var o=t.attributes[n],i=a[n];void 0!==i&&(o.normalized=i)}e(t)}),s,l)}))}))},Pt.prototype.extendTexture=function(t,e){return t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.needsUpdate=!0,t},Lt.prototype=Object.create(B.prototype),Lt.prototype.constructor=Lt,Lt.prototype.copy=function(t){return B.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},Mt.prototype=Object.create(g.prototype),Mt.prototype.constructor=Mt,Mt.prototype.copySampleValue_=function(t){for(var e=this.resultBuffer,n=this.sampleValues,o=this.valueSize,i=t*o*3+o,r=0;r!==o;r++)e[r]=n[i+r];return e},Mt.prototype.beforeStart_=Mt.prototype.copySampleValue_,Mt.prototype.afterEnd_=Mt.prototype.copySampleValue_,Mt.prototype.interpolate_=function(t,e,n,o){for(var i=this.resultBuffer,r=this.sampleValues,s=this.valueSize,a=2*s,l=3*s,u=o-e,c=(n-e)/u,h=c*c,p=h*c,f=t*l,d=f-l,m=-2*p+3*h,_=p-h,v=1-m,g=_-h+c,y=0;y!==s;y++){var b=r[d+y+s],w=r[d+y+a]*u,x=r[f+y+s],T=r[f+y]*u;i[y]=v*b+g*w+m*x+_*T}return i};var Ct={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ot={9728:N,9729:P,9984:F,9985:S,9986:z,9987:L},At={33071:l,33648:D,10497:J},Rt={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},jt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},It={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Bt={CUBICSPLINE:void 0,LINEAR:b,STEP:y};function Dt(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}function Nt(t,e,n){for(var o in n.extensions)void 0===t[o]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[o]=n.extensions[o])}function zt(e,n){void 0!==n.extras&&("object"===t(n.extras)?Object.assign(e.userData,n.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+n.extras))}function Ft(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(var n=0,o=e.weights.length;n<o;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){var i=e.extras.targetNames;if(t.morphTargetInfluences.length===i.length)for(t.morphTargetDictionary={},n=0,o=i.length;n<o;n++)t.morphTargetDictionary[i[n]]=n;else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Ht(t){for(var e="",n=Object.keys(t).sort(),o=0,i=n.length;o<i;o++)e+=n[o]+":"+t[n[o]]+";";return e}function Zt(t,e){this.json=t||{},this.extensions={},this.plugins={},this.options=e||{},this.cache=new ut,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new m(this.options.manager):this.textureLoader=new ot(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new p(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function Ut(t,e,n){var o=e.attributes,r=[];function s(e,o){return n.getDependency("accessor",e).then((function(e){t.setAttribute(o,e)}))}for(var a in o){var l=jt[a]||a.toLowerCase();l in t.attributes||r.push(s(o[a],l))}if(void 0!==e.indices&&!t.index){var u=n.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));r.push(u)}return zt(t,e),function(t,e,n){var o=e.attributes,r=new i;if(void 0!==o.POSITION){var s=(f=n.json.accessors[o.POSITION]).min,a=f.max;if(void 0!==s&&void 0!==a){r.set(new at(s[0],s[1],s[2]),new at(a[0],a[1],a[2]));var l=e.targets;if(void 0!==l){for(var u=new at,c=new at,h=0,p=l.length;h<p;h++){var f,d=l[h];void 0!==d.POSITION&&(s=(f=n.json.accessors[d.POSITION]).min,a=f.max,void 0!==s&&void 0!==a?(c.setX(Math.max(Math.abs(s[0]),Math.abs(a[0]))),c.setY(Math.max(Math.abs(s[1]),Math.abs(a[1]))),c.setZ(Math.max(Math.abs(s[2]),Math.abs(a[2]))),u.max(c)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."))}r.expandByVector(u)}t.boundingBox=r;var m=new tt;r.getCenter(m.center),m.radius=r.min.distanceTo(r.max)/2,t.boundingSphere=m}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(t,e,n),Promise.all(r).then((function(){return void 0!==e.targets?function(t,e,n){for(var o=!1,i=!1,r=0,s=e.length;r<s&&(void 0!==(u=e[r]).POSITION&&(o=!0),void 0!==u.NORMAL&&(i=!0),!o||!i);r++);if(!o&&!i)return Promise.resolve(t);var a=[],l=[];for(r=0,s=e.length;r<s;r++){var u=e[r];if(o){var c=void 0!==u.POSITION?n.getDependency("accessor",u.POSITION):t.attributes.position;a.push(c)}i&&(c=void 0!==u.NORMAL?n.getDependency("accessor",u.NORMAL):t.attributes.normal,l.push(c))}return Promise.all([Promise.all(a),Promise.all(l)]).then((function(e){var n=e[0],r=e[1];return o&&(t.morphAttributes.position=n),i&&(t.morphAttributes.normal=r),t.morphTargetsRelative=!0,t}))}(t,e.targets,n):t}))}function Gt(t,e){var n=t.getIndex();if(null===n){var o=[],i=t.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var r=0;r<i.count;r++)o.push(r);t.setIndex(o),n=t.getIndex()}var s=n.count-2,a=[];if(e===it)for(r=1;r<=s;r++)a.push(n.getX(0)),a.push(n.getX(r)),a.push(n.getX(r+1));else for(r=0;r<s;r++)r%2==0?(a.push(n.getX(r)),a.push(n.getX(r+1)),a.push(n.getX(r+2))):(a.push(n.getX(r+2)),a.push(n.getX(r+1)),a.push(n.getX(r)));a.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=t.clone();return l.setIndex(a),l}return Zt.prototype.setExtensions=function(t){this.extensions=t},Zt.prototype.setPlugins=function(t){this.plugins=t},Zt.prototype.parse=function(t,e){var n=this,o=this.json,i=this.extensions;this.cache.removeAll(),this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(e){var r={scene:e[0][o.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:o.asset,parser:n,userData:{}};Nt(i,r,o),zt(r,o),t(r)})).catch(e)},Zt.prototype._markDefs=function(){for(var t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[],o=0,i=e.length;o<i;o++)for(var r=e[o].joints,s=0,a=r.length;s<a;s++)t[r[s]].isBone=!0;for(var l=0,u=t.length;l<u;l++){var c=t[l];void 0!==c.mesh&&(this._addNodeRef(this.meshCache,c.mesh),void 0!==c.skin&&(n[c.mesh].isSkinnedMesh=!0)),void 0!==c.camera&&this._addNodeRef(this.cameraCache,c.camera)}},Zt.prototype._addNodeRef=function(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)},Zt.prototype._getNodeRef=function(t,e,n){if(t.refs[e]<=1)return n;var o=n.clone();return o.name+="_instance_"+t.uses[e]++,o},Zt.prototype._invokeOne=function(t){var e=Object.values(this.plugins);e.push(this);for(var n=0;n<e.length;n++){var o=t(e[n]);if(o)return o}},Zt.prototype._invokeAll=function(t){var e=Object.values(this.plugins);e.unshift(this);for(var n=[],o=0;o<e.length;o++){var i=t(e[o]);i&&n.push(i)}return n},Zt.prototype.getDependency=function(t,e){var n=t+":"+e,o=this.cache.get(n);if(!o){switch(t){case"scene":o=this.loadScene(e);break;case"node":o=this.loadNode(e);break;case"mesh":o=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(e)}));break;case"accessor":o=this.loadAccessor(e);break;case"bufferView":o=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(e)}));break;case"buffer":o=this.loadBuffer(e);break;case"material":o=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(e)}));break;case"texture":o=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(e)}));break;case"skin":o=this.loadSkin(e);break;case"animation":o=this.loadAnimation(e);break;case"camera":o=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,o)}return o},Zt.prototype.getDependencies=function(t){var e=this.cache.get(t);if(!e){var n=this,o=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(o.map((function(e,o){return n.getDependency(t,o)}))),this.cache.add(t,e)}return e},Zt.prototype.loadBuffer=function(t){var e=this.json.buffers[t],n=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[ct.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(t,i){n.load(Dt(e.uri,o.path),t,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))},Zt.prototype.loadBufferView=function(t){var e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){var n=e.byteLength||0,o=e.byteOffset||0;return t.slice(o,o+n)}))},Zt.prototype.loadAccessor=function(t){var e=this,n=this.json,o=this.json.accessors[t];if(void 0===o.bufferView&&void 0===o.sparse)return Promise.resolve(null);var i=[];return void 0!==o.bufferView?i.push(this.getDependency("bufferView",o.bufferView)):i.push(null),void 0!==o.sparse&&(i.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(i).then((function(t){var i,s,a=t[0],l=Rt[o.type],u=Ct[o.componentType],c=u.BYTES_PER_ELEMENT,h=c*l,p=o.byteOffset||0,f=void 0!==o.bufferView?n.bufferViews[o.bufferView].byteStride:void 0,d=!0===o.normalized;if(f&&f!==h){var m=Math.floor(p/f),g="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+m+":"+o.count,y=e.cache.get(g);y||(i=new u(a,m*f,o.count*f/c),y=new _(i,f/c),e.cache.add(g,y)),s=new v(y,l,p%f/c,d)}else i=null===a?new u(o.count*l):new u(a,p,o.count*l),s=new r(i,l,d);if(void 0!==o.sparse){var b=Rt.SCALAR,w=Ct[o.sparse.indices.componentType],x=o.sparse.indices.byteOffset||0,T=o.sparse.values.byteOffset||0,E=new w(t[1],x,o.sparse.count*b),P=new u(t[2],T,o.sparse.count*l);null!==a&&(s=new r(s.array.slice(),s.itemSize,s.normalized));for(var L=0,S=E.length;L<S;L++){var k=E[L];if(s.setX(k,P[L*l]),l>=2&&s.setY(k,P[L*l+1]),l>=3&&s.setZ(k,P[L*l+2]),l>=4&&s.setW(k,P[L*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return s}))},Zt.prototype.loadTexture=function(t){var e,n,o=this.json,i=this.options,r=o.textures[t],s=r.extensions||{};return(e=s[ct.MSFT_TEXTURE_DDS]?o.images[s[ct.MSFT_TEXTURE_DDS].source]:o.images[r.source]).uri&&(n=i.manager.getHandler(e.uri)),n||(n=s[ct.MSFT_TEXTURE_DDS]?this.extensions[ct.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader),this.loadTextureImage(t,e,n)},Zt.prototype.loadTextureImage=function(t,e,n){var o=this,i=this.json,r=this.options,s=i.textures[t],l=self.URL||self.webkitURL,u=e.uri,c=!1,h=!0;return"image/jpeg"===e.mimeType&&(h=!1),void 0!==e.bufferView&&(u=o.getDependency("bufferView",e.bufferView).then((function(t){if("image/png"===e.mimeType){var n=new DataView(t,25,1).getUint8(0,!1);h=6===n||4===n||3===n}c=!0;var o=new Blob([t],{type:e.mimeType});return u=l.createObjectURL(o)}))),Promise.resolve(u).then((function(t){return new Promise((function(e,o){var i=e;!0===n.isImageBitmapLoader&&(i=function(t){e(new a(t))}),n.load(Dt(t,r.path),i,void 0,o)}))})).then((function(e){!0===c&&l.revokeObjectURL(u),e.flipY=!1,s.name&&(e.name=s.name),h||(e.format=$);var n=(i.samplers||{})[s.sampler]||{};return e.magFilter=Ot[n.magFilter]||P,e.minFilter=Ot[n.minFilter]||L,e.wrapS=At[n.wrapS]||J,e.wrapT=At[n.wrapT]||J,o.associations.set(e,{type:"textures",index:t}),e}))},Zt.prototype.assignTexture=function(t,e,n){var o=this;return this.getDependency("texture",n.index).then((function(i){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===e&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+e+" not yet supported."),o.extensions[ct.KHR_TEXTURE_TRANSFORM]){var r=void 0!==n.extensions?n.extensions[ct.KHR_TEXTURE_TRANSFORM]:void 0;if(r){var s=o.associations.get(i);i=o.extensions[ct.KHR_TEXTURE_TRANSFORM].extendTexture(i,r),o.associations.set(i,s)}}t[e]=i}))},Zt.prototype.assignFinalMaterial=function(t){var e=t.geometry,n=t.material,o=void 0!==e.attributes.tangent,i=void 0!==e.attributes.color,r=void 0===e.attributes.normal,s=!0===t.isSkinnedMesh,a=Object.keys(e.morphAttributes).length>0,l=a&&void 0!==e.morphAttributes.normal;if(t.isPoints){var u="PointsMaterial:"+n.uuid,c=this.cache.get(u);c||(c=new q,C.prototype.copy.call(c,n),c.color.copy(n.color),c.map=n.map,c.sizeAttenuation=!1,this.cache.add(u,c)),n=c}else if(t.isLine){u="LineBasicMaterial:"+n.uuid;var h=this.cache.get(u);h||(h=new x,C.prototype.copy.call(h,n),h.color.copy(n.color),this.cache.add(u,h)),n=h}if(o||i||r||s||a){u="ClonedMaterial:"+n.uuid+":",n.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),s&&(u+="skinning:"),o&&(u+="vertex-tangents:"),i&&(u+="vertex-colors:"),r&&(u+="flat-shading:"),a&&(u+="morph-targets:"),l&&(u+="morph-normals:");var p=this.cache.get(u);p||(p=n.clone(),s&&(p.skinning=!0),o&&(p.vertexTangents=!0),i&&(p.vertexColors=!0),r&&(p.flatShading=!0),a&&(p.morphTargets=!0),l&&(p.morphNormals=!0),this.cache.add(u,p),this.associations.set(p,this.associations.get(n))),n=p}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),n.normalScale&&!o&&(n.normalScale.y=-n.normalScale.y),n.clearcoatNormalScale&&!o&&(n.clearcoatNormalScale.y=-n.clearcoatNormalScale.y),t.material=n},Zt.prototype.getMaterialType=function(){return B},Zt.prototype.loadMaterial=function(t){var e,n=this,o=this.json,i=this.extensions,r=o.materials[t],s={},a=r.extensions||{},l=[];if(a[ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=i[ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];e=c.getMaterialType(),l.push(c.extendParams(s,r,n))}else if(a[ct.KHR_MATERIALS_UNLIT]){var p=i[ct.KHR_MATERIALS_UNLIT];e=p.getMaterialType(),l.push(p.extendParams(s,r,n))}else{var f=r.pbrMetallicRoughness||{};if(s.color=new u(1,1,1),s.opacity=1,Array.isArray(f.baseColorFactor)){var d=f.baseColorFactor;s.color.fromArray(d),s.opacity=d[3]}void 0!==f.baseColorTexture&&l.push(n.assignTexture(s,"map",f.baseColorTexture)),s.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,s.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(l.push(n.assignTexture(s,"metalnessMap",f.metallicRoughnessTexture)),l.push(n.assignTexture(s,"roughnessMap",f.metallicRoughnessTexture))),e=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),l.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,s)}))))}!0===r.doubleSided&&(s.side=h);var m=r.alphaMode||"OPAQUE";return"BLEND"===m?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,"MASK"===m&&(s.alphaTest=void 0!==r.alphaCutoff?r.alphaCutoff:.5)),void 0!==r.normalTexture&&e!==j&&(l.push(n.assignTexture(s,"normalMap",r.normalTexture)),s.normalScale=new st(1,1),void 0!==r.normalTexture.scale&&s.normalScale.set(r.normalTexture.scale,r.normalTexture.scale)),void 0!==r.occlusionTexture&&e!==j&&(l.push(n.assignTexture(s,"aoMap",r.occlusionTexture)),void 0!==r.occlusionTexture.strength&&(s.aoMapIntensity=r.occlusionTexture.strength)),void 0!==r.emissiveFactor&&e!==j&&(s.emissive=(new u).fromArray(r.emissiveFactor)),void 0!==r.emissiveTexture&&e!==j&&l.push(n.assignTexture(s,"emissiveMap",r.emissiveTexture)),Promise.all(l).then((function(){var o;return o=e===Lt?i[ct.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new e(s),r.name&&(o.name=r.name),zt(o,r),n.associations.set(o,{type:"materials",index:t}),r.extensions&&Nt(i,o,r),o}))},Zt.prototype.createUniqueName=function(t){for(var e=K.sanitizeNodeName(t||""),n=e,o=1;this.nodeNamesUsed[n];++o)n=e+"_"+o;return this.nodeNamesUsed[n]=!0,n},Zt.prototype.loadGeometries=function(t){var e=this,n=this.extensions,o=this.primitiveCache;function i(t){return n[ct.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(n){return Ut(n,t,e)}))}for(var r,a,l=[],u=0,c=t.length;u<c;u++){var h,p=t[u],f=(void 0,(a=(r=p).extensions&&r.extensions[ct.KHR_DRACO_MESH_COMPRESSION])?"draco:"+a.bufferView+":"+a.indices+":"+Ht(a.attributes):r.indices+":"+Ht(r.attributes)+":"+r.mode),d=o[f];d?l.push(d.promise):(h=p.extensions&&p.extensions[ct.KHR_DRACO_MESH_COMPRESSION]?i(p):Ut(new s,p,e),o[f]={primitive:p,promise:h},l.push(h))}return Promise.all(l)},Zt.prototype.loadMesh=function(t){for(var e,n=this,o=this.json,i=this.extensions,r=o.meshes[t],s=r.primitives,a=[],l=0,u=s.length;l<u;l++){var c=void 0===s[l].material?(void 0===(e=this.cache).DefaultMaterial&&(e.DefaultMaterial=new B({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:f})),e.DefaultMaterial):this.getDependency("material",s[l].material);a.push(c)}return a.push(n.loadGeometries(s)),Promise.all(a).then((function(e){for(var o=e.slice(0,e.length-1),a=e[e.length-1],l=[],u=0,c=a.length;u<c;u++){var h,p=a[u],f=s[u],m=o[u];if(4===f.mode||5===f.mode||6===f.mode||void 0===f.mode)!0!==(h=!0===r.isSkinnedMesh?new Q(p,m):new R(p,m)).isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),5===f.mode?h.geometry=Gt(h.geometry,rt):6===f.mode&&(h.geometry=Gt(h.geometry,it));else if(1===f.mode)h=new E(p,m);else if(3===f.mode)h=new w(p,m);else if(2===f.mode)h=new T(p,m);else{if(0!==f.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);h=new W(p,m)}Object.keys(h.geometry.morphAttributes).length>0&&Ft(h,r),h.name=n.createUniqueName(r.name||"mesh_"+t),zt(h,r),f.extensions&&Nt(i,h,f),n.assignFinalMaterial(h),l.push(h)}if(1===l.length)return l[0];var _=new d;for(u=0,c=l.length;u<c;u++)_.add(l[u]);return _}))},Zt.prototype.loadCamera=function(t){var e,n=this.json.cameras[t],o=n[n.type];if(o)return"perspective"===n.type?e=new G(O.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):"orthographic"===n.type&&(e=new U(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),zt(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")},Zt.prototype.loadSkin=function(t){var e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then((function(t){return n.inverseBindMatrices=t,n}))},Zt.prototype.loadAnimation=function(t){for(var e=this.json.animations[t],o=[],i=[],r=[],s=[],a=[],l=0,u=e.channels.length;l<u;l++){var c=e.channels[l],h=e.samplers[c.sampler],p=c.target,f=void 0!==p.node?p.node:p.id,d=void 0!==e.parameters?e.parameters[h.input]:h.input,m=void 0!==e.parameters?e.parameters[h.output]:h.output;o.push(this.getDependency("node",f)),i.push(this.getDependency("accessor",d)),r.push(this.getDependency("accessor",m)),s.push(h),a.push(p)}return Promise.all([Promise.all(o),Promise.all(i),Promise.all(r),Promise.all(s),Promise.all(a)]).then((function(o){for(var i=o[0],r=o[1],s=o[2],a=o[3],l=o[4],u=[],c=0,h=i.length;c<h;c++){var p=i[c],f=r[c],d=s[c],m=a[c],_=l[c];if(void 0!==p){var v;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,It[_.path]){case It.weights:v=H;break;case It.rotation:v=X;break;default:v=lt}var g=p.name?p.name:p.uuid,y=void 0!==m.interpolation?Bt[m.interpolation]:b,w=[];It[_.path]===It.weights?p.traverse((function(t){!0===t.isMesh&&t.morphTargetInfluences&&w.push(t.name?t.name:t.uuid)})):w.push(g);var x=d.array;if(d.normalized){var T;if(x.constructor===Int8Array)T=1/127;else if(x.constructor===Uint8Array)T=1/255;else if(x.constructor==Int16Array)T=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");T=1/65535}for(var E=new Float32Array(x.length),P=0,L=x.length;P<L;P++)E[P]=x[P]*T;x=E}for(P=0,L=w.length;P<L;P++){var S=new v(w[P]+"."+It[_.path],f.array,x,y);"CUBICSPLINE"===m.interpolation&&(S.createInterpolant=function(t){return new Mt(this.times,this.values,this.getValueSize()/3,t)},S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(S)}}}var k=e.name?e.name:"animation_"+t;return new n(k,void 0,u)}))},Zt.prototype.loadNode=function(t){var e,n=this.json,i=this.extensions,r=this,s=n.nodes[t],a=s.name?r.createUniqueName(s.name):"";return(e=[],void 0!==s.mesh&&e.push(r.getDependency("mesh",s.mesh).then((function(t){var e=r._getNodeRef(r.meshCache,s.mesh,t);return void 0!==s.weights&&e.traverse((function(t){if(t.isMesh)for(var e=0,n=s.weights.length;e<n;e++)t.morphTargetInfluences[e]=s.weights[e]})),e}))),void 0!==s.camera&&e.push(r.getDependency("camera",s.camera).then((function(t){return r._getNodeRef(r.cameraCache,s.camera,t)}))),r._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(t){e.push(t)})),Promise.all(e)).then((function(e){var n;if((n=!0===s.isBone?new o:e.length>1?new d:1===e.length?e[0]:new Z)!==e[0])for(var l=0,u=e.length;l<u;l++)n.add(e[l]);if(s.name&&(n.userData.name=s.name,n.name=a),zt(n,s),s.extensions&&Nt(i,n,s),void 0!==s.matrix){var c=new A;c.fromArray(s.matrix),n.applyMatrix4(c)}else void 0!==s.translation&&n.position.fromArray(s.translation),void 0!==s.rotation&&n.quaternion.fromArray(s.rotation),void 0!==s.scale&&n.scale.fromArray(s.scale);return r.associations.set(n,{type:"nodes",index:t}),n}))},Zt.prototype.loadScene=function(){function t(e,n,o,i){var r=o.nodes[e];return i.getDependency("node",e).then((function(t){return void 0===r.skin?t:i.getDependency("skin",r.skin).then((function(t){for(var n=[],o=0,r=(e=t).joints.length;o<r;o++)n.push(i.getDependency("node",e.joints[o]));return Promise.all(n)})).then((function(n){return t.traverse((function(t){if(t.isMesh){for(var o=[],i=[],r=0,s=n.length;r<s;r++){var a=n[r];if(a){o.push(a);var l=new A;void 0!==e.inverseBindMatrices&&l.fromArray(e.inverseBindMatrices.array,16*r),i.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[r])}t.bind(new Y(o,i),t.matrixWorld)}})),t}));var e})).then((function(e){n.add(e);var s=[];if(r.children)for(var a=r.children,l=0,u=a.length;l<u;l++){var c=a[l];s.push(t(c,e,o,i))}return Promise.all(s)}))}return function(e){var n=this.json,o=this.extensions,i=this.json.scenes[e],r=new d;o.CESIUM_RTC&&(r.CESIUM_RTC=o.CESIUM_RTC),i.name&&(r.name=this.createUniqueName(i.name)),zt(r,i),i.extensions&&Nt(o,r,i);for(var s=i.nodes||[],a=[],l=0,u=s.length;l<u;l++)a.push(t(s[l],r,n,this));return Promise.all(a).then((function(){return r}))}}(),e}());THREE.GLTFLoader=ut},2873:()=>{THREE.MTLLoader=function(t){THREE.Loader.call(this,t)},THREE.MTLLoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.MTLLoader,load:function(t,e,n,o){var i=this,r=""===this.path?THREE.LoaderUtils.extractUrlBase(t):this.path,s=new THREE.FileLoader(this.manager);s.setPath(this.path),s.load(t,(function(t){e(i.parse(t,r))}),n,o)},setMaterialOptions:function(t){return this.materialOptions=t,this},parse:function(t,e){for(var n=t.split("\n"),o={},i=/\s+/,r={},s=0;s<n.length;s++){var a=n[s];if(0!==(a=a.trim()).length&&"#"!==a.charAt(0)){var l=a.indexOf(" "),u=l>=0?a.substring(0,l):a;u=u.toLowerCase();var c=l>=0?a.substring(l+1):"";if(c=c.trim(),"newmtl"===u)o={name:c},r[c]=o;else if("ka"===u||"kd"===u||"ks"===u||"ke"===u){var h=c.split(i,3);o[u]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else o[u]=c}}var p=new THREE.MTLLoader.MaterialCreator(this.resourcePath||e,this.materialOptions);return p.setCrossOrigin(this.crossOrigin),p.setManager(this.manager),p.setMaterials(r),p}}),THREE.MTLLoader.MaterialCreator=function(t,e){this.baseUrl=t||"",this.options=e,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(t){return this.crossOrigin=t,this},setManager:function(t){this.manager=t},setMaterials:function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(t){if(!this.options)return t;var e={};for(var n in t){var o=t[n],i={};for(var r in e[n]=i,o){var s=!0,a=o[r],l=r.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(a=[a[0]/255,a[1]/255,a[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===a[0]&&0===a[1]&&0===a[2]&&(s=!1)}s&&(i[l]=a)}}return e},preload:function(){for(var t in this.materialsInfo)this.create(t)},getIndex:function(t){return this.nameLookup[t]},getAsArray:function(){var t=0;for(var e in this.materialsInfo)this.materialsArray[t]=this.create(e),this.nameLookup[e]=t,t++;return this.materialsArray},create:function(t){return void 0===this.materials[t]&&this.createMaterial_(t),this.materials[t]},createMaterial_:function(t){var e=this,n=this.materialsInfo[t],o={name:t,side:this.side};function i(t,n){if(!o[t]){var i,r,s=e.getTextureParams(n,o),a=e.loadTexture((i=e.baseUrl,"string"!=typeof(r=s.url)||""===r?"":/^https?:\/\//i.test(r)?r:i+r));a.repeat.copy(s.scale),a.offset.copy(s.offset),a.wrapS=e.wrap,a.wrapT=e.wrap,o[t]=a}}for(var r in n){var s,a=n[r];if(""!==a)switch(r.toLowerCase()){case"kd":o.color=(new THREE.Color).fromArray(a);break;case"ks":case"ns":default:break;case"ke":o.emissive=(new THREE.Color).fromArray(a);break;case"map_kd":i("map",a);break;case"map_ks":i("specularMap",a);break;case"map_ke":i("emissiveMap",a);break;case"norm":i("normalMap",a);break;case"map_bump":case"bump":i("bumpMap",a);break;case"map_d":i("alphaMap",a),o.transparent=!0;break;case"d":(s=parseFloat(a))<1&&(o.opacity=s,o.transparent=!0);break;case"tr":s=parseFloat(a),this.options&&this.options.invertTrProperty&&(s=1-s),s>0&&(o.opacity=1-s,o.transparent=!0)}}return this.materials[t]=new THREE.MeshStandardMaterial(o),this.materials[t]},getTextureParams:function(t,e){var n,o={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},i=t.split(/\s+/);return(n=i.indexOf("-bm"))>=0&&(e.bumpScale=parseFloat(i[n+1]),i.splice(n,2)),(n=i.indexOf("-s"))>=0&&(o.scale.set(parseFloat(i[n+1]),parseFloat(i[n+2])),i.splice(n,4)),(n=i.indexOf("-o"))>=0&&(o.offset.set(parseFloat(i[n+1]),parseFloat(i[n+2])),i.splice(n,4)),o.url=i.join(" ").trim(),o},loadTexture:function(t,e,n,o,i){var r,s=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager,a=s.getHandler(t);return null===a&&(a=new THREE.TextureLoader(s)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin),r=a.load(t,n,o,i),void 0!==e&&(r.mapping=e),r}}},2807:()=>{THREE.OBJLoader=function(){var t=/^[og]\s*(.+)?/,e=/^mtllib /,n=/^usemtl /;function o(){var t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);var n=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(t,e){var n=this._finalize(!1);n&&(n.inherited||n.groupCount<=0)&&this.materials.splice(n.index,1);var o={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==n?n.smooth:this.smooth,groupStart:void 0!==n?n.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){var e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(o),o},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){var e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(var n=this.materials.length-1;n>=0;n--)this.materials[n].groupCount<=0&&this.materials.splice(n,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},n&&n.name&&"function"==typeof n.clone){var o=n.clone(0);o.inherited=!0,this.object.materials.push(o)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseNormalIndex:function(t,e){var n=parseInt(t,10);return 3*(n>=0?n-1:n+e/3)},parseUVIndex:function(t,e){var n=parseInt(t,10);return 2*(n>=0?n-1:n+e/2)},addVertex:function(t,e,n){var o=this.vertices,i=this.object.geometry.vertices;i.push(o[t+0],o[t+1],o[t+2]),i.push(o[e+0],o[e+1],o[e+2]),i.push(o[n+0],o[n+1],o[n+2])},addVertexPoint:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,n){var o=this.normals,i=this.object.geometry.normals;i.push(o[t+0],o[t+1],o[t+2]),i.push(o[e+0],o[e+1],o[e+2]),i.push(o[n+0],o[n+1],o[n+2])},addColor:function(t,e,n){var o=this.colors,i=this.object.geometry.colors;i.push(o[t+0],o[t+1],o[t+2]),i.push(o[e+0],o[e+1],o[e+2]),i.push(o[n+0],o[n+1],o[n+2])},addUV:function(t,e,n){var o=this.uvs,i=this.object.geometry.uvs;i.push(o[t+0],o[t+1]),i.push(o[e+0],o[e+1]),i.push(o[n+0],o[n+1])},addUVLine:function(t){var e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,n,o,i,r,s,a,l){var u=this.vertices.length,c=this.parseVertexIndex(t,u),h=this.parseVertexIndex(e,u),p=this.parseVertexIndex(n,u);if(this.addVertex(c,h,p),this.colors.length>0&&this.addColor(c,h,p),void 0!==o&&""!==o){var f=this.uvs.length;c=this.parseUVIndex(o,f),h=this.parseUVIndex(i,f),p=this.parseUVIndex(r,f),this.addUV(c,h,p)}if(void 0!==s&&""!==s){var d=this.normals.length;c=this.parseNormalIndex(s,d),h=s===a?c:this.parseNormalIndex(a,d),p=s===l?c:this.parseNormalIndex(l,d),this.addNormal(c,h,p)}},addPointGeometry:function(t){this.object.geometry.type="Points";for(var e=this.vertices.length,n=0,o=t.length;n<o;n++)this.addVertexPoint(this.parseVertexIndex(t[n],e))},addLineGeometry:function(t,e){this.object.geometry.type="Line";for(var n=this.vertices.length,o=this.uvs.length,i=0,r=t.length;i<r;i++)this.addVertexLine(this.parseVertexIndex(t[i],n));var s=0;for(r=e.length;s<r;s++)this.addUVLine(this.parseUVIndex(e[s],o))}};return t.startObject("",!1),t}function i(t){THREE.Loader.call(this,t),this.materials=null}return i.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:i,load:function(t,e,n,o){var i=this,r=new THREE.FileLoader(i.manager);r.setPath(this.path),r.load(t,(function(t){e(i.parse(t))}),n,o)},setMaterials:function(t){return this.materials=t,this},parse:function(i){console.time("OBJLoader");var r=new o;-1!==i.indexOf("\r\n")&&(i=i.replace(/\r\n/g,"\n")),-1!==i.indexOf("\\\n")&&(i=i.replace(/\\\n/g,""));for(var s=i.split("\n"),a="",l="",u=[],c="function"==typeof"".trimLeft,h=0,p=s.length;h<p;h++)if(a=s[h],0!==(a=c?a.trimLeft():a.trim()).length&&"#"!==(l=a.charAt(0)))if("v"===l){var f=a.split(/\s+/);switch(f[0]){case"v":r.vertices.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])),f.length>=7&&r.colors.push(parseFloat(f[4]),parseFloat(f[5]),parseFloat(f[6]));break;case"vn":r.normals.push(parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]));break;case"vt":r.uvs.push(parseFloat(f[1]),parseFloat(f[2]))}}else if("f"===l){for(var d=a.substr(1).trim().split(/\s+/),m=[],_=0,v=d.length;_<v;_++){var g=d[_];if(g.length>0){var y=g.split("/");m.push(y)}}var b=m[0];for(_=1,v=m.length-1;_<v;_++){var w=m[_],x=m[_+1];r.addFace(b[0],w[0],x[0],b[1],w[1],x[1],b[2],w[2],x[2])}}else if("l"===l){var T=a.substring(1).trim().split(" "),E=[],P=[];if(-1===a.indexOf("/"))E=T;else for(var L=0,S=T.length;L<S;L++){var k=T[L].split("/");""!==k[0]&&E.push(k[0]),""!==k[1]&&P.push(k[1])}r.addLineGeometry(E,P)}else if("p"===l){var M=a.substr(1).trim().split(" ");r.addPointGeometry(M)}else if(null!==(u=t.exec(a))){var C=(" "+u[0].substr(1).trim()).substr(1);r.startObject(C)}else if(n.test(a))r.object.startMaterial(a.substring(7).trim(),r.materialLibraries);else if(e.test(a))r.materialLibraries.push(a.substring(7).trim());else{if("s"!==l){if("\0"===a)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+a+'"')}if((u=a.split(" ")).length>1){var O=u[1].trim().toLowerCase();r.object.smooth="0"!==O&&"off"!==O}else r.object.smooth=!0;(V=r.object.currentMaterial())&&(V.smooth=r.object.smooth)}r.finalize();var A=new THREE.Group;for(A.materialLibraries=[].concat(r.materialLibraries),h=0,p=r.objects.length;h<p;h++){var R=r.objects[h],j=R.geometry,I=R.materials,B="Line"===j.type,D="Points"===j.type,N=!1;if(0!==j.vertices.length){var z=new THREE.BufferGeometry;z.addAttribute("position",new THREE.Float32BufferAttribute(j.vertices,3)),j.normals.length>0?z.addAttribute("normal",new THREE.Float32BufferAttribute(j.normals,3)):z.computeVertexNormals(),j.colors.length>0&&(N=!0,z.addAttribute("color",new THREE.Float32BufferAttribute(j.colors,3))),j.uvs.length>0&&z.addAttribute("uv",new THREE.Float32BufferAttribute(j.uvs,2));for(var F,H=[],Z=0,U=I.length;Z<U;Z++){var G=I[Z],V=void 0;if(null!==this.materials)if(V=this.materials.create(G.name),!B||!V||V instanceof THREE.LineBasicMaterial){if(D&&V&&!(V instanceof THREE.PointsMaterial)){var W=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(W,V),W.color.copy(V.color),W.map=V.map,V=W}}else{var q=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(q,V),q.color.copy(V.color),V=q}V||((V=B?new THREE.LineBasicMaterial:D?new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):new THREE.MeshPhongMaterial).name=G.name),V.flatShading=!G.smooth,V.vertexColors=N?THREE.VertexColors:THREE.NoColors,H.push(V)}if(H.length>1){for(Z=0,U=I.length;Z<U;Z++)G=I[Z],z.addGroup(G.groupStart,G.groupCount,Z);F=B?new THREE.LineSegments(z,H):D?new THREE.Points(z,H):new THREE.Mesh(z,H)}else F=B?new THREE.LineSegments(z,H[0]):D?new THREE.Points(z,H[0]):new THREE.Mesh(z,H[0]);F.name=R.name,A.add(F)}}return console.timeEnd("OBJLoader"),A}}),i}()},9210:function(t,e,n){var o,i,r;i=[t,n(618)],o=function(t,e){"use strict";var n,o=(n=e)&&n.__esModule?n:{default:n};var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.resolveOptions(e),this.initSelection()}return r(t,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=t.action,this.container=t.container,this.emitter=t.emitter,this.target=t.target,this.text=t.text,this.trigger=t.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var t=this,e="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return t.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[e?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,o.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,o.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var t=void 0;try{t=document.execCommand(this.action)}catch(e){t=!1}this.handleResult(t)}},{key:"handleResult",value:function(t){this.emitter.emit(t?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=t,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(t){if(void 0!==t){if(!t||"object"!==(void 0===t?"undefined":i(t))||1!==t.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&t.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(t.hasAttribute("readonly")||t.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=t}},get:function(){return this._target}}]),t}();t.exports=s},void 0===(r=o.apply(e,i))||(t.exports=r)},8187:function(t,e,n){var o,i,r;i=[t,n(9210),n(1504),n(9539)],o=function(t,e,n,o){"use strict";var i=a(e),r=a(n),s=a(o);function a(t){return t&&t.__esModule?t:{default:t}}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();var c=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return o.resolveOptions(n),o.listenClick(t),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),u(e,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof t.action?t.action:this.defaultAction,this.target="function"==typeof t.target?t.target:this.defaultTarget,this.text="function"==typeof t.text?t.text:this.defaultText,this.container="object"===l(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=(0,s.default)(t,"click",(function(t){return e.onClick(t)}))}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new i.default({action:this.action(e),target:this.target(e),text:this.text(e),container:this.container,trigger:e,emitter:this})}},{key:"defaultAction",value:function(t){return h("action",t)}},{key:"defaultTarget",value:function(t){var e=h("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return h("text",t)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"==typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach((function(t){n=n&&!!document.queryCommandSupported(t)})),n}}]),e}(r.default);function h(t,e){var n="data-clipboard-"+t;if(e.hasAttribute(n))return e.getAttribute(n)}t.exports=c},void 0===(r=o.apply(e,i))||(t.exports=r)},3036:t=>{if("undefined"!=typeof Element&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}t.exports=function(t,e){for(;t&&9!==t.nodeType;){if("function"==typeof t.matches&&t.matches(e))return t;t=t.parentNode}}},7512:(t,e,n)=>{var o=n(3036);function i(t,e,n,o,i){var s=r.apply(this,arguments);return t.addEventListener(n,s,i),{destroy:function(){t.removeEventListener(n,s,i)}}}function r(t,e,n,i){return function(n){n.delegateTarget=o(n.target,e),n.delegateTarget&&i.call(t,n)}}t.exports=function(t,e,n,o,r){return"function"==typeof t.addEventListener?i.apply(null,arguments):"function"==typeof n?i.bind(null,document).apply(null,arguments):("string"==typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return i(t,e,n,o,r)})))}},2881:(t,e,n)=>{var o={EventEmitter:n(4566),EmitterSubscription:n(7274)};t.exports=o},4566:(t,e,n)=>{"use strict";var o=n(7274),i=n(9402),r=n(9395),s=n(646),a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._subscriber=new i,this._currentSubscription=null}return t.prototype.addListener=function(t,e,n){return this._subscriber.addSubscription(t,new o(this._subscriber,e,n))},t.prototype.once=function(t,e,n){var o=this;return this.addListener(t,(function(){o.removeCurrentListener(),e.apply(n,arguments)}))},t.prototype.removeAllListeners=function(t){this._subscriber.removeAllSubscriptions(t)},t.prototype.removeCurrentListener=function(){this._currentSubscription||s(!1),this._subscriber.removeSubscription(this._currentSubscription)},t.prototype.listeners=function(t){var e=this._subscriber.getSubscriptionsForType(t);return e?e.filter(r.thatReturnsTrue).map((function(t){return t.listener})):[]},t.prototype.emit=function(t){var e=this._subscriber.getSubscriptionsForType(t);if(e){for(var n=Object.keys(e),o=0;o<n.length;o++){var i=e[n[o]];i&&(this._currentSubscription=i,this.__emitToSubscription.apply(this,[i].concat(Array.prototype.slice.call(arguments))))}this._currentSubscription=null}},t.prototype.__emitToSubscription=function(t,e){var n=Array.prototype.slice.call(arguments,2);t.listener.apply(t.context,n)},t}();t.exports=a},7274:(t,e,n)=>{"use strict";var o=function(t){function e(n,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,n),this.listener=o,this.context=i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n(5856));t.exports=o},5856:t=>{"use strict";var e=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.subscriber=e}return t.prototype.remove=function(){this.subscriber&&(this.subscriber.removeSubscription(this),this.subscriber=null)},t}();t.exports=e},9402:(t,e,n)=>{"use strict";var o=n(646),i=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._subscriptionsForType={},this._currentSubscription=null}return t.prototype.addSubscription=function(t,e){e.subscriber!==this&&o(!1),this._subscriptionsForType[t]||(this._subscriptionsForType[t]=[]);var n=this._subscriptionsForType[t].length;return this._subscriptionsForType[t].push(e),e.eventType=t,e.key=n,e},t.prototype.removeAllSubscriptions=function(t){void 0===t?this._subscriptionsForType={}:delete this._subscriptionsForType[t]},t.prototype.removeSubscription=function(t){var e=t.eventType,n=t.key,o=this._subscriptionsForType[e];o&&delete o[n]},t.prototype.getSubscriptionsForType=function(t){return this._subscriptionsForType[t]},t}();t.exports=i},9395:t=>{"use strict";function e(t){return function(){return t}}var n=function(){};n.thatReturns=e,n.thatReturnsFalse=e(!1),n.thatReturnsTrue=e(!0),n.thatReturnsNull=e(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(t){return t},t.exports=n},646:t=>{"use strict";t.exports=function(t,e,n,o,i,r,s,a){if(!t){var l;if(void 0===e)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,o,i,r,s,a],c=0;(l=new Error(e.replace(/%s/g,(function(){return u[c++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},4213:function(t,e,n){var o,i;void 0===(i="function"==typeof(o=function(){"use strict";function e(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){a(o.response,e,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,s=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(t,n,s){var a=r.URL||r.webkitURL,l=document.createElement("a");n=n||t.name||"download",l.download=n,l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?i(l):o(l.href)?e(t,n,s):i(l,l.target="_blank")):(l.href=a.createObjectURL(t),setTimeout((function(){a.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,r){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,r),n);else if(o(t))e(t,n,r);else{var s=document.createElement("a");s.href=t,s.target="_blank",setTimeout((function(){i(s)}))}}:function(t,n,o,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,o);var a="application/octet-stream"===t.type,l=/constructor/i.test(r.HTMLElement)||r.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||a&&l||s)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},c.readAsDataURL(t)}else{var h=r.URL||r.webkitURL,p=h.createObjectURL(t);i?i.location=p:location.href=p,i=null,setTimeout((function(){h.revokeObjectURL(p)}),4e4)}});r.saveAs=a.saveAs=a,t.exports=a})?o.apply(e,[]):o)||(t.exports=i)},8116:(t,e)=>{e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var n=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"==typeof t||t instanceof String},e.fn=function(t){return"[object Function]"===Object.prototype.toString.call(t)}},9539:(t,e,n)=>{var o=n(8116),i=n(7512);t.exports=function(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!o.string(e))throw new TypeError("Second argument must be a String");if(!o.fn(n))throw new TypeError("Third argument must be a Function");if(o.node(t))return function(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}(t,e,n);if(o.nodeList(t))return function(t,e,n){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,n)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,n)}))}}}(t,e,n);if(o.string(t))return function(t,e,n){return i(document.body,t,e,n)}(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},6894:(t,e,n)=>{var o=n(311),i=Object.prototype.hasOwnProperty,r=Array.prototype.splice,s=Object.prototype.toString,a=function(t){return s.call(t).slice(8,-1)},l=Object.assign||function(t,e){return u(e).forEach((function(n){i.call(e,n)&&(t[n]=e[n])})),t},u="function"==typeof Object.getOwnPropertySymbols?function(t){return Object.keys(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.keys(t)};function c(t){if(Array.isArray(t))return l(t.constructor(t.length),t);if("Map"===a(t))return new Map(t);if("Set"===a(t))return new Set(t);if(t&&"object"==typeof t){var e=Object.getPrototypeOf(t);return l(Object.create(e),t)}return t}function h(){var t=l({},p);return e.extend=function(e,n){t[e]=n},e.isEquals=function(t,e){return t===e},e;function e(n,r){"function"==typeof r&&(r={$apply:r}),Array.isArray(n)&&Array.isArray(r)||o(!Array.isArray(r),"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."),o("object"==typeof r&&null!==r,"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: %s.",Object.keys(t).join(", "));var s=n;return u(r).forEach((function(o){if(i.call(t,o)){var l=n===s;s=t[o](r[o],s,r,n),l&&e.isEquals(s,n)&&(s=n)}else{var u="Map"===a(n)?e(n.get(o),r[o]):e(n[o],r[o]),h="Map"===a(s)?s.get(o):s[o];e.isEquals(u,h)&&(void 0!==u||i.call(n,o))||(s===n&&(s=c(n)),"Map"===a(s)?s.set(o,u):s[o]=u)}})),s}}var p={$push:function(t,e,n){return d(e,n,"$push"),t.length?e.concat(t):e},$unshift:function(t,e,n){return d(e,n,"$unshift"),t.length?t.concat(e):e},$splice:function(t,e,n,i){return function(t,e){o(Array.isArray(t),"Expected $splice target to be an array; got %s",t),_(e.$splice)}(e,n),t.forEach((function(t){_(t),e===i&&t.length&&(e=c(i)),r.apply(e,t)})),e},$set:function(t,e,n){return function(t){o(1===Object.keys(t).length,"Cannot have more than one key in an object with $set")}(n),t},$toggle:function(t,e){m(t,"$toggle");var n=t.length?c(e):e;return t.forEach((function(t){n[t]=!e[t]})),n},$unset:function(t,e,n,o){return m(t,"$unset"),t.forEach((function(t){Object.hasOwnProperty.call(e,t)&&(e===o&&(e=c(o)),delete e[t])})),e},$add:function(t,e,n,o){return v(e,"$add"),m(t,"$add"),"Map"===a(e)?t.forEach((function(t){var n=t[0],i=t[1];e===o&&e.get(n)!==i&&(e=c(o)),e.set(n,i)})):t.forEach((function(t){e!==o||e.has(t)||(e=c(o)),e.add(t)})),e},$remove:function(t,e,n,o){return v(e,"$remove"),m(t,"$remove"),t.forEach((function(t){e===o&&e.has(t)&&(e=c(o)),e.delete(t)})),e},$merge:function(t,e,n,i){var r,s;return r=e,o((s=t)&&"object"==typeof s,"update(): $merge expects a spec of type 'object'; got %s",s),o(r&&"object"==typeof r,"update(): $merge expects a target of type 'object'; got %s",r),u(t).forEach((function(n){t[n]!==e[n]&&(e===i&&(e=c(i)),e[n]=t[n])})),e},$apply:function(t,e){var n;return o("function"==typeof(n=t),"update(): expected spec of $apply to be a function; got %s.",n),t(e)}},f=h();function d(t,e,n){o(Array.isArray(t),"update(): expected target of %s to be an array; got %s.",n,t),m(e[n],n)}function m(t,e){o(Array.isArray(t),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",e,t)}function _(t){o(Array.isArray(t),"update(): expected spec of $splice to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",t)}function v(t,e){var n=a(t);o("Map"===n||"Set"===n,"update(): %s expects a target of type Set or Map; got %s",e,n)}t.exports=f,t.exports.default=f,t.exports.newContext=h},311:t=>{"use strict";t.exports=function(t,e,n,o,i,r,s,a){if(!t){var l;if(void 0===e)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,o,i,r,s,a],c=0;(l=new Error(e.replace(/%s/g,(function(){return u[c++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},3481:function(t,e){!function(t){"use strict";var e=Object.freeze;function n(t){var e,n,o,i;for(n=1,o=arguments.length;n<o;n++)for(e in i=arguments[n])t[e]=i[e];return t}Object.freeze=function(t){return t};var o=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function i(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var o=n.call(arguments,2);return function(){return t.apply(e,o.length?o.concat(n.call(arguments)):arguments)}}var r=0;function s(t){return t._leaflet_id=t._leaflet_id||++r,t._leaflet_id}function a(t,e,n){var o,i,r,s;return s=function(){o=!1,i&&(r.apply(n,i),i=!1)},r=function(){o?i=arguments:(t.apply(n,arguments),setTimeout(s,e),o=!0)},r}function l(t,e,n){var o=e[1],i=e[0],r=o-i;return t===o&&n?t:((t-i)%r+r)%r+i}function u(){return!1}function c(t,e){var n=Math.pow(10,void 0===e?6:e);return Math.round(t*n)/n}function h(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function p(t){return h(t).split(/\s+/)}function f(t,e){for(var n in t.hasOwnProperty("options")||(t.options=t.options?o(t.options):{}),e)t.options[n]=e[n];return t.options}function d(t,e,n){var o=[];for(var i in t)o.push(encodeURIComponent(n?i.toUpperCase():i)+"="+encodeURIComponent(t[i]));return(e&&-1!==e.indexOf("?")?"&":"?")+o.join("&")}var m=/\{ *([\w_-]+) *\}/g;function _(t,e){return t.replace(m,(function(t,n){var o=e[n];if(void 0===o)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o}))}var v=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function g(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function b(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var w=0;function x(t){var e=+new Date,n=Math.max(0,16-(e-w));return w=e+n,window.setTimeout(t,n)}var T=window.requestAnimationFrame||b("RequestAnimationFrame")||x,E=window.cancelAnimationFrame||b("CancelAnimationFrame")||b("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function P(t,e,n){if(!n||T!==x)return T.call(window,i(t,e));t.call(e)}function S(t){t&&E.call(window,t)}var k=(Object.freeze||Object)({freeze:e,extend:n,create:o,bind:i,lastId:r,stamp:s,throttle:a,wrapNum:l,falseFn:u,formatNum:c,trim:h,splitWords:p,setOptions:f,getParamString:d,template:_,isArray:v,indexOf:g,emptyImageUrl:y,requestFn:T,cancelFn:E,requestAnimFrame:P,cancelAnimFrame:S});function M(){}M.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,r=o(i);for(var s in r.constructor=e,e.prototype=r,this)this.hasOwnProperty(s)&&"prototype"!==s&&"__super__"!==s&&(e[s]=this[s]);return t.statics&&(n(e,t.statics),delete t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=v(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),n.apply(null,[r].concat(t.includes)),delete t.includes),r.options&&(t.options=n(o(r.options),t.options)),n(r,t),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=r._initHooks.length;t<e;t++)r._initHooks[t].call(this)}},e},M.include=function(t){return n(this.prototype,t),this},M.mergeOptions=function(t){return n(this.prototype.options,t),this},M.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var C={on:function(t,e,n){if("object"==typeof t)for(var o in t)this._on(o,t[o],e);else for(var i=0,r=(t=p(t)).length;i<r;i++)this._on(t[i],e,n);return this},off:function(t,e,n){if(t)if("object"==typeof t)for(var o in t)this._off(o,t[o],e);else for(var i=0,r=(t=p(t)).length;i<r;i++)this._off(t[i],e,n);else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var o=this._events[t];o||(o=[],this._events[t]=o),n===this&&(n=void 0);for(var i={fn:e,ctx:n},r=o,s=0,a=r.length;s<a;s++)if(r[s].fn===e&&r[s].ctx===n)return;r.push(i)},_off:function(t,e,n){var o,i,r;if(this._events&&(o=this._events[t]))if(e){if(n===this&&(n=void 0),o)for(i=0,r=o.length;i<r;i++){var s=o[i];if(s.ctx===n&&s.fn===e)return s.fn=u,this._firingCount&&(this._events[t]=o=o.slice()),void o.splice(i,1)}}else{for(i=0,r=o.length;i<r;i++)o[i].fn=u;delete this._events[t]}},fire:function(t,e,o){if(!this.listens(t,o))return this;var i=n({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var r=this._events[t];if(r){this._firingCount=this._firingCount+1||1;for(var s=0,a=r.length;s<a;s++){var l=r[s];l.fn.call(l.ctx||this,i)}this._firingCount--}}return o&&this._propagateEvent(i),this},listens:function(t,e){var n=this._events&&this._events[t];if(n&&n.length)return!0;if(e)for(var o in this._eventParents)if(this._eventParents[o].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var o in t)this.once(o,t[o],e);return this}var r=i((function(){this.off(t,e,n).off(t,r,n)}),this);return this.on(t,e,n).on(t,r,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[s(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[s(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,n({layer:t.target,propagatedFrom:t.target},t),!0)}};C.addEventListener=C.on,C.removeEventListener=C.clearAllEventListeners=C.off,C.addOneTimeEventListener=C.once,C.fireEvent=C.fire,C.hasEventListeners=C.listens;var O=M.extend(C);function A(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var R=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function j(t,e,n){return t instanceof A?t:v(t)?new A(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new A(t.x,t.y):new A(t,e,n)}function I(t,e){if(t)for(var n=e?[t,e]:t,o=0,i=n.length;o<i;o++)this.extend(n[o])}function B(t,e){return!t||t instanceof I?t:new I(t,e)}function D(t,e){if(t)for(var n=e?[t,e]:t,o=0,i=n.length;o<i;o++)this.extend(n[o])}function N(t,e){return t instanceof D?t:new D(t,e)}function z(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function F(t,e,n){return t instanceof z?t:v(t)&&"object"!=typeof t[0]?3===t.length?new z(t[0],t[1],t[2]):2===t.length?new z(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new z(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new z(t,e,n)}A.prototype={clone:function(){return new A(this.x,this.y)},add:function(t){return this.clone()._add(j(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(j(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new A(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new A(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=R(this.x),this.y=R(this.y),this},distanceTo:function(t){var e=(t=j(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=j(t)).x===this.x&&t.y===this.y},contains:function(t){return t=j(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+c(this.x)+", "+c(this.y)+")"}},I.prototype={extend:function(t){return t=j(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new A((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new A(this.min.x,this.max.y)},getTopRight:function(){return new A(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof A?j(t):B(t))instanceof I?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=B(t);var e=this.min,n=this.max,o=t.min,i=t.max,r=i.x>=e.x&&o.x<=n.x,s=i.y>=e.y&&o.y<=n.y;return r&&s},overlaps:function(t){t=B(t);var e=this.min,n=this.max,o=t.min,i=t.max,r=i.x>e.x&&o.x<n.x,s=i.y>e.y&&o.y<n.y;return r&&s},isValid:function(){return!(!this.min||!this.max)}},D.prototype={extend:function(t){var e,n,o=this._southWest,i=this._northEast;if(t instanceof z)e=t,n=t;else{if(!(t instanceof D))return t?this.extend(F(t)||N(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return o||i?(o.lat=Math.min(e.lat,o.lat),o.lng=Math.min(e.lng,o.lng),i.lat=Math.max(n.lat,i.lat),i.lng=Math.max(n.lng,i.lng)):(this._southWest=new z(e.lat,e.lng),this._northEast=new z(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,o=Math.abs(e.lat-n.lat)*t,i=Math.abs(e.lng-n.lng)*t;return new D(new z(e.lat-o,e.lng-i),new z(n.lat+o,n.lng+i))},getCenter:function(){return new z((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new z(this.getNorth(),this.getWest())},getSouthEast:function(){return new z(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof z||"lat"in t?F(t):N(t);var e,n,o=this._southWest,i=this._northEast;return t instanceof D?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=o.lat&&n.lat<=i.lat&&e.lng>=o.lng&&n.lng<=i.lng},intersects:function(t){t=N(t);var e=this._southWest,n=this._northEast,o=t.getSouthWest(),i=t.getNorthEast(),r=i.lat>=e.lat&&o.lat<=n.lat,s=i.lng>=e.lng&&o.lng<=n.lng;return r&&s},overlaps:function(t){t=N(t);var e=this._southWest,n=this._northEast,o=t.getSouthWest(),i=t.getNorthEast(),r=i.lat>e.lat&&o.lat<n.lat,s=i.lng>e.lng&&o.lng<n.lng;return r&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=N(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},z.prototype={equals:function(t,e){return!!t&&(t=F(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+c(this.lat,t)+", "+c(this.lng,t)+")"},distanceTo:function(t){return U.distance(this,F(t))},wrap:function(){return U.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return N([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new z(this.lat,this.lng,this.alt)}};var H,Z={latLngToPoint:function(t,e){var n=this.projection.project(t),o=this.scale(e);return this.transformation._transform(n,o)},pointToLatLng:function(t,e){var n=this.scale(e),o=this.transformation.untransform(t,n);return this.projection.unproject(o)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new I(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?l(t.lng,this.wrapLng,!0):t.lng;return new z(this.wrapLat?l(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),o=e.lat-n.lat,i=e.lng-n.lng;if(0===o&&0===i)return t;var r=t.getSouthWest(),s=t.getNorthEast();return new D(new z(r.lat-o,r.lng-i),new z(s.lat-o,s.lng-i))}},U=n({},Z,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,o=t.lat*n,i=e.lat*n,r=Math.sin((e.lat-t.lat)*n/2),s=Math.sin((e.lng-t.lng)*n/2),a=r*r+Math.cos(o)*Math.cos(i)*s*s,l=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return this.R*l}}),G={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,o=Math.max(Math.min(n,t.lat),-n),i=Math.sin(o*e);return new A(this.R*t.lng*e,this.R*Math.log((1+i)/(1-i))/2)},unproject:function(t){var e=180/Math.PI;return new z((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(H=6378137*Math.PI,new I([-H,-H],[H,H]))};function V(t,e,n,o){if(v(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=o}function W(t,e,n,o){return new V(t,e,n,o)}V.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new A((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var q=n({},U,{code:"EPSG:3857",projection:G,transformation:function(){var t=.5/(Math.PI*G.R);return W(t,.5,-t,.5)}()}),K=n({},q,{code:"EPSG:900913"});function X(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function $(t,e){var n,o,i,r,s,a,l="";for(n=0,i=t.length;n<i;n++){for(o=0,r=(s=t[n]).length;o<r;o++)l+=(o?"L":"M")+(a=s[o]).x+" "+a.y;l+=e?St?"z":"x":""}return l||"M0 0"}var J=document.documentElement.style,Y="ActiveXObject"in window,Q=Y&&!document.addEventListener,tt="msLaunchUri"in navigator&&!("documentMode"in document),et=Mt("webkit"),nt=Mt("android"),ot=Mt("android 2")||Mt("android 3"),it=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),rt=nt&&Mt("Google")&&it<537&&!("AudioNode"in window),st=!!window.opera,at=Mt("chrome"),lt=Mt("gecko")&&!et&&!st&&!Y,ut=!at&&Mt("safari"),ct=Mt("phantom"),ht="OTransition"in J,pt=0===navigator.platform.indexOf("Win"),ft=Y&&"transition"in J,dt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ot,mt="MozPerspective"in J,_t=!window.L_DISABLE_3D&&(ft||dt||mt)&&!ht&&!ct,vt="undefined"!=typeof orientation||Mt("mobile"),gt=vt&&et,yt=vt&&dt,bt=!window.PointerEvent&&window.MSPointerEvent,wt=!(!window.PointerEvent&&!bt),xt=!window.L_NO_TOUCH&&(wt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Tt=vt&&st,Et=vt&&lt,Pt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Lt=!!document.createElement("canvas").getContext,St=!(!document.createElementNS||!X("svg").createSVGRect),kt=!St&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function Mt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Ct=(Object.freeze||Object)({ie:Y,ielt9:Q,edge:tt,webkit:et,android:nt,android23:ot,androidStock:rt,opera:st,chrome:at,gecko:lt,safari:ut,phantom:ct,opera12:ht,win:pt,ie3d:ft,webkit3d:dt,gecko3d:mt,any3d:_t,mobile:vt,mobileWebkit:gt,mobileWebkit3d:yt,msPointer:bt,pointer:wt,touch:xt,mobileOpera:Tt,mobileGecko:Et,retina:Pt,canvas:Lt,svg:St,vml:kt}),Ot=bt?"MSPointerDown":"pointerdown",At=bt?"MSPointerMove":"pointermove",Rt=bt?"MSPointerUp":"pointerup",jt=bt?"MSPointerCancel":"pointercancel",It=["INPUT","SELECT","OPTION"],Bt={},Dt=!1,Nt=0;function zt(t,e,n,o){return"touchstart"===e?function(t,e,n){var o=i((function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(It.indexOf(t.target.tagName)<0))return;oe(t)}Ut(t,e)}));t["_leaflet_touchstart"+n]=o,t.addEventListener(Ot,o,!1),Dt||(document.documentElement.addEventListener(Ot,Ft,!0),document.documentElement.addEventListener(At,Ht,!0),document.documentElement.addEventListener(Rt,Zt,!0),document.documentElement.addEventListener(jt,Zt,!0),Dt=!0)}(t,n,o):"touchmove"===e?function(t,e,n){var o=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&Ut(t,e)};t["_leaflet_touchmove"+n]=o,t.addEventListener(At,o,!1)}(t,n,o):"touchend"===e&&function(t,e,n){var o=function(t){Ut(t,e)};t["_leaflet_touchend"+n]=o,t.addEventListener(Rt,o,!1),t.addEventListener(jt,o,!1)}(t,n,o),this}function Ft(t){Bt[t.pointerId]=t,Nt++}function Ht(t){Bt[t.pointerId]&&(Bt[t.pointerId]=t)}function Zt(t){delete Bt[t.pointerId],Nt--}function Ut(t,e){for(var n in t.touches=[],Bt)t.touches.push(Bt[n]);t.changedTouches=[t],e(t)}var Gt=bt?"MSPointerDown":wt?"pointerdown":"touchstart",Vt=bt?"MSPointerUp":wt?"pointerup":"touchend",Wt="_leaflet_";function qt(t,e,n){var o,i,r=!1;function s(t){var e;if(wt){if(!tt||"mouse"===t.pointerType)return;e=Nt}else e=t.touches.length;if(!(e>1)){var n=Date.now(),s=n-(o||n);i=t.touches?t.touches[0]:t,r=s>0&&s<=250,o=n}}function a(t){if(r&&!i.cancelBubble){if(wt){if(!tt||"mouse"===t.pointerType)return;var n,s,a={};for(s in i)n=i[s],a[s]=n&&n.bind?n.bind(i):n;i=a}i.type="dblclick",e(i),o=null}}return t[Wt+Gt+n]=s,t[Wt+Vt+n]=a,t[Wt+"dblclick"+n]=e,t.addEventListener(Gt,s,!1),t.addEventListener(Vt,a,!1),t.addEventListener("dblclick",e,!1),this}function Kt(t,e){var n=t[Wt+Gt+e],o=t[Wt+Vt+e],i=t[Wt+"dblclick"+e];return t.removeEventListener(Gt,n,!1),t.removeEventListener(Vt,o,!1),tt||t.removeEventListener("dblclick",i,!1),this}function Xt(t,e,n,o){if("object"==typeof e)for(var i in e)Yt(t,i,e[i],n);else for(var r=0,s=(e=p(e)).length;r<s;r++)Yt(t,e[r],n,o);return this}var $t="_leaflet_events";function Jt(t,e,n,o){if("object"==typeof e)for(var i in e)Qt(t,i,e[i],n);else if(e)for(var r=0,s=(e=p(e)).length;r<s;r++)Qt(t,e[r],n,o);else{for(var a in t[$t])Qt(t,a,t[$t][a]);delete t[$t]}return this}function Yt(t,e,n,o){var i=e+s(n)+(o?"_"+s(o):"");if(t[$t]&&t[$t][i])return this;var r=function(e){return n.call(o||t,e||window.event)},a=r;wt&&0===e.indexOf("touch")?zt(t,e,r,i):!xt||"dblclick"!==e||!qt||wt&&at?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):"mouseenter"===e||"mouseleave"===e?(r=function(e){e=e||window.event,pe(t,e)&&a(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1)):("click"===e&&nt&&(r=function(t){!function(t,e){var n=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,o=le&&n-le;o&&o>100&&o<500||t.target._simulatedClick&&!t._simulated?ie(t):(le=n,e(t))}(t,a)}),t.addEventListener(e,r,!1)):"attachEvent"in t&&t.attachEvent("on"+e,r):qt(t,r,i),t[$t]=t[$t]||{},t[$t][i]=r}function Qt(t,e,n,o){var i=e+s(n)+(o?"_"+s(o):""),r=t[$t]&&t[$t][i];if(!r)return this;wt&&0===e.indexOf("touch")?function(t,e,n){var o=t["_leaflet_"+e+n];"touchstart"===e?t.removeEventListener(Ot,o,!1):"touchmove"===e?t.removeEventListener(At,o,!1):"touchend"===e&&(t.removeEventListener(Rt,o,!1),t.removeEventListener(jt,o,!1))}(t,e,i):!xt||"dblclick"!==e||!Kt||wt&&at?"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r):Kt(t,i),t[$t][i]=null}function te(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,he(t),this}function ee(t){return Yt(t,"mousewheel",te),this}function ne(t){return Xt(t,"mousedown touchstart dblclick",te),Yt(t,"click",ce),this}function oe(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function ie(t){return oe(t),te(t),this}function re(t,e){if(!e)return new A(t.clientX,t.clientY);var n=e.getBoundingClientRect(),o=n.width/e.offsetWidth||1,i=n.height/e.offsetHeight||1;return new A(t.clientX/o-n.left-e.clientLeft,t.clientY/i-n.top-e.clientTop)}var se=pt&&at?2*window.devicePixelRatio:lt?window.devicePixelRatio:1;function ae(t){return tt?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/se:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var le,ue={};function ce(t){ue[t.type]=!0}function he(t){var e=ue[t.type];return ue[t.type]=!1,e}function pe(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}var fe,de,me,_e,ve,ge=(Object.freeze||Object)({on:Xt,off:Jt,stopPropagation:te,disableScrollPropagation:ee,disableClickPropagation:ne,preventDefault:oe,stop:ie,getMousePosition:re,getWheelDelta:ae,fakeStop:ce,skipped:he,isExternalTarget:pe,addListener:Xt,removeListener:Jt}),ye=Ie(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),be=Ie(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),we="webkitTransition"===be||"OTransition"===be?be+"End":"transitionend";function xe(t){return"string"==typeof t?document.getElementById(t):t}function Te(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var o=document.defaultView.getComputedStyle(t,null);n=o?o[e]:null}return"auto"===n?null:n}function Ee(t,e,n){var o=document.createElement(t);return o.className=e||"",n&&n.appendChild(o),o}function Pe(t){var e=t.parentNode;e&&e.removeChild(t)}function Le(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Se(t){var e=t.parentNode;e.lastChild!==t&&e.appendChild(t)}function ke(t){var e=t.parentNode;e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function Me(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=Re(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function Ce(t,e){if(void 0!==t.classList)for(var n=p(e),o=0,i=n.length;o<i;o++)t.classList.add(n[o]);else if(!Me(t,e)){var r=Re(t);Ae(t,(r?r+" ":"")+e)}}function Oe(t,e){void 0!==t.classList?t.classList.remove(e):Ae(t,h((" "+Re(t)+" ").replace(" "+e+" "," ")))}function Ae(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function Re(t){return void 0===t.className.baseVal?t.className:t.className.baseVal}function je(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var n=!1,o="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(o)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+o+"(opacity="+e+")"}(t,e)}function Ie(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function Be(t,e,n){var o=e||new A(0,0);t.style[ye]=(ft?"translate("+o.x+"px,"+o.y+"px)":"translate3d("+o.x+"px,"+o.y+"px,0)")+(n?" scale("+n+")":"")}function De(t,e){t._leaflet_pos=e,_t?Be(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Ne(t){return t._leaflet_pos||new A(0,0)}if("onselectstart"in document)fe=function(){Xt(window,"selectstart",oe)},de=function(){Jt(window,"selectstart",oe)};else{var ze=Ie(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);fe=function(){if(ze){var t=document.documentElement.style;me=t[ze],t[ze]="none"}},de=function(){ze&&(document.documentElement.style[ze]=me,me=void 0)}}function Fe(){Xt(window,"dragstart",oe)}function He(){Jt(window,"dragstart",oe)}function Ze(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Ue(),_e=t,ve=t.style.outline,t.style.outline="none",Xt(window,"keydown",Ue))}function Ue(){_e&&(_e.style.outline=ve,_e=void 0,ve=void 0,Jt(window,"keydown",Ue))}var Ge=(Object.freeze||Object)({TRANSFORM:ye,TRANSITION:be,TRANSITION_END:we,get:xe,getStyle:Te,create:Ee,remove:Pe,empty:Le,toFront:Se,toBack:ke,hasClass:Me,addClass:Ce,removeClass:Oe,setClass:Ae,getClass:Re,setOpacity:je,testProp:Ie,setTransform:Be,setPosition:De,getPosition:Ne,disableTextSelection:fe,enableTextSelection:de,disableImageDrag:Fe,enableImageDrag:He,preventOutline:Ze,restoreOutline:Ue}),Ve=O.extend({run:function(t,e,n,o){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(o||.5,.2),this._startPos=Ne(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=P(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),De(this._el,n),this.fire("step")},_complete:function(){S(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),We=O.extend({options:{crs:q,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=f(this,e),this._initContainer(t),this._initLayout(),this._onResize=i(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(F(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=be&&_t&&!Tt&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Xt(this._proxy,we,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,o){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(F(t),e,this.options.maxBounds),o=o||{},this._stop(),this._loaded&&!o.reset&&!0!==o&&(void 0!==o.animate&&(o.zoom=n({animate:o.animate},o.zoom),o.pan=n({animate:o.animate,duration:o.duration},o.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,o.zoom):this._tryAnimatedPan(t,o.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(_t?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(_t?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var o=this.getZoomScale(e),i=this.getSize().divideBy(2),r=(t instanceof A?t:this.latLngToContainerPoint(t)).subtract(i).multiplyBy(1-1/o),s=this.containerPointToLatLng(i.add(r));return this.setView(s,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():N(t);var n=j(e.paddingTopLeft||e.padding||[0,0]),o=j(e.paddingBottomRight||e.padding||[0,0]),i=this.getBoundsZoom(t,!1,n.add(o));if((i="number"==typeof e.maxZoom?Math.min(e.maxZoom,i):i)===1/0)return{center:t.getCenter(),zoom:i};var r=o.subtract(n).divideBy(2),s=this.project(t.getSouthWest(),i),a=this.project(t.getNorthEast(),i);return{center:this.unproject(s.add(a).divideBy(2).add(r),i),zoom:i}},fitBounds:function(t,e){if(!(t=N(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=j(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ve,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){Ce(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(!1===(n=n||{}).animate||!_t)return this.setView(t,e,n);this._stop();var o=this.project(this.getCenter()),i=this.project(t),r=this.getSize(),s=this._zoom;t=F(t),e=void 0===e?s:e;var a=Math.max(r.x,r.y),l=a*this.getZoomScale(s,e),u=i.distanceTo(o)||1,c=1.42,h=c*c;function p(t){var e=(l*l-a*a+(t?-1:1)*h*h*u*u)/(2*(t?l:a)*h*u),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function f(t){return(Math.exp(t)-Math.exp(-t))/2}function d(t){return(Math.exp(t)+Math.exp(-t))/2}var m=p(0);function _(t){return a*(d(m)*(f(e=m+c*t)/d(e))-f(m))/h;var e}var v=Date.now(),g=(p(1)-m)/c,y=n.duration?1e3*n.duration:1e3*g*.8;return this._moveStart(!0,n.noMoveStart),function n(){var r=(Date.now()-v)/y,l=function(t){return 1-Math.pow(1-t,1.5)}(r)*g;r<=1?(this._flyToFrame=P(n,this),this._move(this.unproject(o.add(i.subtract(o).multiplyBy(_(l)/u)),s),this.getScaleZoom(a/function(t){return a*(d(m)/d(m+c*t))}(l),s),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return(t=N(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),o=this._limitCenter(n,this._zoom,N(t));return n.equals(o)||this.panTo(o,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=n({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var o=this.getSize(),r=e.divideBy(2).round(),s=o.divideBy(2).round(),a=r.subtract(s);return a.x||a.y?(t.animate&&t.pan?this.panBy(a):(t.pan&&this._rawPanBy(a),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:o})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=n({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=i(this._handleGeolocationResponse,this),o=i(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,o,t):navigator.geolocation.getCurrentPosition(e,o,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=new z(t.coords.latitude,t.coords.longitude),n=e.toBounds(t.coords.accuracy),o=this._locateOptions;if(o.setView){var i=this.getBoundsZoom(n);this.setView(e,o.maxZoom?Math.min(i,o.maxZoom):i)}var r={latlng:e,bounds:n,timestamp:t.timestamp};for(var s in t.coords)"number"==typeof t.coords[s]&&(r[s]=t.coords[s]);this.fire("locationfound",r)},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),Pe(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)Pe(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=Ee("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new D(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=N(t),n=j(n||[0,0]);var o=this.getZoom()||0,i=this.getMinZoom(),r=this.getMaxZoom(),s=t.getNorthWest(),a=t.getSouthEast(),l=this.getSize().subtract(n),u=B(this.project(a,o),this.project(s,o)).getSize(),c=_t?this.options.zoomSnap:1,h=l.x/u.x,p=l.y/u.y,f=e?Math.max(h,p):Math.min(h,p);return o=this.getScaleZoom(f,o),c&&(o=Math.round(o/(c/100))*(c/100),o=e?Math.ceil(o/c)*c:Math.floor(o/c)*c),Math.max(i,Math.min(r,o))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new A(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new I(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=void 0===e?this._zoom:e;var o=n.zoom(t*n.scale(e));return isNaN(o)?1/0:o},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(F(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(j(t),e)},layerPointToLatLng:function(t){var e=j(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(F(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(F(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(N(t))},distance:function(t,e){return this.options.crs.distance(F(t),F(e))},containerPointToLayerPoint:function(t){return j(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return j(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(j(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(F(t)))},mouseEventToContainerPoint:function(t){return re(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=xe(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Xt(e,"scroll",this._onScroll,this),this._containerId=s(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&_t,Ce(t,"leaflet-container"+(xt?" leaflet-touch":"")+(Pt?" leaflet-retina":"")+(Q?" leaflet-oldie":"")+(ut?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=Te(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),De(this._mapPane,new A(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ce(t.markerPane,"leaflet-zoom-hide"),Ce(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){De(this._mapPane,new A(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var o=this._zoom!==e;this._moveStart(o,!1)._move(t,e)._moveEnd(o),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n){void 0===e&&(e=this._zoom);var o=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(o||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return S(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){De(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[s(this._container)]=this;var e=t?Jt:Xt;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),_t&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){S(this._resizeRequest),this._resizeRequest=P((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,o=[],i="mouseout"===e||"mouseover"===e,r=t.target||t.srcElement,a=!1;r;){if((n=this._targets[s(r)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(n)){a=!0;break}if(n&&n.listens(e,!0)){if(i&&!pe(r,t))break;if(o.push(n),i)break}if(r===this._container)break;r=r.parentNode}return o.length||a||i||!pe(r,t)||(o=[this]),o},_handleDOMEvent:function(t){if(this._loaded&&!he(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e||Ze(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,o){if("click"===t.type){var i=n({},t);i.type="preclick",this._fireDOMEvent(i,i.type,o)}if(!t._stopped&&(o=(o||[]).concat(this._findEventTargets(t,e))).length){var r=o[0];"contextmenu"===e&&r.listens(e,!0)&&oe(t);var s={originalEvent:t};if("keypress"!==t.type){var a=r.getLatLng&&(!r._radius||r._radius<=10);s.containerPoint=a?this.latLngToContainerPoint(r.getLatLng()):this.mouseEventToContainerPoint(t),s.layerPoint=this.containerPointToLayerPoint(s.containerPoint),s.latlng=a?r.getLatLng():this.layerPointToLatLng(s.layerPoint)}for(var l=0;l<o.length;l++)if(o[l].fire(e,s,!0),s.originalEvent._stopped||!1===o[l].options.bubblingMouseEvents&&-1!==g(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Ne(this._mapPane)||new A(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var o=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(o)},_latLngBoundsToNewLayerBounds:function(t,e,n){var o=this._getNewPixelOrigin(n,e);return B([this.project(t.getSouthWest(),e)._subtract(o),this.project(t.getNorthWest(),e)._subtract(o),this.project(t.getSouthEast(),e)._subtract(o),this.project(t.getNorthEast(),e)._subtract(o)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var o=this.project(t,e),i=this.getSize().divideBy(2),r=new I(o.subtract(i),o.add(i)),s=this._getBoundsOffset(r,n,e);return s.round().equals([0,0])?t:this.unproject(o.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),o=new I(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(o,e))},_getBoundsOffset:function(t,e,n){var o=B(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),i=o.min.subtract(t.min),r=o.max.subtract(t.max);return new A(this._rebound(i.x,-r.x),this._rebound(i.y,-r.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),o=_t?this.options.zoomSnap:1;return o&&(t=Math.round(t/o)*o),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Oe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n)||(this.panBy(n,e),0))},_createAnimProxy:function(){var t=this._proxy=Ee("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=ye,n=this._proxy.style[e];Be(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",(function(){var t=this.getCenter(),e=this.getZoom();Be(this._proxy,this.project(t,e),this.getZoomScale(e,1))}),this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Pe(this._proxy),delete this._proxy},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var o=this.getZoomScale(e),i=this._getCenterOffset(t)._divideBy(1-1/o);return!(!0!==n.animate&&!this.getSize().contains(i)||(P((function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,n,o){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,Ce(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:o}),setTimeout(i(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Oe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),P((function(){this._moveEnd(!0)}),this))}});var qe=M.extend({options:{position:"topright"},initialize:function(t){f(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),o=t._controlCorners[n];return Ce(e,"leaflet-control"),-1!==n.indexOf("bottom")?o.insertBefore(e,o.firstChild):o.appendChild(e),this},remove:function(){return this._map?(Pe(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Ke=function(t){return new qe(t)};We.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=Ee("div",e+"control-container",this._container);function o(o,i){var r=e+o+" "+e+i;t[o+i]=Ee("div",r,n)}o("top","left"),o("top","right"),o("bottom","left"),o("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)Pe(this._controlCorners[t]);Pe(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Xe=qe.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,o){return n<o?-1:o<n?1:0}},initialize:function(t,e,n){for(var o in f(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[o],o);for(o in e)this._addLayer(e[o],o,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return qe.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(s(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){Ce(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(Ce(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):Oe(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Oe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=Ee("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),ne(e),ee(e);var o=this._form=Ee("form",t+"-list");n&&(this._map.on("click",this.collapse,this),nt||Xt(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var i=this._layersLink=Ee("a",t+"-toggle",e);i.href="#",i.title="Layers",xt?(Xt(i,"click",ie),Xt(i,"click",this.expand,this)):Xt(i,"focus",this.expand,this),n||this.expand(),this._baseLayersList=Ee("div",t+"-base",o),this._separator=Ee("div",t+"-separator",o),this._overlaysList=Ee("div",t+"-overlays",o),e.appendChild(o)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&s(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(i((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Le(this._baseLayersList),Le(this._overlaysList),this._layerControlInputs=[];var t,e,n,o,i=0;for(n=0;n<this._layers.length;n++)o=this._layers[n],this._addItem(o),e=e||o.overlay,t=t||!o.overlay,i+=o.overlay?0:1;return this.options.hideSingleBase&&(t=t&&i>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(s(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",o=document.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var e,n=document.createElement("label"),o=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=o):e=this._createRadioElement("leaflet-base-layers",o),this._layerControlInputs.push(e),e.layerId=s(t.layer),Xt(e,"click",this._onInputClick,this);var i=document.createElement("span");i.innerHTML=" "+t.name;var r=document.createElement("div");return n.appendChild(r),r.appendChild(e),r.appendChild(i),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,n=this._layerControlInputs,o=[],i=[];this._handlingClick=!0;for(var r=n.length-1;r>=0;r--)t=n[r],e=this._getLayer(t.layerId).layer,t.checked?o.push(e):t.checked||i.push(e);for(r=0;r<i.length;r++)this._map.hasLayer(i[r])&&this._map.removeLayer(i[r]);for(r=0;r<o.length;r++)this._map.hasLayer(o[r])||this._map.addLayer(o[r]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,o=this._map.getZoom(),i=n.length-1;i>=0;i--)t=n[i],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&o<e.options.minZoom||void 0!==e.options.maxZoom&&o>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),$e=qe.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=Ee("div",e+" leaflet-bar"),o=this.options;return this._zoomInButton=this._createButton(o.zoomInText,o.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(o.zoomOutText,o.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,o,i){var r=Ee("a",n,o);return r.innerHTML=t,r.href="#",r.title=e,r.setAttribute("role","button"),r.setAttribute("aria-label",e),ne(r),Xt(r,"click",ie),Xt(r,"click",i,this),Xt(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";Oe(this._zoomInButton,e),Oe(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&Ce(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&Ce(this._zoomInButton,e)}});We.mergeOptions({zoomControl:!0}),We.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new $e,this.addControl(this.zoomControl))}));var Je=qe.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=Ee("div",e),o=this.options;return this._addScales(o,e+"-line",n),t.on(o.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=Ee("div",e,n)),t.imperial&&(this._iScale=Ee("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e,n,o,i=3.2808399*t;i>5280?(e=i/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mi",n/e)):(o=this._getRoundNum(i),this._updateScale(this._iScale,o+" ft",o/i))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),Ye=qe.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){f(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=Ee("div","leaflet-control-attribution"),ne(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}}});We.mergeOptions({attributionControl:!0}),We.addInitHook((function(){this.options.attributionControl&&(new Ye).addTo(this)}));qe.Layers=Xe,qe.Zoom=$e,qe.Scale=Je,qe.Attribution=Ye,Ke.layers=function(t,e,n){return new Xe(t,e,n)},Ke.zoom=function(t){return new $e(t)},Ke.scale=function(t){return new Je(t)},Ke.attribution=function(t){return new Ye(t)};var Qe=M.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Qe.addTo=function(t,e){return t.addHandler(e,this),this};var tn,en={Events:C},nn=xt?"touchstart mousedown":"mousedown",on={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},rn={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},sn=O.extend({options:{clickTolerance:3},initialize:function(t,e,n,o){f(this,o),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(Xt(this._dragStartTarget,nn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(sn._dragging===this&&this.finishDrag(),Jt(this._dragStartTarget,nn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!Me(this._element,"leaflet-zoom-anim")&&!(sn._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(sn._dragging=this,this._preventOutline&&Ze(this._element),Fe(),fe(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new A(e.clientX,e.clientY),Xt(document,rn[t.type],this._onMove,this),Xt(document,on[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new A(e.clientX,e.clientY).subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(oe(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Ne(this._element).subtract(n),Ce(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ce(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,S(this._animRequest),this._lastEvent=t,this._animRequest=P(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),De(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in Oe(document.body,"leaflet-dragging"),this._lastTarget&&(Oe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),rn)Jt(document,rn[t],this._onMove,this),Jt(document,on[t],this._onUp,this);He(),de(),this._moved&&this._moving&&(S(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,sn._dragging=!1}});function an(t,e){if(!e||!t.length)return t.slice();var n=e*e;return function(t,e){var n=t.length,o=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);o[0]=o[n-1]=1,un(t,o,e,0,n-1);var i,r=[];for(i=0;i<n;i++)o[i]&&r.push(t[i]);return r}(t=function(t,e){for(var n=[t[0]],o=1,i=0,r=t.length;o<r;o++)fn(t[o],t[i])>e&&(n.push(t[o]),i=o);return i<r-1&&n.push(t[r-1]),n}(t,n),n)}function ln(t,e,n){return Math.sqrt(dn(t,e,n,!0))}function un(t,e,n,o,i){var r,s,a,l=0;for(s=o+1;s<=i-1;s++)(a=dn(t[s],t[o],t[i],!0))>l&&(r=s,l=a);l>n&&(e[r]=1,un(t,e,n,o,r),un(t,e,n,r,i))}function cn(t,e,n,o,i){var r,s,a,l=o?tn:pn(t,n),u=pn(e,n);for(tn=u;;){if(!(l|u))return[t,e];if(l&u)return!1;a=pn(s=hn(t,e,r=l||u,n,i),n),r===l?(t=s,l=a):(e=s,u=a)}}function hn(t,e,n,o,i){var r,s,a=e.x-t.x,l=e.y-t.y,u=o.min,c=o.max;return 8&n?(r=t.x+a*(c.y-t.y)/l,s=c.y):4&n?(r=t.x+a*(u.y-t.y)/l,s=u.y):2&n?(r=c.x,s=t.y+l*(c.x-t.x)/a):1&n&&(r=u.x,s=t.y+l*(u.x-t.x)/a),new A(r,s,i)}function pn(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function fn(t,e){var n=e.x-t.x,o=e.y-t.y;return n*n+o*o}function dn(t,e,n,o){var i,r=e.x,s=e.y,a=n.x-r,l=n.y-s,u=a*a+l*l;return u>0&&((i=((t.x-r)*a+(t.y-s)*l)/u)>1?(r=n.x,s=n.y):i>0&&(r+=a*i,s+=l*i)),a=t.x-r,l=t.y-s,o?a*a+l*l:new A(r,s)}function mn(t){return!v(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function _n(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),mn(t)}var vn=(Object.freeze||Object)({simplify:an,pointToSegmentDistance:ln,closestPointOnSegment:function(t,e,n){return dn(t,e,n)},clipSegment:cn,_getEdgeIntersection:hn,_getBitCode:pn,_sqClosestPointOnSegment:dn,isFlat:mn,_flat:_n});function gn(t,e,n){var o,i,r,s,a,l,u,c,h,p=[1,4,2,8];for(i=0,u=t.length;i<u;i++)t[i]._code=pn(t[i],e);for(s=0;s<4;s++){for(c=p[s],o=[],i=0,r=(u=t.length)-1;i<u;r=i++)a=t[i],l=t[r],a._code&c?l._code&c||((h=hn(l,a,c,e,n))._code=pn(h,e),o.push(h)):(l._code&c&&((h=hn(l,a,c,e,n))._code=pn(h,e),o.push(h)),o.push(a));t=o}return t}var yn=(Object.freeze||Object)({clipPolygon:gn}),bn={project:function(t){return new A(t.lng,t.lat)},unproject:function(t){return new z(t.y,t.x)},bounds:new I([-180,-90],[180,90])},wn={R:6378137,R_MINOR:6356752.314245179,bounds:new I([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,o=t.lat*e,i=this.R_MINOR/n,r=Math.sqrt(1-i*i),s=r*Math.sin(o),a=Math.tan(Math.PI/4-o/2)/Math.pow((1-s)/(1+s),r/2);return o=-n*Math.log(Math.max(a,1e-10)),new A(t.lng*e*n,o)},unproject:function(t){for(var e,n=180/Math.PI,o=this.R,i=this.R_MINOR/o,r=Math.sqrt(1-i*i),s=Math.exp(-t.y/o),a=Math.PI/2-2*Math.atan(s),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)e=r*Math.sin(a),e=Math.pow((1-e)/(1+e),r/2),a+=u=Math.PI/2-2*Math.atan(s*e)-a;return new z(a*n,t.x*n/o)}},xn=(Object.freeze||Object)({LonLat:bn,Mercator:wn,SphericalMercator:G}),Tn=n({},U,{code:"EPSG:3395",projection:wn,transformation:function(){var t=.5/(Math.PI*wn.R);return W(t,.5,-t,.5)}()}),En=n({},U,{code:"EPSG:4326",projection:bn,transformation:W(1/180,1,-1/180,.5)}),Pn=n({},Z,{projection:bn,transformation:W(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,o=e.lat-t.lat;return Math.sqrt(n*n+o*o)},infinite:!0});Z.Earth=U,Z.EPSG3395=Tn,Z.EPSG3857=q,Z.EPSG900913=K,Z.EPSG4326=En,Z.Simple=Pn;var Ln=O.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[s(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[s(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",(function(){e.off(n,this)}),this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});We.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=s(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=s(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&s(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?v(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[s(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=s(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var o in this._zoomBoundLayers){var i=this._zoomBoundLayers[o].options;t=void 0===i.minZoom?t:Math.min(t,i.minZoom),e=void 0===i.maxZoom?e:Math.max(e,i.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Sn=Ln.extend({initialize:function(t,e){var n,o;if(f(this,e),this._layers={},t)for(n=0,o=t.length;n<o;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,o=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,o);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return s(t)}}),kn=Sn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Sn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Sn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new D;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),Mn=M.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){f(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var o=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(o,t),o},_setIconStyles:function(t,e){var n=this.options,o=n[e+"Size"];"number"==typeof o&&(o=[o,o]);var i=j(o),r=j("shadow"===e&&n.shadowAnchor||n.iconAnchor||i&&i.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),i&&(t.style.width=i.x+"px",t.style.height=i.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Pt&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});var Cn=Mn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return Cn.imagePath||(Cn.imagePath=this._detectIconPath()),(this.options.imagePath||Cn.imagePath)+Mn.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=Ee("div","leaflet-default-icon-path",document.body),e=Te(t,"background-image")||Te(t,"backgroundImage");return document.body.removeChild(t),null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),On=Qe.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new sn(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ce(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Oe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,o=this._marker.options.autoPanSpeed,i=this._marker.options.autoPanPadding,r=L.DomUtil.getPosition(e._icon),s=n.getPixelBounds(),a=n.getPixelOrigin(),l=B(s.min._subtract(a).add(i),s.max._subtract(a).subtract(i));if(!l.contains(r)){var u=j((Math.max(l.max.x,r.x)-l.max.x)/(s.max.x-l.max.x)-(Math.min(l.min.x,r.x)-l.min.x)/(s.min.x-l.min.x),(Math.max(l.max.y,r.y)-l.max.y)/(s.max.y-l.max.y)-(Math.min(l.min.y,r.y)-l.min.y)/(s.min.y-l.min.y)).multiplyBy(o);n.panBy(u,{animate:!1}),this._draggable._newPos._add(u),this._draggable._startPos._add(u),L.DomUtil.setPosition(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=P(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(S(this._panRequest),this._panRequest=P(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,o=Ne(e._icon),i=e._map.layerPointToLatLng(o);n&&De(n,o),e._latlng=i,t.latlng=i,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){S(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),An=Ln.extend({options:{icon:new Cn,interactive:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},initialize:function(t,e){f(this,e),this._latlng=F(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),o=!1;n!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(n.title=t.title),"IMG"===n.tagName&&(n.alt=t.alt||"")),Ce(n,e),t.keyboard&&(n.tabIndex="0"),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var i=t.icon.createShadow(this._shadow),r=!1;i!==this._shadow&&(this._removeShadow(),r=!0),i&&(Ce(i,e),i.alt=""),this._shadow=i,t.opacity<1&&this._updateOpacity(),o&&this.getPane().appendChild(this._icon),this._initInteraction(),i&&r&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),Pe(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Pe(this._shadow),this._shadow=null},_setPos:function(t){De(this._icon,t),this._shadow&&De(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(Ce(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),On)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new On(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;je(this._icon,t),this._shadow&&je(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Rn=Ln.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return f(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),jn=Rn.extend({options:{fill:!0,radius:10},initialize:function(t,e){f(this,e),this._latlng=F(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=F(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Rn.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),o=[t+n,e+n];this._pxBounds=new I(this._point.subtract(o),this._point.add(o))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var In=jn.extend({initialize:function(t,e,o){if("number"==typeof e&&(e=n({},o,{radius:e})),f(this,e),this._latlng=F(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new D(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Rn.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,o=n.options.crs;if(o.distance===U.distance){var i=Math.PI/180,r=this._mRadius/U.R/i,s=n.project([e+r,t]),a=n.project([e-r,t]),l=s.add(a).divideBy(2),u=n.unproject(l).lat,c=Math.acos((Math.cos(r*i)-Math.sin(e*i)*Math.sin(u*i))/(Math.cos(e*i)*Math.cos(u*i)))/i;(isNaN(c)||0===c)&&(c=r/Math.cos(Math.PI/180*e)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(c)?0:l.x-n.project([u,t-c]).x,this._radiusY=l.y-s.y}else{var h=o.unproject(o.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}});var Bn=Rn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){f(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,o=1/0,i=null,r=dn,s=0,a=this._parts.length;s<a;s++)for(var l=this._parts[s],u=1,c=l.length;u<c;u++){var h=r(t,e=l[u-1],n=l[u],!0);h<o&&(o=h,i=r(t,e,n))}return i&&(i.distance=Math.sqrt(o)),i},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,o,i,r,s,a=this._rings[0],l=a.length;if(!l)return null;for(t=0,e=0;t<l-1;t++)e+=a[t].distanceTo(a[t+1])/2;if(0===e)return this._map.layerPointToLatLng(a[0]);for(t=0,o=0;t<l-1;t++)if(i=a[t],r=a[t+1],(o+=n=i.distanceTo(r))>e)return s=(o-e)/n,this._map.layerPointToLatLng([r.x-s*(r.x-i.x),r.y-s*(r.y-i.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=F(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new D,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return mn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=mn(t),o=0,i=t.length;o<i;o++)n?(e[o]=F(t[o]),this._bounds.extend(e[o])):e[o]=this._convertLatLngs(t[o]);return e},_project:function(){var t=new I;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),n=new A(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(n),t.max._add(n),this._pxBounds=t)},_projectLatlngs:function(t,e,n){var o,i,r=t[0]instanceof z,s=t.length;if(r){for(i=[],o=0;o<s;o++)i[o]=this._map.latLngToLayerPoint(t[o]),n.extend(i[o]);e.push(i)}else for(o=0;o<s;o++)this._projectLatlngs(t[o],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,o,i,r,s,a,l=this._parts;for(e=0,o=0,i=this._rings.length;e<i;e++)for(n=0,r=(a=this._rings[e]).length;n<r-1;n++)(s=cn(a[n],a[n+1],t,n,!0))&&(l[o]=l[o]||[],l[o].push(s[0]),s[1]===a[n+1]&&n!==r-2||(l[o].push(s[1]),o++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,o=t.length;n<o;n++)t[n]=an(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,o,i,r,s,a,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,r=this._parts.length;n<r;n++)for(o=0,i=(s=(a=this._parts[n]).length)-1;o<s;i=o++)if((e||0!==o)&&ln(t,a[i],a[o])<=l)return!0;return!1}});Bn._flat=_n;var Dn=Bn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,o,i,r,s,a,l,u=this._rings[0],c=u.length;if(!c)return null;for(r=s=a=0,t=0,e=c-1;t<c;e=t++)n=u[t],o=u[e],i=n.y*o.x-o.y*n.x,s+=(n.x+o.x)*i,a+=(n.y+o.y)*i,r+=3*i;return l=0===r?u[0]:[s/r,a/r],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=Bn.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof z&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){Bn.prototype._setLatLngs.call(this,t),mn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return mn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new A(e,e);if(t=new I(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var o,i=0,r=this._rings.length;i<r;i++)(o=gn(this._rings[i],t,!0)).length&&this._parts.push(o)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,o,i,r,s,a,l,u=!1;if(!this._pxBounds.contains(t))return!1;for(i=0,a=this._parts.length;i<a;i++)for(r=0,s=(l=(e=this._parts[i]).length)-1;r<l;s=r++)n=e[r],o=e[s],n.y>t.y!=o.y>t.y&&t.x<(o.x-n.x)*(t.y-n.y)/(o.y-n.y)+n.x&&(u=!u);return u||Bn.prototype._containsPoint.call(this,t,!0)}});var Nn=kn.extend({initialize:function(t,e){f(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,o,i=v(t)?t:t.features;if(i){for(e=0,n=i.length;e<n;e++)((o=i[e]).geometries||o.geometry||o.features||o.coordinates)&&this.addData(o);return this}var r=this.options;if(r.filter&&!r.filter(t))return this;var s=zn(t,r);return s?(s.feature=Vn(t),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return t.options=n({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}});function zn(t,e){var n,o,i,r,s="Feature"===t.type?t.geometry:t,a=s?s.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||Fn;if(!a&&!s)return null;switch(s.type){case"Point":return n=c(a),u?u(t,n):new An(n);case"MultiPoint":for(i=0,r=a.length;i<r;i++)n=c(a[i]),l.push(u?u(t,n):new An(n));return new kn(l);case"LineString":case"MultiLineString":return o=Hn(a,"LineString"===s.type?0:1,c),new Bn(o,e);case"Polygon":case"MultiPolygon":return o=Hn(a,"Polygon"===s.type?1:2,c),new Dn(o,e);case"GeometryCollection":for(i=0,r=s.geometries.length;i<r;i++){var h=zn({geometry:s.geometries[i],type:"Feature",properties:t.properties},e);h&&l.push(h)}return new kn(l);default:throw new Error("Invalid GeoJSON object.")}}function Fn(t){return new z(t[1],t[0],t[2])}function Hn(t,e,n){for(var o,i=[],r=0,s=t.length;r<s;r++)o=e?Hn(t[r],e-1,n):(n||Fn)(t[r]),i.push(o);return i}function Zn(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[c(t.lng,e),c(t.lat,e),c(t.alt,e)]:[c(t.lng,e),c(t.lat,e)]}function Un(t,e,n,o){for(var i=[],r=0,s=t.length;r<s;r++)i.push(e?Un(t[r],e-1,n,o):Zn(t[r],o));return!e&&n&&i.push(i[0]),i}function Gn(t,e){return t.feature?n({},t.feature,{geometry:e}):Vn(e)}function Vn(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Wn={toGeoJSON:function(t){return Gn(this,{type:"Point",coordinates:Zn(this.getLatLng(),t)})}};function qn(t,e){return new Nn(t,e)}An.include(Wn),In.include(Wn),jn.include(Wn),Bn.include({toGeoJSON:function(t){var e=!mn(this._latlngs);return Gn(this,{type:(e?"Multi":"")+"LineString",coordinates:Un(this._latlngs,e?1:0,!1,t)})}}),Dn.include({toGeoJSON:function(t){var e=!mn(this._latlngs),n=e&&!mn(this._latlngs[0]),o=Un(this._latlngs,n?2:e?1:0,!0,t);return e||(o=[o]),Gn(this,{type:(n?"Multi":"")+"Polygon",coordinates:o})}}),Sn.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(n){e.push(n.toGeoJSON(t).geometry.coordinates)})),Gn(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,o=[];return this.eachLayer((function(e){if(e.toGeoJSON){var i=e.toGeoJSON(t);if(n)o.push(i.geometry);else{var r=Vn(i);"FeatureCollection"===r.type?o.push.apply(o,r.features):o.push(r)}}})),n?Gn(this,{geometries:o,type:"GeometryCollection"}):{type:"FeatureCollection",features:o}}});var Kn=qn,Xn=Ln.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=N(e),f(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ce(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Pe(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&Se(this._image),this},bringToBack:function(){return this._map&&ke(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=N(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:Ee("img");Ce(e,"leaflet-image-layer"),this._zoomAnimated&&Ce(e,"leaflet-zoom-animated"),this.options.className&&Ce(e,this.options.className),e.onselectstart=u,e.onmousemove=u,e.onload=i(this.fire,this,"load"),e.onerror=i(this._overlayOnError,this,"error"),this.options.crossOrigin&&(e.crossOrigin=""),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Be(this._image,n,e)},_reset:function(){var t=this._image,e=new I(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();De(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){je(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),$n=Xn.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:Ee("video");if(Ce(e,"leaflet-image-layer"),this._zoomAnimated&&Ce(e,"leaflet-zoom-animated"),e.onselectstart=u,e.onmousemove=u,e.onloadeddata=i(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),o=[],r=0;r<n.length;r++)o.push(n[r].src);this._url=n.length>0?o:[e.src]}else{v(this._url)||(this._url=[this._url]),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop;for(var s=0;s<this._url.length;s++){var a=Ee("source");a.src=this._url[s],e.appendChild(a)}}}});var Jn=Ln.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){f(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&je(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&je(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(je(this._container,0),this._removeTimeout=setTimeout(i(Pe,void 0,this._container),200)):Pe(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=F(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Se(this._container),this},bringToBack:function(){return this._map&&ke(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=j(this.options.offset),n=this._getAnchor();this._zoomAnimated?De(this._container,t.add(n)):e=e.add(t).add(n);var o=this._containerBottom=-e.y,i=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=o+"px",this._container.style.left=i+"px"}},_getAnchor:function(){return[0,0]}}),Yn=Jn.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Jn.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Rn||this._source.on("preclick",te))},onRemove:function(t){Jn.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Rn||this._source.off("preclick",te))},getEvents:function(){var t=Jn.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=Ee("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=Ee("div",t+"-content-wrapper",e);if(this._contentNode=Ee("div",t+"-content",n),ne(n),ee(this._contentNode),Xt(n,"contextmenu",te),this._tipContainer=Ee("div",t+"-tip-container",e),this._tip=Ee("div",t+"-tip",this._tipContainer),this.options.closeButton){var o=this._closeButton=Ee("a",t+"-close-button",e);o.href="#close",o.innerHTML="&#215;",Xt(o,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var o=t.offsetHeight,i=this.options.maxHeight,r="leaflet-popup-scrolled";i&&o>i?(e.height=i+"px",Ce(t,r)):Oe(t,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();De(this._container,e.add(n))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(Te(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,o=this._containerWidth,i=new A(this._containerLeft,-n-this._containerBottom);i._add(Ne(this._container));var r=t.layerPointToContainerPoint(i),s=j(this.options.autoPanPadding),a=j(this.options.autoPanPaddingTopLeft||s),l=j(this.options.autoPanPaddingBottomRight||s),u=t.getSize(),c=0,h=0;r.x+o+l.x>u.x&&(c=r.x+o-u.x+l.x),r.x-c-a.x<0&&(c=r.x-a.x),r.y+n+l.y>u.y&&(h=r.y+n-u.y+l.y),r.y-h-a.y<0&&(h=r.y-a.y),(c||h)&&t.fire("autopanstart").panBy([c,h])}},_onCloseButtonClick:function(t){this._close(),ie(t)},_getAnchor:function(){return j(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});We.mergeOptions({closePopupOnClick:!0}),We.include({openPopup:function(t,e,n){return t instanceof Yn||(t=new Yn(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),Ln.include({bindPopup:function(t,e){return t instanceof Yn?(f(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new Yn(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof Ln||(e=t,t=this),t instanceof kn)for(var n in this._layers){t=this._layers[n];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(ie(t),e instanceof Rn?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Qn=Jn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Jn.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Jn.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Jn.prototype.getEvents.call(this);return xt&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ee("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,n=this._container,o=e.latLngToContainerPoint(e.getCenter()),i=e.layerPointToContainerPoint(t),r=this.options.direction,s=n.offsetWidth,a=n.offsetHeight,l=j(this.options.offset),u=this._getAnchor();"top"===r?t=t.add(j(-s/2+l.x,-a+l.y+u.y,!0)):"bottom"===r?t=t.subtract(j(s/2-l.x,-l.y,!0)):"center"===r?t=t.subtract(j(s/2+l.x,a/2-u.y+l.y,!0)):"right"===r||"auto"===r&&i.x<o.x?(r="right",t=t.add(j(l.x+u.x,u.y-a/2+l.y,!0))):(r="left",t=t.subtract(j(s+u.x-l.x,a/2-u.y-l.y,!0))),Oe(n,"leaflet-tooltip-right"),Oe(n,"leaflet-tooltip-left"),Oe(n,"leaflet-tooltip-top"),Oe(n,"leaflet-tooltip-bottom"),Ce(n,"leaflet-tooltip-"+r),De(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&je(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return j(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});We.include({openTooltip:function(t,e,n){return t instanceof Qn||(t=new Qn(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),Ln.include({bindTooltip:function(t,e){return t instanceof Qn?(f(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new Qn(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),xt&&(n.click=this._openTooltip)),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof Ln||(e=t,t=this),t instanceof kn)for(var n in this._layers){t=this._layers[n];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(Ce(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(Oe(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,n,o=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),o=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(o)}});var to=Mn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var o=j(n.bgPos);e.style.backgroundPosition=-o.x+"px "+-o.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});Mn.Default=Cn;var eo=Ln.extend({options:{tileSize:256,opacity:1,updateWhenIdle:vt,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){f(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),Pe(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Se(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ke(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=a(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof A?t:new A(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,o=-t(-1/0,1/0),i=0,r=n.length;i<r;i++)e=n[i].style.zIndex,n[i]!==this._container&&e&&(o=t(o,+e));isFinite(o)&&(this.options.zIndex=o+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Q){je(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var o in this._tiles){var i=this._tiles[o];if(i.current&&i.loaded){var r=Math.min(1,(t-i.loaded)/200);je(i.el,r),r<1?e=!0:(i.active?n=!0:this._onOpaqueTile(i),i.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(S(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this))}},_onOpaqueTile:u,_initContainer:function(){this._container||(this._container=Ee("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(Pe(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var o=this._levels[t],i=this._map;return o||((o=this._levels[t]={}).el=Ee("div","leaflet-tile-container leaflet-zoom-animated",this._container),o.el.style.zIndex=e,o.origin=i.project(i.unproject(i.getPixelOrigin()),t).round(),o.zoom=t,this._setZoomTransform(o,i.getCenter(),i.getZoom()),o.el.offsetWidth,this._onCreateLevel(o)),this._level=o,o}},_onUpdateLevel:u,_onRemoveLevel:u,_onCreateLevel:u,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var o=e.coords;this._retainParent(o.x,o.y,o.z,o.z-5)||this._retainChildren(o.x,o.y,o.z,o.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)Pe(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,o){var i=Math.floor(t/2),r=Math.floor(e/2),s=n-1,a=new A(+i,+r);a.z=+s;var l=this._tileCoordsToKey(a),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),s>o&&this._retainParent(i,r,s,o))},_retainChildren:function(t,e,n,o){for(var i=2*t;i<2*t+2;i++)for(var r=2*e;r<2*e+2;r++){var s=new A(i,r);s.z=n+1;var a=this._tileCoordsToKey(s),l=this._tiles[a];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<o&&this._retainChildren(i,r,n+1,o))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,o){var i=this._clampZoom(Math.round(e));(void 0!==this.options.maxZoom&&i>this.options.maxZoom||void 0!==this.options.minZoom&&i<this.options.minZoom)&&(i=void 0);var r=this.options.updateWhenZooming&&i!==this._tileZoom;o&&!r||(this._tileZoom=i,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==i&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var o=this._map.getZoomScale(n,t.zoom),i=t.origin.multiplyBy(o).subtract(this._map._getNewPixelOrigin(e,n)).round();_t?Be(t.el,i,o):De(t.el,i)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),o=this._tileZoom,i=this._map.getPixelWorldBounds(this._tileZoom);i&&(this._globalTileRange=this._pxBoundsToTileRange(i)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],o).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],o).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],o).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],o).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),o=e.getZoomScale(n,this._tileZoom),i=e.project(t,this._tileZoom).floor(),r=e.getSize().divideBy(2*o);return new I(i.subtract(r),i.add(r))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var o=this._getTiledPixelBounds(t),i=this._pxBoundsToTileRange(o),r=i.getCenter(),s=[],a=this.options.keepBuffer,l=new I(i.getBottomLeft().subtract([a,-a]),i.getTopRight().add([a,-a]));if(!(isFinite(i.min.x)&&isFinite(i.min.y)&&isFinite(i.max.x)&&isFinite(i.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var u in this._tiles){var c=this._tiles[u].coords;c.z===this._tileZoom&&l.contains(new A(c.x,c.y))||(this._tiles[u].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(t,n);else{for(var h=i.min.y;h<=i.max.y;h++)for(var p=i.min.x;p<=i.max.x;p++){var f=new A(p,h);if(f.z=this._tileZoom,this._isValidTile(f)){var d=this._tiles[this._tileCoordsToKey(f)];d?d.current=!0:s.push(f)}}if(s.sort((function(t,e){return t.distanceTo(r)-e.distanceTo(r)})),0!==s.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(p=0;p<s.length;p++)this._addTile(s[p],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var o=this._tileCoordsToBounds(t);return N(this.options.bounds).overlaps(o)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),o=t.scaleBy(n),i=o.add(n);return[e.unproject(o,t.z),e.unproject(i,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new D(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new A(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(rt||e.el.setAttribute("src",y),Pe(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){Ce(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=u,t.onmousemove=u,Q&&this.options.opacity<1&&je(t,this.options.opacity),nt&&!ot&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var n=this._getTilePos(t),o=this._tileCoordsToKey(t),r=this.createTile(this._wrapCoords(t),i(this._tileReady,this,t));this._initTile(r),this.createTile.length<2&&P(i(this._tileReady,this,t,null,r)),De(r,n),this._tiles[o]={el:r,coords:t,current:!0},e.appendChild(r),this.fire("tileloadstart",{tile:r,coords:t})},_tileReady:function(t,e,n){if(this._map){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var o=this._tileCoordsToKey(t);(n=this._tiles[o])&&(n.loaded=+new Date,this._map._fadeAnimated?(je(n.el,0),S(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(Ce(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Q||!this._map._fadeAnimated?P(this._pruneTiles,this):setTimeout(i(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new A(this._wrapX?l(t.x,this._wrapX):t.x,this._wrapY?l(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new I(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});var no=eo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=f(this,e)).detectRetina&&Pt&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),nt||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return Xt(n,"load",i(this._tileOnLoad,this,e,n)),Xt(n,"error",i(this._tileOnError,this,e,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:Pt?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var o=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=o),e["-y"]=o}return _(this._url,n(e,this.options))},_tileOnLoad:function(t,e){Q?setTimeout(i(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var o=this.options.errorTileUrl;o&&e.getAttribute("src")!==o&&(e.src=o),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=u,e.onerror=u,e.complete||(e.src=y,Pe(e),delete this._tiles[t]))}});function oo(t,e){return new no(t,e)}var io=no.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var o=n({},this.defaultWmsParams);for(var i in e)i in this.options||(o[i]=e[i]);var r=(e=f(this,e)).detectRetina&&Pt?2:1,s=this.getTileSize();o.width=s.x*r,o.height=s.y*r,this.wmsParams=o},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,no.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,o=B(n.project(e[0]),n.project(e[1])),i=o.min,r=o.max,s=(this._wmsVersion>=1.3&&this._crs===En?[i.y,i.x,r.y,r.x]:[i.x,i.y,r.x,r.y]).join(","),a=L.TileLayer.prototype.getTileUrl.call(this,t);return a+d(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+s},setParams:function(t,e){return n(this.wmsParams,t),e||this.redraw(),this}});no.WMS=io,oo.wms=function(t,e){return new io(t,e)};var ro=Ln.extend({options:{padding:.1,tolerance:0},initialize:function(t){f(this,t),s(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Ce(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),o=Ne(this._container),i=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,e),s=this._map.project(t,e).subtract(r),a=i.multiplyBy(-n).add(o).add(i).subtract(s);_t?Be(this._container,a,n):De(this._container,a)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new I(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),so=ro.extend({getEvents:function(){var t=ro.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ro.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Xt(t,"mousemove",a(this._onMouseMove,32,this),this),Xt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Xt(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){delete this._ctx,Pe(this._container),Jt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},ro.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),o=Pt?2:1;De(e,t.min),e.width=o*n.x,e.height=o*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",Pt&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){ro.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[s(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,o=e.prev;n?n.prev=o:this._drawLast=o,o?o.next=n:this._drawFirst=n,delete t._order,delete this._layers[L.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,n=t.options.dashArray.split(","),o=[];for(e=0;e<n.length;e++)o.push(Number(n[e]));t.options._dashArray=o}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||P(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new I,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var o=this._drawFirst;o;o=o.next)t=o.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,o,i,r,s=t._parts,a=s.length,l=this._ctx;if(a){for(this._drawnLayers[t._leaflet_id]=t,l.beginPath(),n=0;n<a;n++){for(o=0,i=s[n].length;o<i;o++)r=s[n][o],l[o?"lineTo":"moveTo"](r.x,r.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,o=Math.max(Math.round(t._radius),1),i=(Math.max(Math.round(t._radiusY),1)||o)/o;this._drawnLayers[t._leaflet_id]=t,1!==i&&(n.save(),n.scale(1,i)),n.beginPath(),n.arc(e.x,e.y/i,o,0,2*Math.PI,!1),1!==i&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,o=this._map.mouseEventToLayerPoint(t),i=this._drawFirst;i;i=i.next)(e=i.layer).options.interactive&&e._containsPoint(o)&&!this._map._draggableMoved(e)&&(n=e);n&&(ce(t),this._fireEvent([n],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(Oe(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var n,o,i=this._drawFirst;i;i=i.next)(n=i.layer).options.interactive&&n._containsPoint(e)&&(o=n);o!==this._hoveredLayer&&(this._handleMouseOut(t),o&&(Ce(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseover"),this._hoveredLayer=o)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order,n=e.next,o=e.prev;n&&(n.prev=o,o?o.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,n=e.next,o=e.prev;o&&(o.next=n,n?n.prev=o:o&&(this._drawLast=o),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}});function ao(t){return Lt?new so(t):null}var lo=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),uo={_initContainer:function(){this._container=Ee("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ro.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=lo("shape");Ce(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=lo("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[s(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;Pe(e),t.removeInteractiveTarget(e),delete this._layers[s(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,o=t.options,i=t._container;i.stroked=!!o.stroke,i.filled=!!o.fill,o.stroke?(e||(e=t._stroke=lo("stroke")),i.appendChild(e),e.weight=o.weight+"px",e.color=o.color,e.opacity=o.opacity,o.dashArray?e.dashStyle=v(o.dashArray)?o.dashArray.join(" "):o.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=o.lineCap.replace("butt","flat"),e.joinstyle=o.lineJoin):e&&(i.removeChild(e),t._stroke=null),o.fill?(n||(n=t._fill=lo("fill")),i.appendChild(n),n.color=o.fillColor||o.color,n.opacity=o.fillOpacity):n&&(i.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),o=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+o+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){Se(t._container)},_bringToBack:function(t){ke(t._container)}},co=kt?lo:X,ho=ro.extend({getEvents:function(){var t=ro.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=co("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=co("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Pe(this._container),Jt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){ro.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),De(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=co("path");t.options.className&&Ce(e,t.options.className),t.options.interactive&&Ce(e,"leaflet-interactive"),this._updateStyle(t),this._layers[s(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){Pe(t._path),t.removeInteractiveTarget(t._path),delete this._layers[s(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,$(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),o="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",i=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+o+2*n+",0 "+o+2*-n+",0 ";this._setPath(t,i)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){Se(t._path)},_bringToBack:function(t){ke(t._path)}});function po(t){return St||kt?new ho(t):null}kt&&ho.include(uo),We.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&ao()||po()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=ho&&po({pane:t})||so&&ao({pane:t}),this._paneRenderers[t]=e),e}});var fo=Dn.extend({initialize:function(t,e){Dn.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=N(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});ho.create=co,ho.pointsToPath=$,Nn.geometryToLayer=zn,Nn.coordsToLatLng=Fn,Nn.coordsToLatLngs=Hn,Nn.latLngToCoords=Zn,Nn.latLngsToCoords=Un,Nn.getFeature=Gn,Nn.asFeature=Vn,We.mergeOptions({boxZoom:!0});var mo=Qe.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Xt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Jt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Pe(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),fe(),Fe(),this._startPoint=this._map.mouseEventToContainerPoint(t),Xt(document,{contextmenu:ie,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Ee("div","leaflet-zoom-box",this._container),Ce(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new I(this._point,this._startPoint),n=e.getSize();De(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(Pe(this._box),Oe(this._container,"leaflet-crosshair")),de(),He(),Jt(document,{contextmenu:ie,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(i(this._resetState,this),0);var e=new D(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});We.addInitHook("addHandler","boxZoom",mo),We.mergeOptions({doubleClickZoom:!0});var _o=Qe.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),o=e.options.zoomDelta,i=t.originalEvent.shiftKey?n-o:n+o;"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}});We.addInitHook("addHandler","doubleClickZoom",_o),We.mergeOptions({dragging:!0,inertia:!ot,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var vo=Qe.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new sn(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}Ce(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Oe(this._map._container,"leaflet-grab"),Oe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=N(this._map.options.maxBounds);this._offsetLimit=B(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,o=this._draggable._newPos.x,i=(o-e+n)%t+e-n,r=(o+e+n)%t-e-n,s=Math.abs(i+n)<Math.abs(r+n)?i:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=s},_onDragEnd:function(t){var e=this._map,n=e.options,o=!n.inertia||this._times.length<2;if(e.fire("dragend",t),o)e.fire("moveend");else{this._prunePositions(+new Date);var i=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,s=n.easeLinearity,a=i.multiplyBy(s/r),l=a.distanceTo([0,0]),u=Math.min(n.inertiaMaxSpeed,l),c=a.multiplyBy(u/l),h=u/(n.inertiaDeceleration*s),p=c.multiplyBy(-h/2).round();p.x||p.y?(p=e._limitOffset(p,e.options.maxBounds),P((function(){e.panBy(p,{duration:h,easeLinearity:s,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});We.addInitHook("addHandler","dragging",vo),We.mergeOptions({keyboard:!0,keyboardPanDelta:80});var go=Qe.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Xt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Jt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,o=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(o,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,o=this._panKeys={},i=this.keyCodes;for(e=0,n=i.left.length;e<n;e++)o[i.left[e]]=[-1*t,0];for(e=0,n=i.right.length;e<n;e++)o[i.right[e]]=[t,0];for(e=0,n=i.down.length;e<n;e++)o[i.down[e]]=[0,t];for(e=0,n=i.up.length;e<n;e++)o[i.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,o=this._zoomKeys={},i=this.keyCodes;for(e=0,n=i.zoomIn.length;e<n;e++)o[i.zoomIn[e]]=t;for(e=0,n=i.zoomOut.length;e<n;e++)o[i.zoomOut[e]]=-t},_addHooks:function(){Xt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Jt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,o=this._map;if(n in this._panKeys){if(o._panAnim&&o._panAnim._inProgress)return;e=this._panKeys[n],t.shiftKey&&(e=j(e).multiplyBy(3)),o.panBy(e),o.options.maxBounds&&o.panInsideBounds(o.options.maxBounds)}else if(n in this._zoomKeys)o.setZoom(o.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!o._popup||!o._popup.options.closeOnEscapeKey)return;o.closePopup()}ie(t)}}});We.addInitHook("addHandler","keyboard",go),We.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var yo=Qe.extend({addHooks:function(){Xt(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Jt(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=ae(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var o=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(i(this._performZoom,this),o),ie(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var o=this._delta/(4*this._map.options.wheelPxPerZoomLevel),i=4*Math.log(2/(1+Math.exp(-Math.abs(o))))/Math.LN2,r=n?Math.ceil(i/n)*n:i,s=t._limitZoom(e+(this._delta>0?r:-r))-e;this._delta=0,this._startTime=null,s&&("center"===t.options.scrollWheelZoom?t.setZoom(e+s):t.setZoomAround(this._lastMousePos,e+s))}});We.addInitHook("addHandler","scrollWheelZoom",yo),We.mergeOptions({tap:!0,tapTolerance:15});var bo=Qe.extend({addHooks:function(){Xt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Jt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(oe(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new A(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&Ce(n,"leaflet-active"),this._holdTimeout=setTimeout(i((function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))}),this),1e3),this._simulateEvent("mousedown",e),Xt(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),Jt(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&Oe(n,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new A(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var n=document.createEvent("MouseEvents");n._simulated=!0,e.target._simulatedClick=!0,n.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}});xt&&!wt&&We.addInitHook("addHandler","tap",bo),We.mergeOptions({touchZoom:xt&&!ot,bounceAtZoomLimits:!0});var wo=Qe.extend({addHooks:function(){Ce(this._map._container,"leaflet-touch-zoom"),Xt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Oe(this._map._container,"leaflet-touch-zoom"),Jt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(o)._divideBy(2))),this._startDist=n.distanceTo(o),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Xt(document,"touchmove",this._onTouchMove,this),Xt(document,"touchend",this._onTouchEnd,this),oe(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]),r=n.distanceTo(o)/this._startDist;if(this._zoom=e.getScaleZoom(r,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&r<1||this._zoom>e.getMaxZoom()&&r>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===r)return}else{var s=n._add(o)._divideBy(2)._subtract(this._centerPoint);if(1===r&&0===s.x&&0===s.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(s),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),S(this._animRequest);var a=i(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=P(a,this,!0),oe(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,S(this._animRequest),Jt(document,"touchmove",this._onTouchMove),Jt(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});We.addInitHook("addHandler","touchZoom",wo),We.BoxZoom=mo,We.DoubleClickZoom=_o,We.Drag=vo,We.Keyboard=go,We.ScrollWheelZoom=yo,We.Tap=bo,We.TouchZoom=wo;var xo=window.L;window.L=t,Object.freeze=e,t.version="1.3.1",t.noConflict=function(){return window.L=xo,this},t.Control=qe,t.control=Ke,t.Browser=Ct,t.Evented=O,t.Mixin=en,t.Util=k,t.Class=M,t.Handler=Qe,t.extend=n,t.bind=i,t.stamp=s,t.setOptions=f,t.DomEvent=ge,t.DomUtil=Ge,t.PosAnimation=Ve,t.Draggable=sn,t.LineUtil=vn,t.PolyUtil=yn,t.Point=A,t.point=j,t.Bounds=I,t.bounds=B,t.Transformation=V,t.transformation=W,t.Projection=xn,t.LatLng=z,t.latLng=F,t.LatLngBounds=D,t.latLngBounds=N,t.CRS=Z,t.GeoJSON=Nn,t.geoJSON=qn,t.geoJson=Kn,t.Layer=Ln,t.LayerGroup=Sn,t.layerGroup=function(t,e){return new Sn(t,e)},t.FeatureGroup=kn,t.featureGroup=function(t){return new kn(t)},t.ImageOverlay=Xn,t.imageOverlay=function(t,e,n){return new Xn(t,e,n)},t.VideoOverlay=$n,t.videoOverlay=function(t,e,n){return new $n(t,e,n)},t.DivOverlay=Jn,t.Popup=Yn,t.popup=function(t,e){return new Yn(t,e)},t.Tooltip=Qn,t.tooltip=function(t,e){return new Qn(t,e)},t.Icon=Mn,t.icon=function(t){return new Mn(t)},t.DivIcon=to,t.divIcon=function(t){return new to(t)},t.Marker=An,t.marker=function(t,e){return new An(t,e)},t.TileLayer=no,t.tileLayer=oo,t.GridLayer=eo,t.gridLayer=function(t){return new eo(t)},t.SVG=ho,t.svg=po,t.Renderer=ro,t.Canvas=so,t.canvas=ao,t.Path=Rn,t.CircleMarker=jn,t.circleMarker=function(t,e){return new jn(t,e)},t.Circle=In,t.circle=function(t,e,n){return new In(t,e,n)},t.Polyline=Bn,t.polyline=function(t,e){return new Bn(t,e)},t.Polygon=Dn,t.polygon=function(t,e){return new Dn(t,e)},t.Rectangle=fo,t.rectangle=function(t,e){return new fo(t,e)},t.Map=We,t.map=function(t,e){return new We(t,e)}}(e)},5228:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(t){o[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}()?Object.assign:function(t,i){for(var r,s,a=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),l=1;l<arguments.length;l++){for(var u in r=Object(arguments[l]))n.call(r,u)&&(a[u]=r[u]);if(e){s=e(r);for(var c=0;c<s.length;c++)o.call(r,s[c])&&(a[s[c]]=r[s[c]])}}return a}},2694:(t,e,n)=>{"use strict";var o=n(6925);function i(){}function r(){}r.resetWarningCache=i,t.exports=function(){function t(t,e,n,i,r,s){if(s!==o){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:r,resetWarningCache:i};return n.PropTypes=n,n}},5556:(t,e,n)=>{t.exports=n(2694)()},6925:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7790:(t,e,n)=>{var o=n(9852);function i(t){this.mode=o.MODE_8BIT_BYTE,this.data=t}i.prototype={getLength:function(t){return this.data.length},write:function(t){for(var e=0;e<this.data.length;e++)t.put(this.data.charCodeAt(e),8)}},t.exports=i},46:t=>{function e(){this.buffer=new Array,this.length=0}e.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},t.exports=e},1537:t=>{t.exports={L:1,M:0,Q:3,H:2}},501:(t,e,n)=>{var o=n(9341);function i(t,e){if(null==t.length)throw new Error(t.length+"/"+e);for(var n=0;n<t.length&&0==t[n];)n++;this.num=new Array(t.length-n+e);for(var o=0;o<t.length-n;o++)this.num[o]=t[o+n]}i.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var r=0;r<t.getLength();r++)e[n+r]^=o.gexp(o.glog(this.get(n))+o.glog(t.get(r)));return new i(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=o.glog(this.get(0))-o.glog(t.get(0)),n=new Array(this.getLength()),r=0;r<this.getLength();r++)n[r]=this.get(r);for(r=0;r<t.getLength();r++)n[r]^=o.gexp(o.glog(t.get(r))+e);return new i(n,0).mod(t)}},t.exports=i},6641:(t,e,n)=>{var o=n(7790),i=n(2835),r=n(46),s=n(8759),a=n(501);function l(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var u=l.prototype;u.addData=function(t){var e=new o(t);this.dataList.push(e),this.dataCache=null},u.isDark=function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},u.getModuleCount=function(){return this.moduleCount},u.make=function(){if(this.typeNumber<1){var t=1;for(t=1;t<40;t++){for(var e=i.getRSBlocks(t,this.errorCorrectLevel),n=new r,o=0,a=0;a<e.length;a++)o+=e[a].dataCount;for(a=0;a<this.dataList.length;a++){var l=this.dataList[a];n.put(l.mode,4),n.put(l.getLength(),s.getLengthInBits(l.mode,t)),l.write(n)}if(n.getLengthInBits()<=8*o)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())},u.makeImpl=function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[n][o]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=l.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},u.setupPositionProbePattern=function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var o=-1;o<=7;o++)e+o<=-1||this.moduleCount<=e+o||(this.modules[t+n][e+o]=0<=n&&n<=6&&(0==o||6==o)||0<=o&&o<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=o&&o<=4)},u.getBestMaskPattern=function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var o=s.getLostPoint(this);(0==n||t>o)&&(t=o,e=n)}return e},u.createMovieClip=function(t,e,n){var o=t.createEmptyMovieClip(e,n);this.make();for(var i=0;i<this.modules.length;i++)for(var r=1*i,s=0;s<this.modules[i].length;s++){var a=1*s;this.modules[i][s]&&(o.beginFill(0,100),o.moveTo(a,r),o.lineTo(a+1,r),o.lineTo(a+1,r+1),o.lineTo(a,r+1),o.endFill())}return o},u.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},u.setupPositionAdjustPattern=function(){for(var t=s.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var o=t[e],i=t[n];if(null==this.modules[o][i])for(var r=-2;r<=2;r++)for(var a=-2;a<=2;a++)this.modules[o+r][i+a]=-2==r||2==r||-2==a||2==a||0==r&&0==a}},u.setupTypeNumber=function(t){for(var e=s.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var o=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=o}for(n=0;n<18;n++)o=!t&&1==(e>>n&1),this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=o},u.setupTypeInfo=function(t,e){for(var n=this.errorCorrectLevel<<3|e,o=s.getBCHTypeInfo(n),i=0;i<15;i++){var r=!t&&1==(o>>i&1);i<6?this.modules[i][8]=r:i<8?this.modules[i+1][8]=r:this.modules[this.moduleCount-15+i][8]=r}for(i=0;i<15;i++)r=!t&&1==(o>>i&1),i<8?this.modules[8][this.moduleCount-i-1]=r:i<9?this.modules[8][15-i-1+1]=r:this.modules[8][15-i-1]=r;this.modules[this.moduleCount-8][8]=!t},u.mapData=function(t,e){for(var n=-1,o=this.moduleCount-1,i=7,r=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var l=0;l<2;l++)if(null==this.modules[o][a-l]){var u=!1;r<t.length&&(u=1==(t[r]>>>i&1)),s.getMask(e,o,a-l)&&(u=!u),this.modules[o][a-l]=u,-1==--i&&(r++,i=7)}if((o+=n)<0||this.moduleCount<=o){o-=n,n=-n;break}}},l.PAD0=236,l.PAD1=17,l.createData=function(t,e,n){for(var o=i.getRSBlocks(t,e),a=new r,u=0;u<n.length;u++){var c=n[u];a.put(c.mode,4),a.put(c.getLength(),s.getLengthInBits(c.mode,t)),c.write(a)}var h=0;for(u=0;u<o.length;u++)h+=o[u].dataCount;if(a.getLengthInBits()>8*h)throw new Error("code length overflow. ("+a.getLengthInBits()+">"+8*h+")");for(a.getLengthInBits()+4<=8*h&&a.put(0,4);a.getLengthInBits()%8!=0;)a.putBit(!1);for(;!(a.getLengthInBits()>=8*h||(a.put(l.PAD0,8),a.getLengthInBits()>=8*h));)a.put(l.PAD1,8);return l.createBytes(a,o)},l.createBytes=function(t,e){for(var n=0,o=0,i=0,r=new Array(e.length),l=new Array(e.length),u=0;u<e.length;u++){var c=e[u].dataCount,h=e[u].totalCount-c;o=Math.max(o,c),i=Math.max(i,h),r[u]=new Array(c);for(var p=0;p<r[u].length;p++)r[u][p]=255&t.buffer[p+n];n+=c;var f=s.getErrorCorrectPolynomial(h),d=new a(r[u],f.getLength()-1).mod(f);for(l[u]=new Array(f.getLength()-1),p=0;p<l[u].length;p++){var m=p+d.getLength()-l[u].length;l[u][p]=m>=0?d.get(m):0}}var _=0;for(p=0;p<e.length;p++)_+=e[p].totalCount;var v=new Array(_),g=0;for(p=0;p<o;p++)for(u=0;u<e.length;u++)p<r[u].length&&(v[g++]=r[u][p]);for(p=0;p<i;p++)for(u=0;u<e.length;u++)p<l[u].length&&(v[g++]=l[u][p]);return v},t.exports=l},2835:(t,e,n)=>{var o=n(1537);function i(t,e){this.totalCount=t,this.dataCount=e}i.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],i.getRSBlocks=function(t,e){var n=i.getRsBlockTable(t,e);if(null==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var o=n.length/3,r=new Array,s=0;s<o;s++)for(var a=n[3*s+0],l=n[3*s+1],u=n[3*s+2],c=0;c<a;c++)r.push(new i(l,u));return r},i.getRsBlockTable=function(t,e){switch(e){case o.L:return i.RS_BLOCK_TABLE[4*(t-1)+0];case o.M:return i.RS_BLOCK_TABLE[4*(t-1)+1];case o.Q:return i.RS_BLOCK_TABLE[4*(t-1)+2];case o.H:return i.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},t.exports=i},9341:t=>{for(var e={glog:function(t){if(t<1)throw new Error("glog("+t+")");return e.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},n=0;n<8;n++)e.EXP_TABLE[n]=1<<n;for(n=8;n<256;n++)e.EXP_TABLE[n]=e.EXP_TABLE[n-4]^e.EXP_TABLE[n-5]^e.EXP_TABLE[n-6]^e.EXP_TABLE[n-8];for(n=0;n<255;n++)e.LOG_TABLE[e.EXP_TABLE[n]]=n;t.exports=e},9852:t=>{t.exports={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}},8759:(t,e,n)=>{var o=n(9852),i=n(501),r=n(9341),s={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;s.getBCHDigit(e)-s.getBCHDigit(s.G15)>=0;)e^=s.G15<<s.getBCHDigit(e)-s.getBCHDigit(s.G15);return(t<<10|e)^s.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;s.getBCHDigit(e)-s.getBCHDigit(s.G18)>=0;)e^=s.G18<<s.getBCHDigit(e)-s.getBCHDigit(s.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return s.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case 0:return(e+n)%2==0;case 1:return e%2==0;case 2:return n%3==0;case 3:return(e+n)%3==0;case 4:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case 5:return e*n%2+e*n%3==0;case 6:return(e*n%2+e*n%3)%2==0;case 7:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new i([1],0),n=0;n<t;n++)e=e.multiply(new i([1,r.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case o.MODE_NUMBER:return 10;case o.MODE_ALPHA_NUM:return 9;case o.MODE_8BIT_BYTE:case o.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case o.MODE_NUMBER:return 12;case o.MODE_ALPHA_NUM:return 11;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case o.MODE_NUMBER:return 14;case o.MODE_ALPHA_NUM:return 13;case o.MODE_8BIT_BYTE:return 16;case o.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,o=0;o<e;o++)for(var i=0;i<e;i++){for(var r=0,s=t.isDark(o,i),a=-1;a<=1;a++)if(!(o+a<0||e<=o+a))for(var l=-1;l<=1;l++)i+l<0||e<=i+l||0==a&&0==l||s==t.isDark(o+a,i+l)&&r++;r>5&&(n+=3+r-5)}for(o=0;o<e-1;o++)for(i=0;i<e-1;i++){var u=0;t.isDark(o,i)&&u++,t.isDark(o+1,i)&&u++,t.isDark(o,i+1)&&u++,t.isDark(o+1,i+1)&&u++,0!=u&&4!=u||(n+=3)}for(o=0;o<e;o++)for(i=0;i<e-6;i++)t.isDark(o,i)&&!t.isDark(o,i+1)&&t.isDark(o,i+2)&&t.isDark(o,i+3)&&t.isDark(o,i+4)&&!t.isDark(o,i+5)&&t.isDark(o,i+6)&&(n+=40);for(i=0;i<e;i++)for(o=0;o<e-6;o++)t.isDark(o,i)&&!t.isDark(o+1,i)&&t.isDark(o+2,i)&&t.isDark(o+3,i)&&t.isDark(o+4,i)&&!t.isDark(o+5,i)&&t.isDark(o+6,i)&&(n+=40);var c=0;for(i=0;i<e;i++)for(o=0;o<e;o++)t.isDark(o,i)&&c++;return n+Math.abs(100*c/e/e-50)/5*10}};t.exports=s},5286:(t,e,n)=>{"use strict";var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),i=n(6540),r=n(5556),s=n(6641),a=n(1537),l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"shouldComponentUpdate",value:function(t){var n=this;return Object.keys(e.propTypes).some((function(e){return n.props[e]!==t[e]}))}},{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"update",value:function(){var t=this.props,e=t.value,n=t.size,o=t.level,i=t.bgColor,r=t.fgColor,l=new s(-1,a[o]);if(l.addData(e),l.make(),null!=this._canvas){var u=this._canvas,c=u.getContext("2d");if(!c)return;var h=l.modules;if(null===h)return;var p=n/h.length,f=n/h.length,d=(window.devicePixelRatio||1)/function(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1}(c);u.height=u.width=n*d,c.scale(d,d),h.forEach((function(t,e){t.forEach((function(t,n){c&&(c.fillStyle=t?r:i);var o=Math.ceil((n+1)*p)-Math.floor(n*p),s=Math.ceil((e+1)*f)-Math.floor(e*f);c&&c.fillRect(Math.round(n*p),Math.round(e*f),o,s)}))}))}}},{key:"render",value:function(){var t=this;return i.createElement("canvas",{style:{height:this.props.size,width:this.props.size},height:this.props.size,width:this.props.size,ref:function(e){return t._canvas=e}})}}]),e}(i.Component);Object.defineProperty(l,"defaultProps",{enumerable:!0,writable:!0,value:{size:128,level:"L",bgColor:"#FFFFFF",fgColor:"#000000"}}),Object.defineProperty(l,"propTypes",{enumerable:!0,writable:!0,value:{value:r.string.isRequired,size:r.number,level:r.oneOf(["L","M","Q","H"]),bgColor:r.string,fgColor:r.string}}),t.exports=l},5287:(t,e,n)=>{"use strict";var o=n(5228),i="function"==typeof Symbol&&Symbol.for,r=i?Symbol.for("react.element"):60103,s=i?Symbol.for("react.portal"):60106,a=i?Symbol.for("react.fragment"):60107,l=i?Symbol.for("react.strict_mode"):60108,u=i?Symbol.for("react.profiler"):60114,c=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,p=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,d=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,_="function"==typeof Symbol&&Symbol.iterator;function v(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y={};function b(t,e,n){this.props=t,this.context=e,this.refs=y,this.updater=n||g}function w(){}function x(t,e,n){this.props=t,this.context=e,this.refs=y,this.updater=n||g}b.prototype.isReactComponent={},b.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(v(85));this.updater.enqueueSetState(this,t,e,"setState")},b.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},w.prototype=b.prototype;var T=x.prototype=new w;T.constructor=x,o(T,b.prototype),T.isPureReactComponent=!0;var E={current:null},P=Object.prototype.hasOwnProperty,L={key:!0,ref:!0,__self:!0,__source:!0};function S(t,e,n){var o,i={},s=null,a=null;if(null!=e)for(o in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)P.call(e,o)&&!L.hasOwnProperty(o)&&(i[o]=e[o]);var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}if(t&&t.defaultProps)for(o in l=t.defaultProps)void 0===i[o]&&(i[o]=l[o]);return{$$typeof:r,type:t,key:s,ref:a,props:i,_owner:E.current}}function k(t){return"object"==typeof t&&null!==t&&t.$$typeof===r}var M=/\/+/g,C=[];function O(t,e,n,o){if(C.length){var i=C.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=o,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:o,count:0}}function A(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>C.length&&C.push(t)}function R(t,e,n,o){var i=typeof t;"undefined"!==i&&"boolean"!==i||(t=null);var a=!1;if(null===t)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case r:case s:a=!0}}if(a)return n(o,t,""===e?"."+I(t,0):e),1;if(a=0,e=""===e?".":e+":",Array.isArray(t))for(var l=0;l<t.length;l++){var u=e+I(i=t[l],l);a+=R(i,u,n,o)}else if("function"==typeof(u=null===t||"object"!=typeof t?null:"function"==typeof(u=_&&t[_]||t["@@iterator"])?u:null))for(t=u.call(t),l=0;!(i=t.next()).done;)a+=R(i=i.value,u=e+I(i,l++),n,o);else if("object"===i)throw n=""+t,Error(v(31,"[object Object]"===n?"object with keys {"+Object.keys(t).join(", ")+"}":n,""));return a}function j(t,e,n){return null==t?0:R(t,"",e,n)}function I(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function B(t,e){t.func.call(t.context,e,t.count++)}function D(t,e,n){var o=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?N(t,o,n,(function(t){return t})):null!=t&&(k(t)&&(t=function(t,e){return{$$typeof:r,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(M,"$&/")+"/")+n)),o.push(t))}function N(t,e,n,o,i){var r="";null!=n&&(r=(""+n).replace(M,"$&/")+"/"),j(t,D,e=O(e,r,o,i)),A(e)}var z={current:null};function F(){var t=z.current;if(null===t)throw Error(v(321));return t}var H={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:E,IsSomeRendererActing:{current:!1},assign:o};e.Children={map:function(t,e,n){if(null==t)return t;var o=[];return N(t,o,null,e,n),o},forEach:function(t,e,n){if(null==t)return t;j(t,B,e=O(null,null,e,n)),A(e)},count:function(t){return j(t,(function(){return null}),null)},toArray:function(t){var e=[];return N(t,e,null,(function(t){return t})),e},only:function(t){if(!k(t))throw Error(v(143));return t}},e.Component=b,e.Fragment=a,e.Profiler=u,e.PureComponent=x,e.StrictMode=l,e.Suspense=f,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,e.cloneElement=function(t,e,n){if(null==t)throw Error(v(267,t));var i=o({},t.props),s=t.key,a=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(a=e.ref,l=E.current),void 0!==e.key&&(s=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)P.call(e,c)&&!L.hasOwnProperty(c)&&(i[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];i.children=u}return{$$typeof:r,type:t.type,key:s,ref:a,props:i,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:h,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:t},t.Consumer=t},e.createElement=S,e.createFactory=function(t){var e=S.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:p,render:t}},e.isValidElement=k,e.lazy=function(t){return{$$typeof:m,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:d,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return F().useCallback(t,e)},e.useContext=function(t,e){return F().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return F().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return F().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return F().useLayoutEffect(t,e)},e.useMemo=function(t,e){return F().useMemo(t,e)},e.useReducer=function(t,e,n){return F().useReducer(t,e,n)},e.useRef=function(t){return F().useRef(t)},e.useState=function(t){return F().useState(t)},e.version="16.14.0"},6540:(t,e,n)=>{"use strict";t.exports=n(5287)},618:t=>{t.exports=function(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var o=window.getSelection(),i=document.createRange();i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i),e=o.toString()}return e}},1504:t=>{function e(){}e.prototype={on:function(t,e,n){var o=this.e||(this.e={});return(o[t]||(o[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var o=this;function i(){o.off(t,i),e.apply(n,arguments)}return i._=e,this.on(t,i,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),o=0,i=n.length;o<i;o++)n[o].fn.apply(n[o].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),o=n[t],i=[];if(o&&e)for(var r=0,s=o.length;r<s;r++)o[r].fn!==e&&o[r].fn._!==e&&i.push(o[r]);return i.length?n[t]=i:delete n[t],this}},t.exports=e,t.exports.TinyEmitter=e}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=n(6540),e=n(5556),o=n.n(e),i=n(4378);function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,i,r,s,a=[],l=!0,u=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=r.call(n)).done)&&(a.push(o.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,d(o.key),o)}}function u(t,e,n){return e=h(e),function(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,c()?Reflect.construct(e,n||[],h(t).constructor):e.apply(t,n))}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function f(t,e,n){return(e=d(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}var m=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=u(this,n,[t])).close=e.close.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(n,e),o=n,(r=[{key:"close",value:function(){var t=s(this.props.bind,2),e=t[0],n=t[1];e.setState(f({},n,""))}},{key:"render",value:function(){var e=s(this.props.bind,2),n=e[0],o=e[1];return n.state[o]?t.createElement("div",{className:"alert alert-warning alert-dismissible "+(this.props.className?this.props.className:"")},t.createElement("button",{type:"button",className:"close",title:(0,i._)("Close"),onClick:this.close},t.createElement("span",{"aria-hidden":"true"},"")),n.state[o]):t.createElement("div",null)}}])&&l(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);f(m,"propTypes",{bind:o().array.isRequired});const _=m;function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function g(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,E(o.key),o)}}function y(t,e,n){return e=w(e),function(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,b()?Reflect.construct(e,n||[],w(t).constructor):e.apply(t,n))}function b(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(b=function(){return!!t})()}function w(t){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},w(t)}function x(t,e){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},x(t,e)}function T(t,e,n){return(e=E(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=v(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(e)?e:e+""}var P=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=y(this,n,[t])).handleClick=e.handleClick.bind(e),e.icon=e.icon.bind(e),e.text=e.text.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e)}(n,e),o=n,(r=[{key:"handleClick",value:function(){if(this.props.task){var t="mapToModel"===this.props.type?"3d":"map",e=this.props.public?"../".concat(t,"/"):"/".concat(t,"/project/").concat(this.props.task.project,"/task/").concat(this.props.task.id,"/");location.href=e}}},{key:"icon",value:function(){return"mapToModel"===this.props.type?"fa-cube":"fa-globe"}},{key:"text",value:function(){return"mapToModel"===this.props.type?(0,i._)("3D"):(0,i._)("2D")}},{key:"render",value:function(){return t.createElement("button",{style:this.props.style,onClick:this.handleClick,type:"button",className:"switchModeButton btn btn-sm btn-secondary "+(this.props.task?"":"hide")},t.createElement("i",{className:"fa "+this.icon()})," ",this.text())}}])&&g(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);T(P,"defaultProps",{task:null,type:"mapToModel",public:!1,style:{}}),T(P,"propTypes",{task:o().object,type:o().string,public:o().bool,style:o().object});const L=P;function S(t,e,n){return e=M(e),function(t,e){if(e&&("object"===O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,k()?Reflect.construct(e,n||[],M(t).constructor):e.apply(t,n))}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(k=function(){return!!t})()}function M(t){return M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},M(t)}function C(t,e){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},C(t,e)}function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function A(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,I(o.key),o)}}function j(t,e,n){return e&&R(t.prototype,e),n&&R(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function I(t){var e=function(t,e){if("object"!=O(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=O(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==O(e)?e:e+""}var B=function(){return j((function t(e,n,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};A(this,t),this.label=e,this.asset=n,this.icon=o,this.exportFormats=i,this.exportParams=r}),[{key:"downloadUrl",value:function(t,e){return"/api/projects/".concat(t,"/tasks/").concat(e,"/download/").concat(this.asset)}},{key:"exportId",value:function(){return this.asset.replace(/\..+$/,"")}},{key:"separator",get:function(){return!1}}])}(),D=function(t){function e(){return A(this,e),S(this,e,["-"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&C(t,e)}(e,t),j(e,[{key:"downloadUrl",value:function(){return"#"}},{key:"separator",get:function(){return!0}}])}(B),N=["gtiff","gtiff-rgb","jpg","png","kmz"],z={hillshade:6,color_map:"viridis"},F={all:function(){return[new B((0,i._)("Orthophoto"),"orthophoto.tif","far fa-image",N),new B((0,i._)("Orthophoto (MBTiles)"),"orthophoto.mbtiles","far fa-image"),new B((0,i._)("Orthophoto (Tiles)"),"orthophoto_tiles.zip","fa fa-table"),new B((0,i._)("Terrain Model"),"dtm.tif","fa fa-chart-area",N,z),new B((0,i._)("Terrain Model (Tiles)"),"dtm_tiles.zip","fa fa-table"),new B((0,i._)("Surface Model"),"dsm.tif","fa fa-chart-area",N,z),new B((0,i._)("Surface Model (Tiles)"),"dsm_tiles.zip","fa fa-table"),new B((0,i._)("Point Cloud"),"georeferenced_model.laz","fa fa-cube",["laz","las","ply","csv"]),new B((0,i._)("Point Cloud (3D Tiles)"),"3d_tiles_pointcloud.zip","fa fa-cube"),new B((0,i._)("Textured Model"),"textured_model.zip","fab fa-connectdevelop"),new B((0,i._)("Textured Model (3D Tiles)"),"3d_tiles_model.zip","fab fa-connectdevelop"),new B((0,i._)("Textured Model (glTF)"),"textured_model.glb","fab fa-connectdevelop"),new B((0,i._)("Camera Parameters"),"cameras.json","fa fa-camera"),new B((0,i._)("Camera Shots"),"shots.geojson","fa fa-camera"),new B((0,i._)("Ground Control Points"),"ground_control_points.geojson","far fa-dot-circle"),new B((0,i._)("Quality Report"),"report.pdf","far fa-file-pdf"),new D,new B((0,i._)("All Assets"),"all.zip","far fa-file-archive")]},excludeSeparators:function(){return F.all().filter((function(t){return!t.separator}))},only:function(t){return F.all().filter((function(e){return-1!==t.indexOf(e.asset)}))}};const H=F,Z=jQuery;var U=n.n(Z);function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function V(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Y(o.key),o)}}function W(t,e,n){return e=K(e),function(t,e){if(e&&("object"===G(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,q()?Reflect.construct(e,n||[],K(t).constructor):e.apply(t,n))}function q(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(q=function(){return!!t})()}function K(t){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},K(t)}function X(t,e){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},X(t,e)}function J(t,e,n){return(e=Y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y(t){var e=function(t,e){if("object"!=G(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=G(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==G(e)?e:e+""}var Q=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),J(e=W(this,n,[t]),"handleEnter",(function(t){"Enter"!==t.key&&13!==t.keyCode||e.handleSave(t)})),e.state={showModal:t.show,saving:!1,deleting:!1,error:""},e.setModal=e.setModal.bind(e),e.show=e.show.bind(e),e.hide=e.hide.bind(e),e.handleSave=e.handleSave.bind(e),e.handleDelete=e.handleDelete.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&X(t,e)}(n,e),o=n,(r=[{key:"setModal",value:function(t){this.modal=t}},{key:"componentDidMount",value:function(){var t=this;this._mounted=!0,U()(this.modal).on("hidden.bs.modal",(function(e){t.hide()})).on("shown.bs.modal",(function(e){t.props.onShow&&t.props.onShow()})),this.componentDidUpdate()}},{key:"componentWillUnmount",value:function(){this._mounted=!1,U()(this.modal).off("hidden.bs.modal hidden.bs.modal").modal("hide")}},{key:"componentDidUpdate",value:function(){this.state.showModal?U()(this.modal).modal("show"):U()(this.modal).modal("hide")}},{key:"show",value:function(){this.props.reset&&this.props.reset(),this.setState({showModal:!0,saving:!1,error:""})}},{key:"hide",value:function(){this.setState({showModal:!1}),this.props.onHide&&this.props.onHide(),this.serverRequest&&(this.serverRequest.abort(),this.serverRequest=null)}},{key:"handleSave",value:function(t){var e=this;if(t.preventDefault(),this.setState({saving:!0,error:""}),this.props.handleSaveFunction)this.props.handleSaveFunction((function(t){t?e.setState({saving:!1,error:t.message}):e.hide()}));else{var n={};this.props.getFormData&&(n=this.props.getFormData()),this.serverRequest=this.props.saveAction(n),this.serverRequest?this.serverRequest.fail((function(t){e.setState({error:t.message||(t.responseJSON||{}).detail||(t.responseJSON||{}).error||t.responseText||(0,i._)("Could not apply changes")})})).always((function(){e.setState({saving:!1}),e.serverRequest=null})).done((function(){e.hide()})):(this.setState({saving:!1}),this.hide())}}},{key:"handleDelete",value:function(){var t=this;this.props.deleteAction&&(this.props.deleteWarning&&!window.confirm(this.props.deleteWarning)||(this.setState({deleting:!0}),this.props.deleteAction().fail((function(e){t._mounted&&t.setState({error:e.message||(e.responseJSON||{}).detail||e.responseText||(0,i._)("Could not delete item")})})).always((function(){t._mounted&&t.setState({deleting:!1})}))))}},{key:"render",value:function(){var e=[];return this.props.deleteAction&&e.push(t.createElement("button",{disabled:this.state.deleting,className:"btn btn-danger",key:"delete",onClick:this.handleDelete},this.state.deleting?t.createElement("span",null,t.createElement("i",{className:"fa fa-circle-notch fa-spin"})," ",(0,i._)("Deleting...")):t.createElement("span",null,t.createElement("i",{className:"fa fa-trash"})," ",(0,i._)("Delete")))),this.props.leftButtons&&(e=e.concat(this.props.leftButtons)),t.createElement("div",{ref:this.setModal,className:"modal form-dialog",tabIndex:"-1","data-backdrop":"static"},t.createElement("div",{className:"modal-dialog"},t.createElement("div",{className:"modal-content"},t.createElement("div",{className:"modal-header"},t.createElement("button",{type:"button",className:"close",onClick:this.hide},t.createElement("span",null,"")),t.createElement("h4",{className:"modal-title"},this.props.title)),t.createElement("div",{className:"modal-body"},t.createElement(_,{bind:[this,"error"]}),t.createElement("div",{className:"form-horizontal",onSubmit:this.handleSave},this.props.children)),t.createElement("div",{className:"modal-footer"},t.createElement("div",{className:"pull-right"},t.createElement("button",{type:"button",className:"btn btn-default",onClick:this.hide,disabled:this.state.saving},(0,i._)("Cancel")),t.createElement("button",{type:"button",className:"btn btn-primary save",onClick:this.handleSave,disabled:this.state.saving},this.state.saving?t.createElement("span",null,t.createElement("i",{className:"fa fa-circle-notch fa-spin"})," ",this.props.savingLabel):t.createElement("span",null,t.createElement("i",{className:this.props.saveIcon})," ",this.props.saveLabel))),e.length>0?t.createElement("div",{className:"text-left"},e):""))))}}])&&V(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);J(Q,"defaultProps",{title:(0,i._)("Title"),saveLabel:(0,i._)("Save"),savingLabel:(0,i._)("Saving"),saveIcon:"glyphicon glyphicon-plus",deleteWarning:(0,i._)("Are you sure?"),show:!1}),J(Q,"propTypes",{getFormData:o().func.isRequired,reset:o().func,saveAction:o().func.isRequired,handleSaveFunction:o().func,onShow:o().func,onHide:o().func,deleteAction:o().func,title:o().string,saveLabel:o().string,savingLabel:o().string,saveIcon:o().string,deleteWarning:o().oneOfType([o().string,o().bool]),show:o().bool});const tt=Q;function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function nt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,ot(o.key),o)}}function ot(t){var e=function(t,e){if("object"!=et(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=et(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==et(e)?e:e+""}const it=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getItem",value:function(t){try{return localStorage.getItem(t)}catch(e){console.warn("Failed to call getItem "+t,e)}}},{key:"setItem",value:function(t,e){try{localStorage.setItem(t,e)}catch(e){console.warn("Failed to call setItem "+t,e)}}}],null&&nt(t.prototype,null),e&&nt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();n(4213);const rt=function(t){return JSON.parse(JSON.stringify(t))},st=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href;"/"===t[0]&&(t=t.slice(1));var n=document.createElement("a");return n.href=e,"".concat(n.protocol,"//").concat(n.host,"/").concat(t)};function at(t){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},at(t)}function lt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,dt(o.key),o)}}function ut(t,e,n){return e=ht(e),function(t,e){if(e&&("object"===at(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ct()?Reflect.construct(e,n||[],ht(t).constructor):e.apply(t,n))}function ct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ct=function(){return!!t})()}function ht(t){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ht(t)}function pt(t,e){return pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pt(t,e)}function ft(t,e,n){return(e=dt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dt(t){var e=function(t,e){if("object"!=at(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=at(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==at(e)?e:e+""}var mt=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),ft(e=ut(this,n,[t]),"getEpsg",(function(){return"custom"!==e.state.epsg?e.state.epsg:e.state.customEpsg})),ft(e,"handleSelectFormat",(function(t){e.setState({format:t.target.value})})),ft(e,"handleSelectEpsg",(function(t){e.setState({epsg:t.target.value})})),ft(e,"handleChangeCustomEpsg",(function(t){e.setState({customEpsg:t.target.value})})),ft(e,"getExportParams",(function(t){var n={};return(n="function"==typeof e.props.exportParams?rt(e.props.exportParams()):rt(e.props.exportParams)).format=t,e.getEpsg()&&(n.epsg=e.getEpsg()),n})),ft(e,"handleExport",(function(t){return t||(t=e.state.format),function(n){var o=e.props.task;e.setState({exporting:!0,error:""});var r=e.getExportParams(t);"custom"===e.state.epsg&&it.setItem("last_export_custom_epsg",r.epsg),e.exportReq=$.ajax({type:"POST",url:"/api/projects/".concat(o.project,"/tasks/").concat(o.id,"/").concat(e.props.asset,"/export"),data:r}).done((function(t){if(t.celery_task_id)!function(t,e){var n=0,o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/api/workers/check/")+t;!function t(){U().ajax({type:"GET",url:o}).done((function(n){n.error?e(n.error):n.ready?e():setTimeout((function(){return t()}),2e3)})).fail((function(o){console.warn(o),n++<10?setTimeout((function(){return t()}),2e3):e(JSON.stringify(o))}))}()}(t.celery_task_id,(function(o){o?(e.setState({exporting:!1,error:o}),void 0!==n&&n(new Error(o))):(e.setState({exporting:!1}),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";window.location.href="/api/workers/get/".concat(t,"?filename=").concat(e)}(t.celery_task_id,t.filename),void 0!==n&&n())}));else if(t.url)e.setState({exporting:!1}),window.location.href="".concat(t.url,"?filename=").concat(t.filename),void 0!==n&&n();else if(t.error)e.setState({exporting:!1,error:t.error}),void 0!==n&&n(new Error(t.error));else{var o=interpolate((0,i._)("Invalid JSON response: %(error)s"),{error:JSON.stringify(t)});e.setState({exporting:!1,error:o}),void 0!==n&&n(new Error(o))}})).fail((function(t){t=(t.responseJSON||{})[0]||JSON.stringify(t),e.setState({exporting:!1,error:t}),void 0!==n&&n(new Error(t))}))}})),e.efInfo={"gtiff-rgb":{label:"GeoTIFF (RGB)",icon:"fas fa-palette"},gtiff:{label:"GeoTIFF (Raw)",icon:"far fa-image"},jpg:{label:"JPEG (RGB)",icon:"fas fa-palette"},png:{label:"PNG (RGB)",icon:"fas fa-palette"},kmz:{label:"KMZ (RGB)",icon:"fas fa-globe"},laz:{label:"LAZ",icon:"fa fa-cube"},las:{label:"LAS",icon:"fa fa-cube"},ply:{label:"PLY",icon:"fa fa-cube"},csv:{label:"CSV",icon:"fa fa-file-text"}},e.state={error:"",format:t.exportFormats[0],epsg:e.props.task.epsg||null,customEpsg:it.getItem("last_export_custom_epsg")||"4326",exporting:!1},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pt(t,e)}(n,e),o=n,(r=[{key:"componentWillUnmount",value:function(){this.exportReq&&this.exportReq.abort()}},{key:"render",value:function(){var e,n=this,o=this.state,r=o.epsg,s=o.customEpsg,a=o.exporting,l=o.format,u=this.props.exportFormats,c=this.props.task.epsg,h="custom"===r&&!s||a,p=c?t.createElement("div",null,t.createElement("div",{className:"row form-group form-inline"},t.createElement("label",{className:"col-sm-3 control-label"},(0,i._)("Projection:")),t.createElement("div",{className:"col-sm-9 "},t.createElement("select",{className:"form-control",value:r,onChange:this.handleSelectEpsg},c?t.createElement("option",{value:c},"UTM (EPSG:",c,")"):"",t.createElement("option",{value:"4326"},(0,i._)("Lat/Lon")," (EPSG:4326)"),t.createElement("option",{value:"3857"},(0,i._)("Web Mercator")," (EPSG:3857)"),t.createElement("option",{value:"custom"},(0,i._)("Custom")," EPSG")))),"custom"===r?t.createElement("div",{className:"row form-group form-inline"},t.createElement("label",{className:"col-sm-3 control-label"},"EPSG:"),t.createElement("div",{className:"col-sm-9 "},t.createElement("input",{type:"number",className:"form-control custom-interval",value:s,onChange:this.handleChangeCustomEpsg}))):""):"";return e=this.props.selectorOnly?t.createElement("div",{className:"row form-group form-inline"},t.createElement("label",{className:"col-sm-3 control-label"},(0,i._)("Format:")),t.createElement("div",{className:"col-sm-9 "},t.createElement("select",{className:"form-control",value:l,onChange:this.handleSelectFormat},u.map((function(e){return t.createElement("option",{key:e,value:e},n.efInfo[e].label)}))))):t.createElement("div",{className:"row form-group form-inline"},t.createElement("label",{className:"col-sm-3 control-label"},(0,i._)("Export:")),t.createElement("div",{className:"col-sm-9"},t.createElement("div",{className:"btn-group "+(this.props.dropUp?"dropup":"")},t.createElement("button",{onClick:this.handleExport(u[0]),disabled:h,type:"button",className:"btn btn-sm btn-primary btn-export"},a?t.createElement("i",{className:"fa fa-spin fa-circle-notch"}):t.createElement("i",{className:this.efInfo[u[0]].icon+" fa-fw"})," ",a?(0,i._)("Exporting..."):this.efInfo[u[0]].label),t.createElement("button",{disabled:h,type:"button",className:"btn btn-sm dropdown-toggle btn-primary","data-toggle":"dropdown"},t.createElement("span",{className:"caret"})),t.createElement("ul",{className:"dropdown-menu pull-right"},u.map((function(e){return t.createElement("li",{key:e},t.createElement("a",{href:"javascript:void(0);",onClick:n.handleExport(e)},t.createElement("i",{className:n.efInfo[e].icon+" fa-fw"})," ",n.efInfo[e].label))})))))),t.createElement("div",{className:"export-asset-panel"},this.props.selectorOnly?"":t.createElement(_,{bind:[this,"error"]}),p,e)}}])&&lt(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function vt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Tt(o.key),o)}}function gt(t,e,n){return e=bt(e),function(t,e){if(e&&("object"===_t(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,yt()?Reflect.construct(e,n||[],bt(t).constructor):e.apply(t,n))}function yt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(yt=function(){return!!t})()}function bt(t){return bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bt(t)}function wt(t,e){return wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wt(t,e)}function xt(t,e,n){return(e=Tt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tt(t){var e=function(t,e){if("object"!=_t(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=_t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_t(e)?e:e+""}ft(mt,"defaultProps",{exportFormats:["gtiff-rgb","gtiff","jpg","png","kmz"],asset:"",exportParams:{},task:null,dropUp:!1,selectorOnly:!1}),ft(mt,"propTypes",{exportFormats:o().arrayOf(o().string),asset:o().string.isRequired,exportParams:o().oneOfType([o().func,o().object]),task:o().object.isRequired,dropUp:o().bool,selectorOnly:o().bool});var Et=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),xt(e=gt(this,n,[t]),"handleSave",(function(t){e.exportAssetPanel.handleExport()(t)})),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wt(t,e)}(n,e),o=n,(r=[{key:"render",value:function(){var e=this;return t.createElement("div",{className:"export-asset-dialog"},t.createElement(tt,{getFormData:function(){},reset:function(){},show:!0,saveIcon:"glyphicon glyphicon-download",title:this.props.assetLabel,savingLabel:(0,i._)("Downloading"),saveLabel:(0,i._)("Download"),saveAction:function(){},handleSaveFunction:this.handleSave,onHide:this.props.onHide},t.createElement(mt,{asset:this.props.asset,task:this.props.task,ref:function(t){e.exportAssetPanel=t},selectorOnly:!0,exportFormats:this.props.exportFormats,exportParams:this.props.exportParams})))}}])&&vt(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);xt(Et,"defaultProps",{}),xt(Et,"propTypes",{onHide:o().func.isRequired,asset:o().string.isRequired,task:o().object.isRequired,exportFormats:o().arrayOf(o().string),exportParams:o().object,assetLabel:o().string});const Pt=Et;function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function St(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Rt(o.key),o)}}function kt(t,e,n){return e=Ct(e),function(t,e){if(e&&("object"===Lt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Mt()?Reflect.construct(e,n||[],Ct(t).constructor):e.apply(t,n))}function Mt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Mt=function(){return!!t})()}function Ct(t){return Ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ct(t)}function Ot(t,e){return Ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ot(t,e)}function At(t,e,n){return(e=Rt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rt(t){var e=function(t,e){if("object"!=Lt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Lt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Lt(e)?e:e+""}var jt=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),At(e=kt(this,n),"onHide",(function(){e.setState({exportDialogProps:null}),e.props.onModalClose&&e.props.onModalClose()})),e.state={exportDialogProps:null},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ot(t,e)}(n,e),o=n,(r=[{key:"render",value:function(){var e=this,n=H.only(this.props.task.available_assets);return t.createElement("div",{className:"asset-download-buttons "+(this.props.showLabel?"btn-group":"")+" "+("up"===this.props.direction?"dropup":"")},this.state.exportDialogProps?t.createElement(Pt,{task:this.props.task,asset:this.state.exportDialogProps.asset,exportFormats:this.state.exportDialogProps.exportFormats,exportParams:this.state.exportDialogProps.exportParams,onHide:this.onHide,assetLabel:this.state.exportDialogProps.assetLabel}):"",t.createElement("button",{type:"button",className:"btn btn-sm "+this.props.buttonClass,disabled:this.props.disabled,"data-toggle":"dropdown"},t.createElement("i",{className:"glyphicon glyphicon-download"}),this.props.showLabel?" "+(0,i._)("Download Assets"):""),this.props.showLabel?t.createElement("button",{type:"button",className:"btn btn-sm dropdown-toggle "+this.props.buttonClass,"data-toggle":"dropdown",disabled:this.props.disabled},t.createElement("span",{className:"caret"})):"",t.createElement("ul",{className:"dropdown-menu"},n.map((function(n,o){if(n.separator)return t.createElement("li",{key:o,className:"divider"});var i=void 0;return n.exportFormats&&(i=function(t){t.preventDefault(),e.setState({exportDialogProps:{asset:n.exportId(),exportFormats:n.exportFormats,exportParams:n.exportParams,assetLabel:n.label}}),e.props.onModalOpen&&e.props.onModalOpen()}),t.createElement("li",{key:o},t.createElement("a",{href:n.downloadUrl(e.props.task.project,e.props.task.id),onClick:i},t.createElement("i",{className:n.icon+" fa-fw"})," ",n.label))}))))}}])&&St(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);At(jt,"defaultProps",{disabled:!1,direction:"down",buttonClass:"btn-primary",task:null,showLabel:!0}),At(jt,"propTypes",{disabled:o().bool,task:o().object.isRequired,direction:o().string,buttonClass:o().string,showLabel:o().bool,onModalOpen:o().func,onModalClose:o().func});const It=jt;function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}function Dt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Ut(o.key),o)}}function Nt(t,e,n){return e=Ft(e),function(t,e){if(e&&("object"===Bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,zt()?Reflect.construct(e,n||[],Ft(t).constructor):e.apply(t,n))}function zt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(zt=function(){return!!t})()}function Ft(t){return Ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ft(t)}function Ht(t,e){return Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ht(t,e)}function Zt(t,e,n){return(e=Ut(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ut(t){var e=function(t,e){if("object"!=Bt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Bt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Bt(e)?e:e+""}var Gt=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=Nt(this,n,[t])).state={message:t.message,show:t.show},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ht(t,e)}(n,e),o=n,i=[{key:"componentWillReceiveProps",value:function(t){this.setState(t)}},{key:"show",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.setState({show:!0}),t&&this.setState({message:t})}},{key:"hide",value:function(){this.setState({show:!1})}},{key:"render",value:function(){return t.createElement("div",{className:"standby",style:{display:this.state.show?"block":"none"}},t.createElement("div",{className:"cover",style:{opacity:this.props.opacity}},""),t.createElement("div",{className:"content"},t.createElement("i",{className:"fa fa-spinner fa-spin fa-2x fa-fw"}),t.createElement("p",null,this.state.message)))}}],i&&Dt(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,i}(t.Component);Zt(Gt,"defaultProps",{message:"",show:!1,opacity:.5}),Zt(Gt,"propTypes",{message:o().string,show:o().bool,opacity:o().number});const Vt=Gt;var Wt=n(8187),qt=n.n(Wt);function Kt(t){return Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kt(t)}function Xt(){return Xt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Xt.apply(this,arguments)}function $t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Jt(o.key),o)}}function Jt(t){var e=function(t,e){if("object"!=Kt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Kt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Kt(e)?e:e+""}function Yt(t,e,n){return e=te(e),function(t,e){if(e&&("object"===Kt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qt()?Reflect.construct(e,n||[],te(t).constructor):e.apply(t,n))}function Qt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Qt=function(){return!!t})()}function te(t){return te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},te(t)}function ee(t,e){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ee(t,e)}const ne=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=Yt(this,n,[t])).state={showCopied:!1},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ee(t,e)}(n,e),o=n,(i=[{key:"componentDidMount",value:function(){var t=this;this.clipboard=new(qt())(this.dom,{target:function(){return t.dom}}).on("success",(function(){t.setState({showCopied:!0})}))}},{key:"componentWillUnmount",value:function(){this.clipboard.destroy()}},{key:"render",value:function(){var e=this;return t.createElement("div",{className:"clipboardInput"},t.createElement("input",Xt({},this.props,{ref:function(t){e.dom=t},title:this.props.value||"",onBlur:function(){e.setState({showCopied:!1})}})),t.createElement("div",{style:{position:"relative",width:"100%"}},t.createElement("div",{className:"copied theme-background-success "+(this.state.showCopied?"show":"")},"Copied to clipboard")))}}])&&$t(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,i}(t.Component);var oe=n(5286),ie=n.n(oe),re=n(6894),se=n.n(re),ae=n(2881);const le=SystemJS;var ue=n.n(le);function ce(t){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ce(t)}function he(t){return function(t){if(Array.isArray(t))return pe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return pe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function fe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,de(o.key),o)}}function de(t){var e=function(t,e){if("object"!=ce(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=ce(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ce(e)?e:e+""}var me=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.events=e},e=[{key:"create",value:function(t){var e=this,n=function(n,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=function(n){setTimeout((function(){e.events.emit("".concat(t.namespace,"::").concat(o,"::Response"),n)}),0)};n[o]=function(n,i){Array.isArray(n)?e.events.addListener("".concat(t.namespace,"::").concat(o),(function(t){Promise.all(n.map((function(t){return ue().import(t)}))).then((function(){for(var e,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];o=o.map((function(t){return t.map((function(t){return t.default?t.default:t}))}));var a={result:i.apply(void 0,he((e=Array.from([t])).concat.apply(e,he(o)))),placeholder:t._placeholder};r(a)}))})):e.events.addListener("".concat(t.namespace,"::").concat(o),(function(t){var e={result:n(t),placeholder:t._placeholder};r(e)}))},n["trigger"+o[0].toUpperCase()+o.slice(1)]=function(n,r){n||(n={}),n._placeholder={},i(n,r),r&&e.events.addListener("".concat(t.namespace,"::").concat(o,"::Response"),(function(t){var o=e.events._currentSubscription;setTimeout((function(){o.remove()}),0),t.placeholder===n._placeholder&&r(t.result)})),e.events.emit("".concat(t.namespace,"::").concat(o),n)}},o={};return t.endpoints.forEach((function(t){Array.isArray(t)||(t=[t]),n.apply(void 0,[o].concat(he(t)))})),t.helpers&&(o=Object.assign(o,t.helpers)),o}}],e&&fe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),_e=(n(3481),function(t,e){if(!t){if(e=e||"Assertion failed","undefined"!=typeof Error)throw new Error(e);throw e}}),ve=function(t){_e(void 0!==t.map),_e(void 0!==t.tiles)};const ge={namespace:"Map",endpoints:[["willAddControls",ve],["didAddControls",function(t){_e(void 0!==t.controls),ve(t)}],["addActionButton",ve]]},ye={namespace:"Dashboard",endpoints:["addTaskActionButton","addNewTaskPanelItem","addNewTaskButton"]},be={namespace:"App",endpoints:["ready"]},we={namespace:"SharePopup",endpoints:["addLinkControl"]};if(!window.PluginsAPI){var xe=new ae.EventEmitter,Te=new me(xe);ue().config({baseURL:"/plugins",map:{css:"/static/app/js/vendor/css.js","globals-loader":"/static/app/js/vendor/globals-loader.js"},meta:{"*.css":{loader:"css"},jQuery:{loader:"globals-loader",exports:"$"},leaflet:{loader:"globals-loader",exports:"L"},ReactDOM:{loader:"globals-loader",exports:"ReactDOM"},React:{loader:"globals-loader",exports:"React"},SystemJS:{loader:"globals-loader",exports:"SystemJS"}}}),window.PluginsAPI={Map:Te.create(ge),Dashboard:Te.create(ye),App:Te.create(be),SharePopup:Te.create(we),SystemJS:ue(),events:xe}}const Ee=window.PluginsAPI;function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Le(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Ae(o.key),o)}}function Se(t,e,n){return e=Me(e),function(t,e){if(e&&("object"===Pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ke()?Reflect.construct(e,n||[],Me(t).constructor):e.apply(t,n))}function ke(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ke=function(){return!!t})()}function Me(t){return Me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Me(t)}function Ce(t,e){return Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ce(t,e)}function Oe(t,e,n){return(e=Ae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ae(t){var e=function(t,e){if("object"!=Pe(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Pe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pe(e)?e:e+""}var Re=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Oe(e=Se(this,n,[t]),"getRelShareLink",(function(){return"/public/task/".concat(e.props.task.id,"/").concat(e.props.linksTarget,"/")})),Oe(e,"toggleQRCode",(function(){e.setState({showQR:!e.state.showQR})})),e.state={task:t.task,togglingShare:!1,error:"",showQR:!1,linkControls:[],relShareLink:e.getRelShareLink()},e.handleEnableSharing=e.handleEnableSharing.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ce(t,e)}(n,e),o=n,(r=[{key:"componentDidMount",value:function(){var t=this;this.state.task.public||this.handleEnableSharing(),Ee.SharePopup.triggerAddLinkControl({sharePopup:this},(function(e){e&&t.setState(se()(t.state,{linkControls:{$push:[e]}}))}))}},{key:"handleEnableSharing",value:function(t){var e=this,n=this.state.task;return this.setState({togglingShare:!0}),U().ajax({url:"/api/projects/".concat(n.project,"/tasks/").concat(n.id,"/"),contentType:"application/json",data:JSON.stringify({public:!this.state.task.public}),dataType:"json",type:"PATCH"}).done((function(t){e.setState({task:t}),e.props.taskChanged(t)})).fail((function(){return e.setState({error:(0,i._)("An error occurred. Check your connection and permissions.")})})).always((function(){e.setState({togglingShare:!1})}))}},{key:"render",value:function(){var e=this,n=st(this.state.relShareLink),o=st("public/task/".concat(this.state.task.id,"/iframe/").concat(this.props.linksTarget,"/")),r='<iframe scrolling="no" title="WebODM" width="61.8033%" height="360" frameBorder="0" src="'.concat(o,'"></iframe>');return t.createElement("div",{onMouseDown:function(t){t.stopPropagation()},className:"sharePopup "+this.props.placement},t.createElement("div",{className:"sharePopupContainer popover in "+this.props.placement},t.createElement("div",{className:"arrow"}),t.createElement("h3",{className:"popover-title theme-background-highlight"},(0,i._)("Share This Task")),t.createElement("div",{className:"popover-content theme-secondary"},t.createElement(_,{bind:[this,"error"]}),t.createElement("div",{className:"checkbox"},t.createElement("button",{type:"button",className:"btn btn-qrcode btn-sm "+(this.state.showQR?"btn-primary ":"btn-default ")+(this.state.task.public?"":"hide"),onClick:this.toggleQRCode},t.createElement("i",{className:"fa fa-qrcode"})," ",(0,i._)("QR")),t.createElement("label",{onClick:this.handleEnableSharing},this.state.togglingShare?t.createElement("i",{className:"fa fa-sync fa-spin fa-fw"}):"",t.createElement("input",{className:this.state.togglingShare?"hide":"",type:"checkbox",checked:this.state.task.public,onChange:function(){}})," ",(0,i._)("Enabled"))),t.createElement("div",{className:"share-links "+(this.state.task.public?"show":"")},t.createElement("div",{className:"form-group "+(this.state.showQR?"hide":"")},t.createElement("label",null,(0,i._)("Link:"),t.createElement(ne,{type:"text",className:"form-control",value:n,readOnly:!0}))),t.createElement("div",{className:"form-group "+(this.state.showQR||0===this.state.linkControls.length?"hide":"")},this.state.linkControls.map((function(n,o){return t.createElement(n,{key:o,sharePopup:e})}))),t.createElement("div",{className:"form-group "+(this.state.showQR?"hide":"")},t.createElement("label",null,(0,i._)("HTML iframe:"),t.createElement(ne,{type:"text",className:"form-control",value:r,readOnly:!0}))),t.createElement("div",{className:this.state.showQR?"":"hide"},t.createElement(ie(),{value:n,size:200,bgColor:"#ffffff",fgColor:"#000000",level:"M"}))))))}}])&&Le(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);Oe(Re,"propTypes",{task:o().object.isRequired,linksTarget:o().oneOf(["map","3d"]).isRequired,placement:o().string,taskChanged:o().func}),Oe(Re,"defaultProps",{placement:"top",taskChanged:function(){}});const je=Re;function Ie(t){return Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ie(t)}function Be(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Ze(o.key),o)}}function De(t,e,n){return e=ze(e),function(t,e){if(e&&("object"===Ie(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ne()?Reflect.construct(e,n||[],ze(t).constructor):e.apply(t,n))}function Ne(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ne=function(){return!!t})()}function ze(t){return ze=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ze(t)}function Fe(t,e){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fe(t,e)}function He(t,e,n){return(e=Ze(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ze(t){var e=function(t,e){if("object"!=Ie(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Ie(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ie(e)?e:e+""}var Ue=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=De(this,n,[t])).state={showPopup:!1,task:t.task},e.handleClick=e.handleClick.bind(e),e.handleTaskChanged=e.handleTaskChanged.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fe(t,e)}(n,e),o=n,(r=[{key:"handleClick",value:function(t){this.setState({showPopup:!this.state.showPopup})}},{key:"hidePopup",value:function(){this.setState({showPopup:!1})}},{key:"handleTaskChanged",value:function(t){this.setState({task:t})}},{key:"render",value:function(){var e=t.createElement(je,{task:this.state.task,taskChanged:this.handleTaskChanged,placement:this.props.popupPlacement,linksTarget:this.props.linksTarget});return t.createElement("div",{className:"shareButton",onClick:function(t){t.stopPropagation()}},"top"===this.props.popupPlacement&&this.state.showPopup?e:"",t.createElement("button",{type:"button",onClick:this.handleClick,className:"shareButton btn btn-sm "+(this.state.task.public?"btn-primary":"btn-secondary")},t.createElement("i",{className:"fa fa-share-alt"})," ",(0,i._)("Share")),"bottom"===this.props.popupPlacement&&this.state.showPopup?e:"")}}])&&Be(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);He(Ue,"defaultProps",{task:null,popupPlacement:"top"}),He(Ue,"propTypes",{task:o().object.isRequired,linksTarget:o().oneOf(["map","3d"]).isRequired,popupPlacement:o().string});const Ge=Ue;function Ve(t){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ve(t)}function We(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Ye(o.key),o)}}function qe(t,e,n){return e=Xe(e),function(t,e){if(e&&("object"===Ve(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ke()?Reflect.construct(e,n||[],Xe(t).constructor):e.apply(t,n))}function Ke(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ke=function(){return!!t})()}function Xe(t){return Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xe(t)}function $e(t,e){return $e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$e(t,e)}function Je(t,e,n){return(e=Ye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ye(t){var e=function(t,e){if("object"!=Ve(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Ve(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ve(e)?e:e+""}var Qe=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Je(e=qe(this,n,[t]),"onFullscreenChange",(function(t){document.fullscreenElement||e.setState({expandThumb:!1})})),Je(e,"imageOnError",(function(){e.setState({error:(0,i._)("Image missing"),loading:!1})})),Je(e,"imageOnLoad",(function(){e.setState({loading:!1})})),Je(e,"onImgClick",(function(){e.state.expandThumb?(document.exitFullscreen(),e.setState({expandThumb:!1})):(e.image.requestFullscreen(),e.setState({loading:!0,expandThumb:!0}))})),e.state={error:"",loading:!0,expandThumb:!1},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$e(t,e)}(n,e),o=n,(r=[{key:"getImageUrl",value:function(){var t=this.props,e=t.feature,n=t.task;return"/api/projects/".concat(n.project,"/tasks/").concat(n.id,"/images/thumbnail/").concat(e.properties.filename)}},{key:"getThumbUrl",value:function(t){return"".concat(this.getImageUrl(),"?size=").concat(t)}},{key:"componentDidMount",value:function(){this.image&&this.image.addEventListener("fullscreenchange",this.onFullscreenChange)}},{key:"componentWillUnmount",value:function(){this.image&&this.image.removeEventListener("fullscreenchange",this.onFullscreenChange)}},{key:"render",value:function(){var e=this,n=this.state,o=n.error,r=n.loading,s=n.expandThumb,a=this.props,l=a.feature,u=a.task,c="/api/projects/".concat(u.project,"/tasks/").concat(u.id,"/images/download/").concat(l.properties.filename),h="/api/projects/".concat(u.project,"/tasks/").concat(u.id,"/download/shots.geojson"),p=s?this.getThumbUrl(999999999):this.getThumbUrl(320),f=H.only(["shots.geojson"])[0];return t.createElement("div",{className:"image-popup"},t.createElement("div",{className:"title",title:l.properties.filename},l.properties.filename),r?t.createElement("div",null,t.createElement("i",{className:"fa fa-circle-notch fa-spin fa-fw"})):"",""!==o?t.createElement("div",{style:{marginTop:"8px"}},o):[t.createElement("div",{key:"image",className:"image ".concat(s?"fullscreen":""),style:{marginTop:"8px"},ref:function(t){e.image=t}},r&&s?t.createElement("div",null,t.createElement("i",{className:"fa fa-circle-notch fa-spin fa-fw"})):"",t.createElement("a",{onClick:this.onImgClick,href:"javascript:void(0);",title:l.properties.filename},t.createElement("img",{style:{borderRadius:"4px"},src:p,onLoad:this.imageOnLoad,onError:this.imageOnError}))),t.createElement("div",{key:"download-image"},t.createElement("a",{href:c},t.createElement("i",{className:"fa fa-image"})," ",(0,i._)("Download Image")))],t.createElement("div",null,t.createElement("a",{href:h},t.createElement("i",{className:f.icon})," ",f.label," ")))}}])&&We(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);Je(Qe,"propTypes",{feature:o().object.isRequired,task:o().object.isRequired});const tn=Qe,en=THREE;function nn(t){return nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nn(t)}function on(t,e){if(t){if("string"==typeof t)return rn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rn(t,e):void 0}}function rn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function sn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function an(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,mn(o.key),o)}}function ln(t,e,n){return e&&an(t.prototype,e),n&&an(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function un(t,e,n){return e=hn(e),function(t,e){if(e&&("object"===nn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,cn()?Reflect.construct(e,n||[],hn(t).constructor):e.apply(t,n))}function cn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(cn=function(){return!!t})()}function hn(t){return hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hn(t)}function pn(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fn(t,e)}function fn(t,e){return fn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fn(t,e)}function dn(t,e,n){return(e=mn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mn(t){var e=function(t,e){if("object"!=nn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=nn(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==nn(e)?e:e+""}n(2807),n(2873),n(4499),n(4177);var _n=function(e){function n(t){var e;return sn(this,n),dn(e=un(this,n,[t]),"handleClick",(function(){var t=Potree.saveProject(e.props.viewer).view,n=function(){e.setState({error:(0,i._)("Cannot set initial camera view")}),setTimeout((function(){return e.setState({error:""})}),3e3)};U().ajax({url:"/api/projects/".concat(e.props.task.project,"/tasks/").concat(e.props.task.id,"/3d/cameraview"),contentType:"application/json",data:JSON.stringify(t),dataType:"json",type:"POST"}).done((function(t){t.success?(e.setState({showOk:!0}),setTimeout((function(){return e.setState({showOk:!1})}),2e3)):n()})).fail((function(){n()}))})),e.state={error:"",showOk:!1},e}return pn(n,e),ln(n,[{key:"render",value:function(){return[t.createElement("input",{key:"btn",type:"button",onClick:this.handleClick,style:{marginBottom:12,display:"inline-block"},name:"set_camera_view",value:(0,i._)("set initial camera view")}),this.state.showOk?t.createElement("div",{key:"ok",style:{color:"lightgreen",display:"inline-block",marginLeft:12}},""):"",this.state.error?t.createElement("div",{key:"error",style:{color:"red"}},this.state.error):""]}}])}(t.Component);dn(_n,"propTypes",{viewer:o().object.isRequired,task:o().object.isRequired});var vn=function(e){function n(t){var e;return sn(this,n),dn(e=un(this,n,[t]),"handleClick",(function(t){e.setState({showTexturedModel:t.target.checked}),e.props.toggleTexturedModel(t)})),e.state={showTexturedModel:!1},(0,i._)("Cameras"),e}return pn(n,e),ln(n,[{key:"render",value:function(){return t.createElement("label",null,t.createElement("input",{type:"checkbox",checked:this.state.showTexturedModel,onChange:this.handleClick})," ",(0,i._)("Show Model"))}}])}(t.Component);dn(vn,"propTypes",{toggleTexturedModel:o().func.isRequired});var gn=function(e){function n(t){var e;return sn(this,n),dn(e=un(this,n,[t]),"handleClick",(function(t){e.setState({showCameras:t.target.checked}),e.props.toggleCameras(t)})),e.state={showCameras:!1},e}return pn(n,e),ln(n,[{key:"render",value:function(){return t.createElement("label",null,t.createElement("input",{type:"checkbox",checked:this.state.showCameras,onChange:this.handleClick})," ",(0,i._)("Show Cameras"))}}])}(t.Component);dn(gn,"propTypes",{toggleCameras:o().func.isRequired});var yn=function(e){function n(t){var e;return sn(this,n),dn(e=un(this,n,[t]),"assetsPath",(function(){return"/api/projects/".concat(e.props.task.project,"/tasks/").concat(e.props.task.id,"/assets")})),dn(e,"urlExists",(function(t,e){U().ajax({url:t,type:"HEAD",error:function(){e(!1)},success:function(){e(!0)}})})),dn(e,"loadGeoreferencingOffset",(function(t){var n="".concat(e.assetsPath(),"/odm_georeferencing/coords.txt"),o="".concat(e.assetsPath(),"/odm_georeferencing/odm_georeferencing_model_geo.txt"),i=function(e){U().ajax({url:e,type:"GET",error:function(){console.warn("Cannot find ".concat(e," (not georeferenced?)")),t({x:0,y:0})},success:function(e){var n,o,i=e.split("\n");if(i.length>=2){var r=(n=i[1].split(" ").map(parseFloat),o=2,function(t){if(Array.isArray(t))return t}(n)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,i,r,s,a=[],l=!0,u=!1;try{if(r=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=r.call(n)).done)&&(a.push(o.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(n,o)||on(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=r[0],a=r[1];t({x:s,y:a})}else console.warn("Malformed georeferencing file: ".concat(e)),t({x:0,y:0})}})};U().ajax({type:"HEAD",url:o}).done((function(){i(o)})).fail((function(){i(n)}))})),dn(e,"pointCloudFilePath",(function(t){var n=e.assetsPath()+"/entwine_pointcloud/ept.json",o=e.assetsPath()+"/potree_pointcloud/cloud.js";e.urlExists(n,(function(e){t(e?n:o)}))})),dn(e,"texturedModelDirectoryPath",(function(){return e.assetsPath()+"/odm_texturing/"})),dn(e,"hasGeoreferencedAssets",(function(){return-1!==e.props.task.available_assets.indexOf("orthophoto.tif")})),dn(e,"hasTexturedModel",(function(){return-1!==e.props.task.available_assets.indexOf("textured_model.zip")})),dn(e,"getTexturedModelType",(function(){return-1!==e.props.task.available_assets.indexOf("textured_model.glb")?"gltf":"obj"})),dn(e,"hasCameras",(function(){return-1!==e.props.task.available_assets.indexOf("shots.geojson")})),dn(e,"objFilePath",(function(t){var n=e.texturedModelDirectoryPath()+"odm_textured_model_geo.obj",o=e.texturedModelDirectoryPath()+"odm_textured_model.obj";U().ajax({type:"HEAD",url:n}).done((function(){t(n)})).fail((function(){t(o)}))})),dn(e,"glbFilePath",(function(){return e.texturedModelDirectoryPath()+"odm_textured_model_geo.glb"})),dn(e,"mtlFilename",(function(t){var n=e.texturedModelDirectoryPath()+"odm_textured_model_geo.mtl";U().ajax({type:"HEAD",url:n}).done((function(){t("odm_textured_model_geo.mtl")})).fail((function(){t("odm_textured_model.mtl")}))})),dn(e,"getCameraUnderCursor",(function(t){var n=new en.Raycaster,o=viewer.renderer.domElement.getBoundingClientRect(),i=[t.clientX,t.clientY],r=i[1],s=[(i[0]-o.left)/o.width,(r-o.top)/o.height],a=function(t,e,n){if(cn())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,e);var i=new(t.bind.apply(t,o));return n&&fn(i,n.prototype),i}(en.Vector2,s),l=viewer.scene.getActiveCamera(),u=new en.Vector3(2*a.x-1,-2*a.y+1);n.setFromCamera(u,l);var c=n.intersectObjects(e.cameraMeshes);if(c.length>0)return c[0].object.parent.parent})),dn(e,"handleRenderMouseMove",(function(t){e._prevCamera&&e._prevCamera!==e.state.selectedCamera&&e.setCameraOpacity(e._prevCamera,.7);var n=e.getCameraUnderCursor(t);n?(viewer.renderer.domElement.classList.add("pointer-cursor"),e.setCameraOpacity(n,1)):viewer.renderer.domElement.classList.remove("pointer-cursor"),e._prevCamera=n})),dn(e,"handleRenderMouseClick",(function(t){var n=e.getCameraUnderCursor(t);n===e.state.selectedCamera?e.setState({selectedCamera:null}):n&&(e.state.selectedCamera&&e.setCameraOpacity(e.state.selectedCamera,.7),e.setState({selectedCamera:n}))})),dn(e,"closeThumb",(function(t){t.stopPropagation(),e.setState({selectedCamera:null})})),dn(e,"setPointCloudsVisible",(function(t){viewer.setEDLEnabled(!0),viewer.setEDLOpacity(t?1:0)})),dn(e,"toggleCameras",(function(t){if(0!==e.cameraMeshes.length||(e.loadCameras(),0!==e.cameraMeshes.length)){var n=e.cameraMeshes[0].visible;e.cameraMeshes.forEach((function(t){t.visible=!n,t.parent.visible=t.visible}))}})),dn(e,"loadGltf",(function(t,n){e.gltfLoader||(e.gltfLoader=new en.GLTFLoader),e.dracoLoader||(e.dracoLoader=new en.DRACOLoader,e.dracoLoader.setDecoderPath("/static/app/js/vendor/draco/"),e.gltfLoader.setDRACOLoader(e.dracoLoader)),e.gltfLoader.load(t,(function(t){n(null,t)}),(function(t){}),(function(t){n(t)}))})),dn(e,"toggleTexturedModel",(function(t){if(t.target.checked)if(null!==e.modelReference||e.state.initializingModel)e.modelReference.visible=!0,e.setPointCloudsVisible(!1);else{e.setState({initializingModel:!0});var n=function(t,n){t.translateX(n.x),t.translateY(n.y),viewer.scene.scene.add(t),e.modelReference=t,e.setPointCloudsVisible(!1),e.setState({initializingModel:!1})};if("gltf"===e.getTexturedModelType())e.loadGltf(e.glbFilePath(),(function(t,o){if(t)e.setState({initializingModel:!1,error:t});else{var i={x:0,y:0};o.scene.CESIUM_RTC&&o.scene.CESIUM_RTC.center&&(i.x=o.scene.CESIUM_RTC.center[0],i.y=o.scene.CESIUM_RTC.center[1]),n(o.scene,i)}}));else{var o=new en.MTLLoader;o.setPath(e.texturedModelDirectoryPath()),e.mtlFilename((function(t){o.load(t,(function(t){t.preload();var o=new en.OBJLoader;o.setMaterials(t),e.objFilePath((function(t){o.load(t,(function(t){e.loadGeoreferencingOffset((function(e){n(t,e)}))}))}))}))}))}}else e.modelReference.visible=!1,e.setPointCloudsVisible(!0)})),e.state={error:"",showTexturedModel:!1,initializingModel:!1,selectedCamera:null,modalOpen:!1},e.pointCloud=null,e.modelReference=null,e.cameraMeshes=[],e}return pn(n,e),ln(n,[{key:"getSceneData",value:function(){var t=Potree.saveProject(window.viewer);return delete t.view,delete t.settings,delete t.cameraAnimations,t}},{key:"componentDidMount",value:function(){var e=this,n=this.container;if(n){window.viewer=new Potree.Viewer(n),viewer.setEDLEnabled(!0),viewer.setFOV(60),viewer.setPointBudget(1e7),viewer.setEDLEnabled(!0),viewer.loadSettingsFromURL(),viewer.loadGUI((function(){if(viewer.setLanguage("en"),U()("#menu_tools").next().show(),viewer.toggleSidebar(),e.hasTexturedModel()?window.ReactDOM.render(t.createElement(vn,{toggleTexturedModel:e.toggleTexturedModel}),U()("#textured_model_button").get(0)):(U()("#textured_model").hide(),U()("#textured_model_container").hide()),e.hasCameras()?window.ReactDOM.render(t.createElement(gn,{toggleCameras:e.toggleCameras}),U()("#cameras_button").get(0)):(U()("#cameras").hide(),U()("#cameras_container").hide()),!e.props.public){var n=U()("<div id='set-camera-view'></div>");n.prependTo(U()("#scene_export").parent()),window.ReactDOM.render(t.createElement(_n,{viewer,task:e.props.task}),n.get(0))}})),viewer.scene.scene.add(new en.AmbientLight(4210752,2)),viewer.scene.scene.add(new en.DirectionalLight(13421772,.5));var o=new en.DirectionalLight(13421772,.5);o.position.z=99999999999,viewer.scene.scene.add(o),this.pointCloudFilePath((function(t){Potree.loadPointCloud(t,"Point Cloud",(function(t){"loading_failed"!=t.type?(viewer.scene.addPointCloud(t.pointcloud),e.pointCloud=t.pointcloud,t.pointcloud.material.size=1,viewer.fitToScreen(),U().ajax({type:"GET",url:"/api/projects/".concat(e.props.task.project,"/tasks/").concat(e.props.task.id,"/3d/scene")}).done((function(t){var n=Potree.saveProject(viewer);t.view&&t.view.position||(t.view=n.view);for(var o=["pointclouds","settings","cameraAnimations"],i=0,r=o;i<r.length;i++){var s=r[i];t[s]=n[s]}for(var a in n)-1===o.indexOf(a)&&(t[a]=t[a]||n[a]);viewer.addEventListener("update",(function e(){Potree.loadProject(viewer,t),viewer.removeEventListener("update",e)}));var l=null,u=null,c=0,h=JSON.stringify(e.getSceneData());u=setInterval((function(){var t=JSON.stringify(e.getSceneData());t!==h&&function(t){l&&(l.abort(),l=null),l=U().ajax({url:"/api/projects/".concat(e.props.task.project,"/tasks/").concat(e.props.task.id,"/3d/scene"),contentType:"application/json",data:t,dataType:"json",type:"POST"}).done((function(e){e.success?(c=0,h=t):console.warn("Cannot save Potree scene")})).fail((function(){console.error("Cannot save Potree scene"),5==++c&&clearInterval(u)}))}(t);var n=viewer.scene.view.position;0===n.x&&0===n.y&&0===n.z&&viewer.fitToScreen()}),3e3)})).fail((function(t){console.error("Cannot load 3D scene information",t)}))):e.setState({error:"Could not load point cloud. This task doesn't seem to have one. Try processing the task again."})}))})),viewer.renderer.domElement.addEventListener("mousedown",this.handleRenderMouseClick),viewer.renderer.domElement.addEventListener("mousemove",this.handleRenderMouseMove)}}},{key:"componentWillUnmount",value:function(){viewer.renderer.domElement.removeEventListener("mousedown",this.handleRenderMouseClick),viewer.renderer.domElement.removeEventListener("mousemove",this.handleRenderMouseMove)}},{key:"setCameraOpacity",value:function(t,e){t.traverse((function(t){t.material&&(t.material.opacity=e)}))}},{key:"loadCameras",value:function(){var t=this,e=this.props.task;if(this.hasCameras()){var n=new en.FileLoader;this.loadGltf("/static/app/models/camera.glb",(function(o,i){if(o)console.error(o);else{var r=i.scene;n.load("/api/projects/".concat(e.project,"/tasks/").concat(e.id,"/download/shots.geojson"),(function(e){var n=JSON.parse(e);r.traverse((function(t){t.material&&(t.material.transparent=!0,t.material.opacity=.7)})),n.features.forEach((function(e){var n,o,i=r.clone();i.traverse((function(t){t.isMesh&&(t.material=t.material.clone())})),i.matrixAutoUpdate=!1,(n=i.matrix).set.apply(n,function(t){if(Array.isArray(t))return rn(t)}(o=function(t,e,n){var o=new en.Vector3(-e[0],-e[1],-e[2]),i=o.length();o.normalize();var r=(new en.Matrix4).makeRotationAxis(o,i);return r.setPosition(new en.Vector3(t[0],t[1],t[2])),r.transpose()}(e.properties.translation,e.properties.rotation).elements)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||on(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),viewer.scene.scene.add(i),i._feat=e,t.cameraMeshes.push(i.children[0].children[1])}))}),void 0,console.error)}}))}}},{key:"render",value:function(){var e=this,n=this.state.selectedCamera,o=this.props.task;return t.createElement("div",{className:"model-view"},t.createElement(_,{bind:[this,"error"]}),t.createElement("div",{className:"container potree_container",style:{height:"100%",width:"100%",position:"relative"},onContextMenu:function(t){t.preventDefault()}},t.createElement("div",{id:"potree_render_area",ref:function(t){e.container=t}}),t.createElement("div",{id:"potree_sidebar_container"}," ")),t.createElement("div",{className:"model-action-buttons "+(this.state.modalOpen?"modal-open":"")},t.createElement(It,{task:this.props.task,direction:"up",showLabel:!1,buttonClass:"btn-secondary",onModalOpen:function(){return e.setState({modalOpen:!0})},onModalClose:function(){return e.setState({modalOpen:!1})}}),this.props.shareButtons&&!this.props.public?t.createElement(Ge,{ref:function(t){e.shareButton=t},task:this.props.task,popupPlacement:"top",linksTarget:"3d"}):"",t.createElement(L,{public:this.props.public,task:this.props.task,type:"modelToMap"})),n?t.createElement("div",{className:"thumbnail"},t.createElement("a",{className:"close-thumb",href:"javascript:void(0)",onClick:this.closeThumb},t.createElement("i",{className:"fa fa-window-close"})),t.createElement(tn,{feature:n._feat,task:o})):"",t.createElement(Vt,{message:(0,i._)("Loading textured model..."),show:this.state.initializingModel}))}}])}(t.Component);dn(yn,"defaultProps",{task:null,public:!1,shareButtons:!0}),dn(yn,"propTypes",{task:o().object.isRequired,public:o().bool,shareButtons:o().bool}),U()((function(){var e=i18n.init;i18n.addPostProcessor("gettext",(function(t,e,n){return t?(0,i._)(t):t})),i18n.init=function(t,n){t.preload=["en"],t.postProcess="gettext",e(t,n)},U()("[data-modelview]").each((function(){var e=U()(this).data();delete e.modelview,window.ReactDOM.render(t.createElement(yn,e),U()(this).get(0))}))}))})()})();