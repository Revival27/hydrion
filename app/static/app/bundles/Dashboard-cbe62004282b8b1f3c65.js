/*! For license information please see Dashboard-cbe62004282b8b1f3c65.js.LICENSE.txt */
(()=>{var t={1345:(t,e,n)=>{"use strict";n.d(e,{A:()=>v});var o=n(6540),r=(n(5808),n(6894)),i=n.n(r),a=n(2280),s=n(1669),l=n.n(s),u=n(4378);function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function h(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,p(o.key),o)}}function p(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=c(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}function f(t,e,n){return e=m(e),function(t,e){if(e&&("object"===c(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,d()?Reflect.construct(e,n||[],m(t).constructor):e.apply(t,n))}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}var g=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=f(this,e)).state={lines:[]},"string"==typeof t.children&&(n.state.lines=t.children.split("\n"),t.onAddLines&&t.onAddLines(n.state.lines)),n.autoscroll=!0===t.autoscroll,n.showFullscreenButton=!0===t.showFullscreenButton,n.setRef=n.setRef.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleMouseOut=n.handleMouseOut.bind(n),n.downloadTxt=n.downloadTxt.bind(n),n.enterFullscreen=n.enterFullscreen.bind(n),n.exitFullscreen=n.exitFullscreen.bind(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}(e,t),n=e,r=[{key:"componentDidMount",value:function(){this.checkAutoscroll(),this.setupDynamicSource()}},{key:"setupDynamicSource",value:function(){var t=this;void 0!==this.props.source&&function e(){var n="function"==typeof t.props.source?t.props.source(t.state.lines.length):t.props.source;t.sourceRequest=l().get(n,(function(e){if(""!==e){var n=e.split("\n");t.addLines(n)}})).always((function(n,o){"abort"!==o&&void 0!==t.props.refreshInterval&&(t.sourceTimeout=setTimeout(e,t.props.refreshInterval)),t.checkAutoscroll()}))}()}},{key:"clear",value:function(){this.tearDownDynamicSource(),this.setState({lines:[]}),this.setupDynamicSource()}},{key:"downloadTxt",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"console.txt";a.A.saveAs(this.state.lines.join("\n"),t)}},{key:"enterFullscreen",value:function(){var t=this.$console.get(0);t.requestFullscreen&&t.requestFullscreen()}},{key:"exitFullscreen",value:function(){document.exitFullscreen&&document.exitFullscreen()}},{key:"tearDownDynamicSource",value:function(){this.sourceTimeout&&clearTimeout(this.sourceTimeout),this.sourceRequest&&this.sourceRequest.abort()}},{key:"componentWillUnmount",value:function(){this.tearDownDynamicSource()}},{key:"setRef",value:function(t){null!=t&&(this.$console=l()(t))}},{key:"handleMouseOver",value:function(){this.autoscroll=!1}},{key:"handleMouseOut",value:function(){this.autoscroll=!0===this.props.autoscroll}},{key:"checkAutoscroll",value:function(){this.$console&&this.autoscroll&&this.$console.scrollTop(this.$console[0].scrollHeight-this.$console.height())}},{key:"addLines",value:function(t){Array.isArray(t)||(t=[t]),this.setState(i()(this.state,{lines:{$push:t}})),this.checkAutoscroll(),this.props.onAddLines&&this.props.onAddLines(t)}},{key:"render",value:function(){var t=this,e=function(e){return{__html:prettyPrintOne(a.A.escapeHtml(e),t.props.lang,t.props.lines)}},n=0,r=this.state.lines;this.props.maximumLines&&r.length>this.props.maximumLines&&(r=r.slice(-this.props.maximumLines)).unshift("... "+(0,u.interpolate)((0,u._)("output truncated at %(count)s lines"),{count:this.props.maximumLines})+" ...");var i=[o.createElement("pre",{key:"console",className:"console prettyprint\n            ".concat(this.props.lang?"lang-".concat(this.props.lang):"","\n            ").concat(this.props.lines?"linenums":"","\n            ").concat(this.props.className||""),style:{height:this.props.height?this.props.height:"auto"},onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,ref:this.setRef},o.createElement("a",{href:"javascript:void(0);",onClick:this.exitFullscreen,className:"exit-fullscreen btn btn-sm btn-primary",title:(0,u._)("Toggle Fullscreen")},o.createElement("i",{className:"fa fa-expand"})," ",(0,u._)("Exit Fullscreen")),r.map((function(r){return t.props.lang?o.createElement("div",{key:n++,dangerouslySetInnerHTML:e(r)}):r+"\n"})),"\n",o.createElement("a",{href:"javascript:void(0);",onClick:this.exitFullscreen,className:"exit-fullscreen btn btn-sm btn-primary",title:(0,u._)("Toggle Fullscreen")},o.createElement("i",{className:"fa fa-expand"})," ",(0,u._)("Exit Fullscreen")))];return this.props.showConsoleButtons&&i.push(o.createElement("div",{key:"buttons",className:"console-buttons"},o.createElement("a",{href:"javascript:void(0);",onClick:function(){return t.downloadTxt()},className:"btn btn-sm btn-primary",title:(0,u._)("Download To File")},o.createElement("i",{className:"fa fa-download"})),o.createElement("a",{href:"javascript:void(0);",onClick:this.enterFullscreen,className:"btn btn-sm btn-primary",title:(0,u._)("Toggle Fullscreen")},o.createElement("i",{className:"fa fa-expand"})))),i}}],r&&h(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o.Component);l()((function(){l()("[data-console]").each((function(){window.ReactDOM.render(o.createElement(g,{lang:l()(this).data("console-lang"),height:l()(this).data("console-height"),autoscroll:void 0!==l()(this).attr("autoscroll")&&!1!==l()(this).attr("autoscroll")},l()(this).text()),l()(this).get(0))}))}));const v=g},2280:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var o=n(4213),r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const i={escapeHtml:function(t){return String(t).replace(/[&<>"'\/]/g,(function(t){return r[t]}))},html:function(t){for(var e=t[0],n=[].slice.call(arguments,1),o=0;o<n.length;++o)e+=this.escapeHtml(n[o])+t[o+1];return e},queryParams:function(t){var e={},n=t.search.replace("?","").match(/([^&=]+)=?([^&]*)/g)||[];for(var o in n){var r=n[o].split("=");void 0!==r[1]&&(e[r[0]]=r[1])}return e},toSearchQuery:function(t){var e=[];for(var n in t)e.push(n+"="+t[n]);return e.length>0?"?"+e.join("&"):""},replaceSearchQueryParam:function(t,e,n){var o=this.queryParams(t);return o[e]=n,this.toSearchQuery(o)},buildUrlWithQuery:function(t,e){return(-1!==t.indexOf("?")?t.slice(0,t.indexOf("?")):t)+this.toSearchQuery(e)},clone:function(t){return JSON.parse(JSON.stringify(t))},absoluteUrl:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href;"/"===t[0]&&(t=t.slice(1));var n=document.createElement("a");return n.href=e,"".concat(n.protocol,"//").concat(n.host,"/").concat(t)},assert:function(t,e){if(!t){if(e=e||"Assertion failed","undefined"!=typeof Error)throw new Error(e);throw e}},getCurrentScriptDir:function(){var t=document.getElementsByTagName("script");return t[t.length-1].src.split("?")[0].split("/").slice(0,-1).join("/")+"/"},saveAs:function(t,e){var n=new Blob([t],{type:"text/plain;charset=utf-8"});o.saveAs(n,e)},bytesToSize:function(t){if(0==t)return"0 byte";var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:2)||3,n=Math.floor(Math.log(t)/Math.log(1e3));return parseFloat((t/Math.pow(1e3,n)).toFixed(e))+" "+["bytes","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"][n]}}},4378:t=>{t.exports={gettext:window.gettext,_:window.gettext,interpolate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return window.interpolate(t,e,!0)},get_format:function(t){return window.get_format(t)}}},42:(t,e,n)=>{"use strict";function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}t=n.nmd(t);var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==o(e)&&"function"!=typeof e?t:e}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=function(){function t(){a(this,t)}return r(t,[{key:"on",value:function(t,e){return this._callbacks=this._callbacks||{},this._callbacks[t]||(this._callbacks[t]=[]),this._callbacks[t].push(e),this}},{key:"emit",value:function(t){this._callbacks=this._callbacks||{};var e=this._callbacks[t];if(e){for(var n=arguments.length,o=Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];for(var i=0,a=a=e;!(i>=a.length);)a[i++].apply(this,o)}return this}},{key:"off",value:function(t,e){if(!this._callbacks||0===arguments.length)return this._callbacks={},this;var n=this._callbacks[t];if(!n)return this;if(1===arguments.length)return delete this._callbacks[t],this;for(var o=0;o<n.length;o++)if(n[o]===e){n.splice(o,1);break}return this}}]),t}(),l=function(t){function e(t,n){a(this,e);var o,r=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),s=void 0;if(r.element=t,r.version=e.version,r.defaultOptions.previewTemplate=r.defaultOptions.previewTemplate.replace(/\n*/g,""),r.clickableElements=[],r.listeners=[],r.files=[],"string"==typeof r.element&&(r.element=document.querySelector(r.element)),!r.element||null==r.element.nodeType)throw new Error("Invalid dropzone element.");if(r.element.dropzone)throw new Error("Dropzone already attached.");e.instances.push(r),r.element.dropzone=r;var l,u=null!=(o=e.optionsForElement(r.element))?o:{};if(r.options=e.extend({},r.defaultOptions,u,null!=n?n:{}),r.options.forceFallback||!e.isBrowserSupported())return l=r.options.fallback.call(r),i(r,l);if(null==r.options.url&&(r.options.url=r.element.getAttribute("action")),!r.options.url)throw new Error("No URL provided.");if(r.options.acceptedFiles&&r.options.acceptedMimeTypes)throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");if(r.options.uploadMultiple&&r.options.chunking)throw new Error("You cannot set both: uploadMultiple and chunking.");return r.options.acceptedMimeTypes&&(r.options.acceptedFiles=r.options.acceptedMimeTypes,delete r.options.acceptedMimeTypes),null!=r.options.renameFilename&&(r.options.renameFile=function(t){return r.options.renameFilename.call(r,t.name,t)}),r.options.method=r.options.method.toUpperCase(),(s=r.getExistingFallback())&&s.parentNode&&s.parentNode.removeChild(s),!1!==r.options.previewsContainer&&(r.options.previewsContainer?r.previewsContainer=e.getElement(r.options.previewsContainer,"previewsContainer"):r.previewsContainer=r.element),r.options.clickable&&(!0===r.options.clickable?r.clickableElements=[r.element]:r.clickableElements=e.getElements(r.options.clickable,"clickable")),r.init(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+o(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,null,[{key:"initClass",value:function(){this.prototype.Emitter=s,this.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"],this.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,timeout:3e4,parallelUploads:2,uploadMultiple:!1,chunking:!1,forceChunking:!1,chunkSize:2e6,parallelChunkUploads:!1,retryChunks:!1,retryChunksLimit:3,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,thumbnailMethod:"crop",resizeWidth:null,resizeHeight:null,resizeMimeType:null,resizeQuality:.8,resizeMethod:"contain",filesizeBase:1e3,maxFiles:null,headers:null,clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,hiddenInputContainer:"body",capture:null,renameFilename:null,renameFile:null,forceFallback:!1,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",dictFileSizeUnits:{tb:"TB",gb:"GB",mb:"MB",kb:"KB",b:"b"},init:function(){},params:function(t,e,n){if(n)return{dzuuid:n.file.upload.uuid,dzchunkindex:n.index,dztotalfilesize:n.file.size,dzchunksize:this.options.chunkSize,dztotalchunkcount:n.file.upload.totalChunkCount,dzchunkbyteoffset:n.index*this.options.chunkSize}},accept:function(t,e){return e()},chunksUploaded:function(t,e){e()},fallback:function(){var t=void 0;this.element.className=this.element.className+" dz-browser-not-supported";for(var n=0,o=o=this.element.getElementsByTagName("div");!(n>=o.length);){var r=o[n++];if(/(^| )dz-message($| )/.test(r.className)){t=r,r.className="dz-message";break}}t||(t=e.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(t));var i=t.getElementsByTagName("span")[0];return i&&(null!=i.textContent?i.textContent=this.options.dictFallbackMessage:null!=i.innerText&&(i.innerText=this.options.dictFallbackMessage)),this.element.appendChild(this.getFallbackForm())},resize:function(t,e,n,o){var r={srcX:0,srcY:0,srcWidth:t.width,srcHeight:t.height},i=t.width/t.height;null==e&&null==n?(e=r.srcWidth,n=r.srcHeight):null==e?e=n*i:null==n&&(n=e/i);var a=(e=Math.min(e,r.srcWidth))/(n=Math.min(n,r.srcHeight));if(r.srcWidth>e||r.srcHeight>n)if("crop"===o)i>a?(r.srcHeight=t.height,r.srcWidth=r.srcHeight*a):(r.srcWidth=t.width,r.srcHeight=r.srcWidth/a);else{if("contain"!==o)throw new Error("Unknown resizeMethod '"+o+"'");i>a?n=e/i:e=n*i}return r.srcX=(t.width-r.srcWidth)/2,r.srcY=(t.height-r.srcHeight)/2,r.trgWidth=e,r.trgHeight=n,r},transformFile:function(t,e){return(this.options.resizeWidth||this.options.resizeHeight)&&t.type.match(/image.*/)?this.resizeImage(t,this.options.resizeWidth,this.options.resizeHeight,this.options.resizeMethod,e):e(t)},previewTemplate:'<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-error-message"><span data-dz-errormessage></span></div>\n  <div class="dz-success-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Check</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <path d="M23.5,31.8431458 L17.5852419,25.9283877 C16.0248253,24.3679711 13.4910294,24.366835 11.9289322,25.9289322 C10.3700136,27.4878508 10.3665912,30.0234455 11.9283877,31.5852419 L20.4147581,40.0716123 C20.5133999,40.1702541 20.6159315,40.2626649 20.7218615,40.3488435 C22.2835669,41.8725651 24.794234,41.8626202 26.3461564,40.3106978 L43.3106978,23.3461564 C44.8771021,21.7797521 44.8758057,19.2483887 43.3137085,17.6862915 C41.7547899,16.1273729 39.2176035,16.1255422 37.6538436,17.6893022 L23.5,31.8431458 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" stroke-opacity="0.198794158" stroke="#747474" fill-opacity="0.816519475" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>\n      </g>\n    </svg>\n  </div>\n  <div class="dz-error-mark">\n    <svg width="54px" height="54px" viewBox="0 0 54 54" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">\n      <title>Error</title>\n      <defs></defs>\n      <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">\n        <g id="Check-+-Oval-2" sketch:type="MSLayerGroup" stroke="#747474" stroke-opacity="0.198794158" fill="#FFFFFF" fill-opacity="0.816519475">\n          <path d="M32.6568542,29 L38.3106978,23.3461564 C39.8771021,21.7797521 39.8758057,19.2483887 38.3137085,17.6862915 C36.7547899,16.1273729 34.2176035,16.1255422 32.6538436,17.6893022 L27,23.3431458 L21.3461564,17.6893022 C19.7823965,16.1255422 17.2452101,16.1273729 15.6862915,17.6862915 C14.1241943,19.2483887 14.1228979,21.7797521 15.6893022,23.3461564 L21.3431458,29 L15.6893022,34.6538436 C14.1228979,36.2202479 14.1241943,38.7516113 15.6862915,40.3137085 C17.2452101,41.8726271 19.7823965,41.8744578 21.3461564,40.3106978 L27,34.6568542 L32.6538436,40.3106978 C34.2176035,41.8744578 36.7547899,41.8726271 38.3137085,40.3137085 C39.8758057,38.7516113 39.8771021,36.2202479 38.3106978,34.6538436 L32.6568542,29 Z M27,53 C41.3594035,53 53,41.3594035 53,27 C53,12.6405965 41.3594035,1 27,1 C12.6405965,1 1,12.6405965 1,27 C1,41.3594035 12.6405965,53 27,53 Z" id="Oval-2" sketch:type="MSShapeGroup"></path>\n        </g>\n      </g>\n    </svg>\n  </div>\n</div>',drop:function(t){return this.element.classList.remove("dz-drag-hover")},dragstart:function(t){},dragend:function(t){return this.element.classList.remove("dz-drag-hover")},dragenter:function(t){return this.element.classList.add("dz-drag-hover")},dragover:function(t){return this.element.classList.add("dz-drag-hover")},dragleave:function(t){return this.element.classList.remove("dz-drag-hover")},paste:function(t){},reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(t){var n=this;if(this.element===this.previewsContainer&&this.element.classList.add("dz-started"),this.previewsContainer){t.previewElement=e.createElement(this.options.previewTemplate.trim()),t.previewTemplate=t.previewElement,this.previewsContainer.appendChild(t.previewElement);for(var o=0,r=r=t.previewElement.querySelectorAll("[data-dz-name]");!(o>=r.length);){var i=r[o++];i.textContent=t.name}for(var a=0,s=s=t.previewElement.querySelectorAll("[data-dz-size]");!(a>=s.length);)(i=s[a++]).innerHTML=this.filesize(t.size);this.options.addRemoveLinks&&(t._removeLink=e.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),t.previewElement.appendChild(t._removeLink));for(var l=function(o){return o.preventDefault(),o.stopPropagation(),t.status===e.UPLOADING?e.confirm(n.options.dictCancelUploadConfirmation,(function(){return n.removeFile(t)})):n.options.dictRemoveFileConfirmation?e.confirm(n.options.dictRemoveFileConfirmation,(function(){return n.removeFile(t)})):n.removeFile(t)},u=0,c=c=t.previewElement.querySelectorAll("[data-dz-remove]");!(u>=c.length);)c[u++].addEventListener("click",l)}},removedfile:function(t){return null!=t.previewElement&&null!=t.previewElement.parentNode&&t.previewElement.parentNode.removeChild(t.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(t,e){if(t.previewElement){t.previewElement.classList.remove("dz-file-preview");for(var n=0,o=o=t.previewElement.querySelectorAll("[data-dz-thumbnail]");!(n>=o.length);){var r=o[n++];r.alt=t.name,r.src=e}return setTimeout((function(){return t.previewElement.classList.add("dz-image-preview")}),1)}},error:function(t,e){if(t.previewElement){t.previewElement.classList.add("dz-error"),"String"!=typeof e&&e.error&&(e=e.error);for(var n=0,o=o=t.previewElement.querySelectorAll("[data-dz-errormessage]");!(n>=o.length);)o[n++].textContent=e}},errormultiple:function(){},processing:function(t){if(t.previewElement&&(t.previewElement.classList.add("dz-processing"),t._removeLink))return t._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:function(){},uploadprogress:function(t,e,n){if(t.previewElement)for(var o=0,r=r=t.previewElement.querySelectorAll("[data-dz-uploadprogress]");!(o>=r.length);){var i=r[o++];"PROGRESS"===i.nodeName?i.value=e:i.style.width=e+"%"}},totaluploadprogress:function(){},sending:function(){},sendingmultiple:function(){},success:function(t){if(t.previewElement)return t.previewElement.classList.add("dz-success")},successmultiple:function(){},canceled:function(t){return this.emit("error",t,"Upload canceled.")},canceledmultiple:function(){},complete:function(t){if(t._removeLink&&(t._removeLink.textContent=this.options.dictRemoveFile),t.previewElement)return t.previewElement.classList.add("dz-complete")},completemultiple:function(){},maxfilesexceeded:function(){},maxfilesreached:function(){},queuecomplete:function(){},addedfiles:function(){}},this.prototype._thumbnailQueue=[],this.prototype._processingThumbnail=!1}},{key:"extend",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];for(var r=0,i=i=n;!(r>=i.length);){var a=i[r++];for(var s in a){var l=a[s];t[s]=l}}return t}}]),r(e,[{key:"getAcceptedFiles",value:function(){return this.files.filter((function(t){return t.accepted})).map((function(t){return t}))}},{key:"getRejectedFiles",value:function(){return this.files.filter((function(t){return!t.accepted})).map((function(t){return t}))}},{key:"getFilesWithStatus",value:function(t){return this.files.filter((function(e){return e.status===t})).map((function(t){return t}))}},{key:"getQueuedFiles",value:function(){return this.getFilesWithStatus(e.QUEUED)}},{key:"getUploadingFiles",value:function(){return this.getFilesWithStatus(e.UPLOADING)}},{key:"getAddedFiles",value:function(){return this.getFilesWithStatus(e.ADDED)}},{key:"getActiveFiles",value:function(){return this.files.filter((function(t){return t.status===e.UPLOADING||t.status===e.QUEUED})).map((function(t){return t}))}},{key:"init",value:function(){var t=this;"form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(e.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&function e(){return t.hiddenFileInput&&t.hiddenFileInput.parentNode.removeChild(t.hiddenFileInput),t.hiddenFileInput=document.createElement("input"),t.hiddenFileInput.setAttribute("type","file"),(null===t.options.maxFiles||t.options.maxFiles>1)&&t.hiddenFileInput.setAttribute("multiple","multiple"),t.hiddenFileInput.className="dz-hidden-input",null!==t.options.acceptedFiles&&t.hiddenFileInput.setAttribute("accept",t.options.acceptedFiles),null!==t.options.capture&&t.hiddenFileInput.setAttribute("capture",t.options.capture),t.hiddenFileInput.style.visibility="hidden",t.hiddenFileInput.style.position="absolute",t.hiddenFileInput.style.top="0",t.hiddenFileInput.style.left="0",t.hiddenFileInput.style.height="0",t.hiddenFileInput.style.width="0",document.querySelector(t.options.hiddenInputContainer).appendChild(t.hiddenFileInput),t.hiddenFileInput.addEventListener("change",(function(){var n=t.hiddenFileInput.files;if(n.length)for(var o=0,r=r=n;!(o>=r.length);){var i=r[o++];t.addFile(i)}return t.emit("addedfiles",n),e()}))}(),this.URL=null!==window.URL?window.URL:window.webkitURL;for(var n=0,o=o=this.events;!(n>=o.length);){var r=o[n++];this.on(r,this.options[r])}this.on("uploadprogress",(function(){return t.updateTotalUploadProgress()})),this.on("removedfile",(function(){return t.updateTotalUploadProgress()})),this.on("canceled",(function(e){return t.emit("complete",e)})),this.on("complete",(function(e){if(0===t.getAddedFiles().length&&0===t.getUploadingFiles().length&&0===t.getQueuedFiles().length)return setTimeout((function(){return t.emit("queuecomplete")}),0)}));var i=function(t){return t.stopPropagation(),t.preventDefault?t.preventDefault():t.returnValue=!1};return this.listeners=[{element:this.element,events:{dragstart:function(e){return t.emit("dragstart",e)},dragenter:function(e){return i(e),t.emit("dragenter",e)},dragover:function(e){var n=void 0;try{n=e.dataTransfer.effectAllowed}catch(t){}return e.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",i(e),t.emit("dragover",e)},dragleave:function(e){return t.emit("dragleave",e)},drop:function(e){return i(e),t.drop(e)},dragend:function(e){return t.emit("dragend",e)}}}],this.clickableElements.forEach((function(n){return t.listeners.push({element:n,events:{click:function(o){return(n!==t.element||o.target===t.element||e.elementInside(o.target,t.element.querySelector(".dz-message")))&&t.hiddenFileInput.click(),!0}}})})),this.enable(),this.options.init.call(this)}},{key:"destroy",value:function(){return this.disable(),this.removeAllFiles(!0),(null!=this.hiddenFileInput?this.hiddenFileInput.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,e.instances.splice(e.instances.indexOf(this),1)}},{key:"updateTotalUploadProgress",value:function(){var t=void 0,e=0,n=0;if(this.getActiveFiles().length){for(var o=0,r=r=this.getActiveFiles();!(o>=r.length);){var i=r[o++];e=i.upload.bytesSent,n=i.upload.total}t=100*e/n}else t=100;return this.emit("totaluploadprogress",t,n,e)}},{key:"_getParamName",value:function(t){return"function"==typeof this.options.paramName?this.options.paramName(t):this.options.paramName+(this.options.uploadMultiple?"["+t+"]":"")}},{key:"_renameFile",value:function(t){return"function"!=typeof this.options.renameFile?t.name:this.options.renameFile(t)}},{key:"getFallbackForm",value:function(){var t,n=void 0;if(t=this.getExistingFallback())return t;var o='<div class="dz-fallback">';this.options.dictFallbackText&&(o+="<p>"+this.options.dictFallbackText+"</p>"),o+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>';var r=e.createElement(o);return"FORM"!==this.element.tagName?(n=e.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>')).appendChild(r):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=n?n:r}},{key:"getExistingFallback",value:function(){for(var t=function(t){for(var e=0,n=n=t;!(e>=n.length);){var o=n[e++];if(/(^| )fallback($| )/.test(o.className))return o}},e=["div","form"],n=0;n<e.length;n++){var o,r=e[n];if(o=t(this.element.getElementsByTagName(r)))return o}}},{key:"setupEventListeners",value:function(){return this.listeners.map((function(t){return function(){var e=[];for(var n in t.events){var o=t.events[n];e.push(t.element.addEventListener(n,o,!1))}return e}()}))}},{key:"removeEventListeners",value:function(){return this.listeners.map((function(t){return function(){var e=[];for(var n in t.events){var o=t.events[n];e.push(t.element.removeEventListener(n,o,!1))}return e}()}))}},{key:"disable",value:function(){var t=this;return this.clickableElements.forEach((function(t){return t.classList.remove("dz-clickable")})),this.removeEventListeners(),this.files.map((function(e){return t.cancelUpload(e)}))}},{key:"removeListeners",value:function(){this.clickableElements.forEach((function(t){return t.classList.remove("dz-clickable")})),this.removeEventListeners()}},{key:"restoreListeners",value:function(){return this.clickableElements.forEach((function(t){return t.classList.add("dz-clickable")})),this.setupEventListeners()}},{key:"enable",value:function(){return this.clickableElements.forEach((function(t){return t.classList.add("dz-clickable")})),this.setupEventListeners()}},{key:"filesize",value:function(t){var e=0,n="b";if(t>0){for(var o=["tb","gb","mb","kb","b"],r=0;r<o.length;r++){var i=o[r];if(t>=Math.pow(this.options.filesizeBase,4-r)/10){e=t/Math.pow(this.options.filesizeBase,4-r),n=i;break}}e=Math.round(10*e)/10}return"<strong>"+e+"</strong> "+this.options.dictFileSizeUnits[n]}},{key:"_updateMaxFilesReachedClass",value:function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")}},{key:"drop",value:function(t){if(t.dataTransfer){this.emit("drop",t);var e=t.dataTransfer.files;if(this.emit("addedfiles",e),e.length){var n=t.dataTransfer.items;n&&n.length&&null!=n[0].webkitGetAsEntry?this._addFilesFromItems(n):this.handleFiles(e)}}}},{key:"paste",value:function(t){if(null!=(null!=(e=null!=t?t.clipboardData:void 0)?function(t){return t.items}(e):void 0)){var e;this.emit("paste",t);var n=t.clipboardData.items;return n.length?this._addFilesFromItems(n):void 0}}},{key:"handleFiles",value:function(t){var e=this;return t.map((function(t){return e.addFile(t)}))}},{key:"_addFilesFromItems",value:function(t){var e=this;return function(){for(var n=[],o=0,r=r=t;!(o>=r.length);){var i,a=r[o++];null!=a.webkitGetAsEntry&&(i=a.webkitGetAsEntry())?i.isFile?n.push(e.addFile(a.getAsFile())):i.isDirectory?n.push(e._addFilesFromDirectory(i,i.name)):n.push(void 0):null==a.getAsFile||null!=a.kind&&"file"!==a.kind?n.push(void 0):n.push(e.addFile(a.getAsFile()))}return n}()}},{key:"_addFilesFromDirectory",value:function(t,e){var n=this,o=t.createReader(),r=function(t){return"log",n=function(e){return e.log(t)},null!=(e=console)&&"function"==typeof e.log?n(e):void 0;var e,n};return function t(){return o.readEntries((function(o){if(o.length>0){for(var r=0,i=i=o;!(r>=i.length);){var a=i[r++];a.isFile?a.file((function(t){if(!n.options.ignoreHiddenFiles||"."!==t.name.substring(0,1))return t.fullPath=e+"/"+t.name,n.addFile(t)})):a.isDirectory&&n._addFilesFromDirectory(a,e+"/"+a.name)}t()}return null}),r)}()}},{key:"accept",value:function(t,n){return t.size>1024*this.options.maxFilesize*1024?n(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(t.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):e.isValidFile(t,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(n(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",t)):this.options.accept.call(this,t,n):n(this.options.dictInvalidFileType)}},{key:"addFile",value:function(t){var n=this;return t.upload={uuid:e.uuidv4(),progress:0,total:t.size,bytesSent:0,filename:this._renameFile(t),chunked:this.options.chunking&&(this.options.forceChunking||t.size>this.options.chunkSize),totalChunkCount:Math.ceil(t.size/this.options.chunkSize)},this.files.push(t),t.status=e.ADDED,this.emit("addedfile",t),this._enqueueThumbnail(t),this.accept(t,(function(e){return e?(t.accepted=!1,n._errorProcessing([t],e)):(t.accepted=!0,n.options.autoQueue&&n.enqueueFile(t)),n._updateMaxFilesReachedClass()}))}},{key:"enqueueFiles",value:function(t){for(var e=0,n=n=t;!(e>=n.length);){var o=n[e++];this.enqueueFile(o)}return null}},{key:"enqueueFile",value:function(t){var n=this;if(n.emit("fileenqueued"),t.status!==e.ADDED||!0!==t.accepted)throw new Error("This file can't be queued because it has already been processed or was rejected.");if(t.status=e.QUEUED,this.options.autoProcessQueue)return setTimeout((function(){return n.processQueue()}),0)}},{key:"_enqueueThumbnail",value:function(t){var e=this;if(this.options.createImageThumbnails&&t.type.match(/image.*/)&&t.size<=1024*this.options.maxThumbnailFilesize*1024)return this._thumbnailQueue.push(t),setTimeout((function(){return e._processThumbnailQueue()}),0)}},{key:"_processThumbnailQueue",value:function(){var t=this;if(!this._processingThumbnail&&0!==this._thumbnailQueue.length){this._processingThumbnail=!0;var e=this._thumbnailQueue.shift();return this.createThumbnail(e,this.options.thumbnailWidth,this.options.thumbnailHeight,this.options.thumbnailMethod,!0,(function(n){return t.emit("thumbnail",e,n),t._processingThumbnail=!1,t._processThumbnailQueue()}))}}},{key:"removeFile",value:function(t){if(t.status===e.UPLOADING&&this.cancelUpload(t),this.files=u(this.files,t),this.emit("removedfile",t),0===this.files.length)return this.emit("reset")}},{key:"removeAllFiles",value:function(t){null==t&&(t=!1);for(var n=0,o=o=this.files.slice();!(n>=o.length);){var r=o[n++];(r.status!==e.UPLOADING||t)&&this.removeFile(r)}return null}},{key:"resizeImage",value:function(t,n,o,r,i){var a=this;return this.createThumbnail(t,n,o,r,!1,(function(n,o){if(null===o)return i(t);var r=a.options.resizeMimeType;null==r&&(r=t.type);var s=o.toDataURL(r,a.options.resizeQuality);return"image/jpeg"!==r&&"image/jpg"!==r||(s=p.restore(t.dataURL,s)),i(e.dataURItoBlob(s))}))}},{key:"createThumbnail",value:function(t,e,n,o,r,i){var a=this,s=new FileReader;return s.onload=function(){if(t.dataURL=s.result,"image/svg+xml"!==t.type)return a.createThumbnailFromUrl(t,e,n,o,r,i);null!=i&&i(s.result)},s.readAsDataURL(t)}},{key:"createThumbnailFromUrl",value:function(t,e,n,o,r,i,a){var s=this,l=document.createElement("img");return a&&(l.crossOrigin=a),l.onload=function(){var a=function(t){return t(1)};return"undefined"!=typeof EXIF&&null!==EXIF&&r&&(a=function(t){return EXIF.getData(l,(function(){return t(EXIF.getTag(this,"Orientation"))}))}),a((function(r){t.width=l.width,t.height=l.height;var a=s.options.resize.call(s,t,e,n,o),u=document.createElement("canvas"),c=u.getContext("2d");switch(u.width=a.trgWidth,u.height=a.trgHeight,r>4&&(u.width=a.trgHeight,u.height=a.trgWidth),r){case 2:c.translate(u.width,0),c.scale(-1,1);break;case 3:c.translate(u.width,u.height),c.rotate(Math.PI);break;case 4:c.translate(0,u.height),c.scale(1,-1);break;case 5:c.rotate(.5*Math.PI),c.scale(1,-1);break;case 6:c.rotate(.5*Math.PI),c.translate(0,-u.height);break;case 7:c.rotate(.5*Math.PI),c.translate(u.width,-u.height),c.scale(-1,1);break;case 8:c.rotate(-.5*Math.PI),c.translate(-u.width,0)}h(c,l,null!=a.srcX?a.srcX:0,null!=a.srcY?a.srcY:0,a.srcWidth,a.srcHeight,null!=a.trgX?a.trgX:0,null!=a.trgY?a.trgY:0,a.trgWidth,a.trgHeight);var p=u.toDataURL("image/png");if(null!=i)return i(p,u)}))},null!=i&&(l.onerror=i),l.src=t.dataURL}},{key:"processQueue",value:function(){var t=this.options.parallelUploads,e=this.getUploadingFiles().length,n=e;if(!(e>=t)){var o=this.getQueuedFiles();if(o.length>0){if(this.options.uploadMultiple)return this.processFiles(o.slice(0,t-e));for(;n<t;){if(!o.length)return;this.processFile(o.shift()),n++}}}}},{key:"processFile",value:function(t){return this.processFiles([t])}},{key:"processFiles",value:function(t){for(var n=0,o=o=t;!(n>=o.length);){var r=o[n++];r.processing=!0,r.status=e.UPLOADING,this.emit("processing",r)}return this.options.uploadMultiple&&this.emit("processingmultiple",t),this.uploadFiles(t)}},{key:"_getFilesWithXhr",value:function(t){return this.files.filter((function(e){return e.xhr===t})).map((function(t){return t}))}},{key:"cancelUpload",value:function(t){if(void 0!==t){if(t.status===e.UPLOADING){for(var n=this._getFilesWithXhr(t.xhr),o=0,r=r=n;!(o>=r.length);)r[o++].status=e.CANCELED;void 0!==t.xhr&&t.xhr.abort();for(var i=0,a=a=n;!(i>=a.length);){var s=a[i++];this.emit("canceled",s)}this.options.uploadMultiple&&this.emit("canceledmultiple",n)}else t.status!==e.ADDED&&t.status!==e.QUEUED||(t.status=e.CANCELED,this.emit("canceled",t),this.options.uploadMultiple&&this.emit("canceledmultiple",[t]));return this.options.autoProcessQueue?this.processQueue():void 0}}},{key:"resolveOption",value:function(t){if("function"==typeof t){for(var e=arguments.length,n=Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return t.apply(this,n)}return t}},{key:"uploadFile",value:function(t){return this.uploadFiles([t])}},{key:"uploadFiles",value:function(t){var n=this;this._transformFiles(t,(function(o){if(t[0].upload.chunked){var r=t[0],i=o[0];r.upload.chunks=[];var a=function(){for(var o=0;void 0!==r.upload.chunks[o];)o++;if(!(o>=r.upload.totalChunkCount)){var a=o*n.options.chunkSize,s=Math.min(a+n.options.chunkSize,r.size),l={name:n._getParamName(0),data:i.webkitSlice?i.webkitSlice(a,s):i.slice(a,s),filename:r.upload.filename,chunkIndex:o};r.upload.chunks[o]={file:r,index:o,dataBlock:l,status:e.UPLOADING,progress:0,retries:0},n._uploadData(t,[l])}};if(r.upload.finishedChunkUpload=function(o){var i=!0;o.status=e.SUCCESS,o.dataBlock=null;for(var s=0;s<r.upload.totalChunkCount;s++){if(void 0===r.upload.chunks[s])return a();r.upload.chunks[s].status!==e.SUCCESS&&(i=!1)}i&&n.options.chunksUploaded(r,(function(){n._finished(t,"",null)}))},n.options.parallelChunkUploads)for(var s=0;s<r.upload.totalChunkCount;s++)a();else a()}else{for(var l=[],u=0;u<t.length;u++)l[u]={name:n._getParamName(u),data:o[u],filename:t[u].upload.filename};n._uploadData(t,l)}}))}},{key:"_getChunk",value:function(t,e){for(var n=0;n<t.upload.totalChunkCount;n++)if(void 0!==t.upload.chunks[n]&&t.upload.chunks[n].xhr===e)return t.upload.chunks[n]}},{key:"_uploadData",value:function(t,n){for(var o=this,r=new XMLHttpRequest,i=0,a=a=t;!(i>=a.length);)a[i++].xhr=r;t[0].upload.chunked&&(t[0].upload.chunks[n[0].chunkIndex].xhr=r);var s=this.resolveOption(this.options.method,t),l=this.resolveOption(this.options.url,t);r.open(s,l,!0),r.timeout=this.resolveOption(this.options.timeout,t),r.withCredentials=!!this.options.withCredentials,r.onload=function(e){o._finishedUploading(t,r,e)},r.onerror=function(){o._handleUploadError(t,r)},(null!=r.upload?r.upload:r).onprogress=function(e){return o._updateFilesUploadProgress(t,r,e)};var u={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};for(var c in this.options.headers&&e.extend(u,this.options.headers),u){var h=u[c];h&&r.setRequestHeader(c,h)}var p=new FormData;if(this.options.params){var f=this.options.params;for(var d in"function"==typeof f&&(f=f.call(this,t,r,t[0].upload.chunked?this._getChunk(t[0],r):null)),f){var m=f[d];p.append(d,m)}}for(var y=0,g=g=t;!(y>=g.length);){var v=g[y++];this.emit("sending",v,r,p)}this.options.uploadMultiple&&this.emit("sendingmultiple",t,r,p),this._addFormElementData(p);for(var b=0;b<n.length;b++){var _=n[b];p.append(_.name,_.data,_.filename)}this.submitRequest(r,p,t)}},{key:"_transformFiles",value:function(t,e){var n=this,o=[],r=0;n.emit("transformstart",t),function i(a){t[a]&&n.options.transformFile.call(n,t[a],(function(s){o[a]=s,n.emit("transformcompleted",t[a],r+1),++r===t.length?(n.emit("transformend",t),e(o)):i(a+1)}))}(0)}},{key:"_addFormElementData",value:function(t){if("FORM"===this.element.tagName)for(var e=0,n=n=this.element.querySelectorAll("input, textarea, select, button");!(e>=n.length);){var o=n[e++],r=o.getAttribute("name"),i=o.getAttribute("type");if(i&&(i=i.toLowerCase()),null!=r)if("SELECT"===o.tagName&&o.hasAttribute("multiple"))for(var a=0,s=s=o.options;!(a>=s.length);){var l=s[a++];l.selected&&t.append(r,l.value)}else(!i||"checkbox"!==i&&"radio"!==i||o.checked)&&t.append(r,o.value)}}},{key:"_updateFilesUploadProgress",value:function(t,e,n){var o=void 0;if(void 0!==n){if(o=100*n.loaded/n.total,t[0].upload.chunked){var r=t[0],i=this._getChunk(r,e);i.progress=o,i.total=n.total,i.bytesSent=n.loaded,r.upload.progress=0,r.upload.total=0,r.upload.bytesSent=0;for(var a=0;a<r.upload.totalChunkCount;a++)void 0!==r.upload.chunks[a]&&void 0!==r.upload.chunks[a].progress&&(r.upload.progress+=r.upload.chunks[a].progress,r.upload.total+=r.upload.chunks[a].total,r.upload.bytesSent+=r.upload.chunks[a].bytesSent);r.upload.progress=r.upload.progress/r.upload.totalChunkCount}else for(var s=0,l=l=t;!(s>=l.length);){var u=l[s++];u.upload.progress=o,u.upload.total=n.total,u.upload.bytesSent=n.loaded}for(var c=0,h=h=t;!(c>=h.length);){var p=h[c++];this.emit("uploadprogress",p,p.upload.progress,p.upload.bytesSent)}}else{var f=!0;o=100;for(var d=0,m=m=t;!(d>=m.length);){var y=m[d++];100===y.upload.progress&&y.upload.bytesSent===y.upload.total||(f=!1),y.upload.progress=o,y.upload.bytesSent=y.upload.total}if(f)return;for(var g=0,v=v=t;!(g>=v.length);){var b=v[g++];this.emit("uploadprogress",b,o,b.upload.bytesSent)}}}},{key:"_finishedUploading",value:function(t,n,o){var r=void 0;if(t[0].status!==e.CANCELED&&4===n.readyState){if("arraybuffer"!==n.responseType&&"blob"!==n.responseType&&(r=n.responseText,n.getResponseHeader("content-type")&&~n.getResponseHeader("content-type").indexOf("application/json")))try{r=JSON.parse(r)}catch(t){o=t,r="Invalid JSON response from server."}this._updateFilesUploadProgress(t),200<=n.status&&n.status<300?t[0].upload.chunked?t[0].upload.finishedChunkUpload(this._getChunk(t[0],n)):this._finished(t,r,o):this._handleUploadError(t,n,r)}}},{key:"_handleUploadError",value:function(t,n,o){if(t[0].status!==e.CANCELED){if(t[0].upload.chunked&&this.options.retryChunks){var r=this._getChunk(t[0],n);if(r.retries++<this.options.retryChunksLimit)return void this._uploadData(t,[r.dataBlock]);console.warn("Retried this chunk too often. Giving up.")}for(var i=0,a=a=t;!(i>=a.length);)a[i++],this._errorProcessing(t,o||this.options.dictResponseError.replace("{{statusCode}}",n.status),n)}}},{key:"submitRequest",value:function(t,e,n){t.send(e)}},{key:"_finished",value:function(t,n,o){for(var r=0,i=i=t;!(r>=i.length);){var a=i[r++];a.status=e.SUCCESS,this.emit("success",a,n,o),this.emit("complete",a)}if(this.options.uploadMultiple&&(this.emit("successmultiple",t,n,o),this.emit("completemultiple",t)),this.options.autoProcessQueue)return this.processQueue()}},{key:"_errorProcessing",value:function(t,n,o){for(var r=0,i=i=t;!(r>=i.length);){var a=i[r++];a.status=e.ERROR,this.emit("error",a,n,o),this.emit("complete",a)}if(this.options.uploadMultiple&&(this.emit("errormultiple",t,n,o),this.emit("completemultiple",t)),this.options.autoProcessQueue)return this.processQueue()}}],[{key:"uuidv4",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}}]),e}(s);l.initClass(),l.version="5.2.0",l.options={},l.optionsForElement=function(t){return t.getAttribute("id")?l.options[c(t.getAttribute("id"))]:void 0},l.instances=[],l.forElement=function(t){if("string"==typeof t&&(t=document.querySelector(t)),null==(null!=t?t.dropzone:void 0))throw new Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");return t.dropzone},l.autoDiscover=!0,l.discover=function(){var t=void 0;if(document.querySelectorAll)t=document.querySelectorAll(".dropzone");else{t=[];var e=function(e){return function(){for(var n=[],o=0,r=r=e;!(o>=r.length);){var i=r[o++];/(^| )dropzone($| )/.test(i.className)?n.push(t.push(i)):n.push(void 0)}return n}()};e(document.getElementsByTagName("div")),e(document.getElementsByTagName("form"))}return function(){for(var e=[],n=0,o=o=t;!(n>=o.length);){var r=o[n++];!1!==l.optionsForElement(r)?e.push(new l(r)):e.push(void 0)}return e}()},l.blacklistedBrowsers=[/opera.*(Macintosh|Windows Phone).*version\/12/i],l.isBrowserSupported=function(){var t=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(var e=0,n=n=l.blacklistedBrowsers;!(e>=n.length);)n[e++].test(navigator.userAgent)&&(t=!1);else t=!1;else t=!1;return t},l.dataURItoBlob=function(t){for(var e=atob(t.split(",")[1]),n=t.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(e.length),r=new Uint8Array(o),i=0,a=e.length,s=0<=a;s?i<=a:i>=a;s?i++:i--)r[i]=e.charCodeAt(i);return new Blob([o],{type:n})};var u=function(t,e){return t.filter((function(t){return t!==e})).map((function(t){return t}))},c=function(t){return t.replace(/[\-_](\w)/g,(function(t){return t.charAt(1).toUpperCase()}))};l.createElement=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes[0]},l.elementInside=function(t,e){if(t===e)return!0;for(;t=t.parentNode;)if(t===e)return!0;return!1},l.getElement=function(t,e){var n=void 0;if("string"==typeof t?n=document.querySelector(t):null!=t.nodeType&&(n=t),null==n)throw new Error("Invalid `"+e+"` option provided. Please provide a CSS selector or a plain HTML element.");return n},l.getElements=function(t,e){var n=void 0,o=void 0;if(t instanceof Array){o=[];try{for(var r=0,i=i=t;!(r>=i.length);)n=i[r++],o.push(this.getElement(n,e))}catch(t){o=null}}else if("string"==typeof t){o=[];for(var a=0,s=s=document.querySelectorAll(t);!(a>=s.length);)n=s[a++],o.push(n)}else null!=t.nodeType&&(o=[t]);if(null==o||!o.length)throw new Error("Invalid `"+e+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return o},l.confirm=function(t,e,n){return window.confirm(t)?e():null!=n?n():void 0},l.isValidFile=function(t,e){if(!e)return!0;e=e.split(",");for(var n=t.type,o=n.replace(/\/.*$/,""),r=0,i=i=e;!(r>=i.length);){var a=i[r++];if("."===(a=a.trim()).charAt(0)){if(-1!==t.name.toLowerCase().indexOf(a.toLowerCase(),t.name.length-a.length))return!0}else if(/\/\*$/.test(a)){if(o===a.replace(/\/.*$/,""))return!0}else if(n===a)return!0}return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(t){return this.each((function(){return new l(this,t)}))}),null!==t?t.exports=l:window.Dropzone=l,l.ADDED="added",l.QUEUED="queued",l.ACCEPTED=l.QUEUED,l.UPLOADING="uploading",l.PROCESSING=l.UPLOADING,l.CANCELED="canceled",l.ERROR="error",l.SUCCESS="success";var h=function(t,e,n,o,r,i,a,s,l,u){var c=function(t){t.naturalWidth;var e=t.naturalHeight,n=document.createElement("canvas");n.width=1,n.height=e;var o=n.getContext("2d");o.drawImage(t,0,0);for(var r=o.getImageData(1,0,1,e).data,i=0,a=e,s=e;s>i;)0===r[4*(s-1)+3]?a=s:i=s,s=a+i>>1;var l=s/e;return 0===l?1:l}(e);return t.drawImage(e,n,o,r,i,a,s,l,u/c)},p=function(){function t(){a(this,t)}return r(t,null,[{key:"initClass",value:function(){this.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}},{key:"encode64",value:function(t){for(var e="",n=void 0,o=void 0,r="",i=void 0,a=void 0,s=void 0,l="",u=0;i=(n=t[u++])>>2,a=(3&n)<<4|(o=t[u++])>>4,s=(15&o)<<2|(r=t[u++])>>6,l=63&r,isNaN(o)?s=l=64:isNaN(r)&&(l=64),e=e+this.KEY_STR.charAt(i)+this.KEY_STR.charAt(a)+this.KEY_STR.charAt(s)+this.KEY_STR.charAt(l),n=o=r="",i=a=s=l="",u<t.length;);return e}},{key:"restore",value:function(t,e){if(!t.match("data:image/jpeg;base64,"))return e;var n=this.decode64(t.replace("data:image/jpeg;base64,","")),o=this.slice2Segments(n),r=this.exifManipulation(e,o);return"data:image/jpeg;base64,"+this.encode64(r)}},{key:"exifManipulation",value:function(t,e){var n=this.getExifArray(e),o=this.insertExif(t,n);return new Uint8Array(o)}},{key:"getExifArray",value:function(t){for(var e=void 0,n=0;n<t.length;){if(255===(e=t[n])[0]&225===e[1])return e;n++}return[]}},{key:"insertExif",value:function(t,e){var n=t.replace("data:image/jpeg;base64,",""),o=this.decode64(n),r=o.indexOf(255,3),i=o.slice(0,r),a=o.slice(r),s=i;return(s=s.concat(e)).concat(a)}},{key:"slice2Segments",value:function(t){for(var e=0,n=[];!(255===t[e]&218===t[e+1]);){if(255===t[e]&216===t[e+1])e+=2;else{var o=e+(256*t[e+2]+t[e+3])+2,r=t.slice(e,o);n.push(r),e=o}if(e>t.length)break}return n}},{key:"decode64",value:function(t){var e=void 0,n=void 0,o="",r=void 0,i=void 0,a="",s=0,l=[];for(/[^A-Za-z0-9\+\/\=]/g.exec(t)&&console.warn("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");e=this.KEY_STR.indexOf(t.charAt(s++))<<2|(r=this.KEY_STR.indexOf(t.charAt(s++)))>>4,n=(15&r)<<4|(i=this.KEY_STR.indexOf(t.charAt(s++)))>>2,o=(3&i)<<6|(a=this.KEY_STR.indexOf(t.charAt(s++))),l.push(e),64!==i&&l.push(n),64!==a&&l.push(o),e=n=o="",r=i=a="",s<t.length;);return l}}]),t}();p.initClass(),l._autoDiscoverFunction=function(){if(l.autoDiscover)return l.discover()},function(t,e){var n=!1,o=!0,r=t.document,i=r.documentElement,a=r.addEventListener?"addEventListener":"attachEvent",s=r.addEventListener?"removeEventListener":"detachEvent",l=r.addEventListener?"":"on",u=function o(i){if("readystatechange"!==i.type||"complete"===r.readyState)return("load"===i.type?t:r)[s](l+i.type,o,!1),!n&&(n=!0)?e.call(t,i.type||i):void 0};if("complete"!==r.readyState){if(r.createEventObject&&i.doScroll){try{o=!t.frameElement}catch(t){}o&&function t(){try{i.doScroll("left")}catch(e){return void setTimeout(t,50)}return u("poll")}()}r[a](l+"DOMContentLoaded",u,!1),r[a](l+"readystatechange",u,!1),t[a](l+"load",u,!1)}}(window,l._autoDiscoverFunction)},3705:(t,e,n)=>{t.exports=n(9797)},5808:()=>{window.PR_SHOULD_USE_CONTINUATION=!0,function(){function t(t,e,n,o,r){n&&(o(t={h:t,l:1,j:null,m:null,a:n,c:null,i:e,g:null}),r.push.apply(r,t.g))}function e(t){for(var e=void 0,n=t.firstChild;n;n=n.nextSibling){var o=n.nodeType;e=1===o?e?t:n:3===o&&y.test(n.nodeValue)?t:e}return e===t?void 0:e}function n(e,n){var o,r={};!function(){for(var t=e.concat(n),i=[],a={},s=0,l=t.length;s<l;++s){var u=t[s],c=u[3];if(c)for(var h=c.length;0<=--h;)r[c.charAt(h)]=u;c=""+(u=u[1]),a.hasOwnProperty(c)||(i.push(u),a[c]=null)}i.push(/[\0-\uffff]/),o=function(t){function e(t){var e=t.charCodeAt(0);if(92!==e)return e;var n=t.charAt(1);return(e=h[n])?e:"0"<=n&&"7">=n?parseInt(t.substring(1),8):"u"===n||"x"===n?parseInt(t.substring(2),16):t.charCodeAt(1)}function n(t){return 32>t?(16>t?"\\x0":"\\x")+t.toString(16):"\\"===(t=String.fromCharCode(t))||"-"===t||"]"===t||"^"===t?"\\"+t:t}function o(t){var o=t.substring(1,t.length-1).match(/\\u[0-9A-Fa-f]{4}|\\x[0-9A-Fa-f]{2}|\\[0-3][0-7]{0,2}|\\[0-7]{1,2}|\\[\s\S]|-|[^-\\]/g);t=[];var r=["["];(i="^"===o[0])&&r.push("^");for(var i=i?1:0,a=o.length;i<a;++i){var s,l=o[i];/\\[bdsw]/i.test(l)?r.push(l):(l=e(l),i+2<a&&"-"===o[i+1]?(s=e(o[i+2]),i+=2):s=l,t.push([l,s]),65>s||122<l||(65>s||90<l||t.push([32|Math.max(65,l),32|Math.min(s,90)]),97>s||122<l||t.push([-33&Math.max(97,l),-33&Math.min(s,122)])))}for(t.sort((function(t,e){return t[0]-e[0]||e[1]-t[1]})),o=[],a=[],i=0;i<t.length;++i)(l=t[i])[0]<=a[1]+1?a[1]=Math.max(a[1],l[1]):o.push(a=l);for(i=0;i<o.length;++i)l=o[i],r.push(n(l[0])),l[1]>l[0]&&(l[1]+1>l[0]&&r.push("-"),r.push(n(l[1])));return r.push("]"),r.join("")}function r(t){for(var e=t.source.match(/(?:\[(?:[^\x5C\x5D]|\\[\s\S])*\]|\\u[A-Fa-f0-9]{4}|\\x[A-Fa-f0-9]{2}|\\[0-9]+|\\[^ux0-9]|\(\?[:!=]|[\(\)\^]|[^\x5B\x5C\(\)\^]+)/g),r=e.length,s=[],l=0,u=0;l<r;++l){var c=e[l];"("===c?++u:"\\"===c.charAt(0)&&(c=+c.substring(1))&&(c<=u?s[c]=-1:e[l]=n(c))}for(l=1;l<s.length;++l)-1===s[l]&&(s[l]=++i);for(u=l=0;l<r;++l)"("===(c=e[l])?s[++u]||(e[l]="(?:"):"\\"===c.charAt(0)&&(c=+c.substring(1))&&c<=u&&(e[l]="\\"+s[c]);for(l=0;l<r;++l)"^"===e[l]&&"^"!==e[l+1]&&(e[l]="");if(t.ignoreCase&&a)for(l=0;l<r;++l)t=(c=e[l]).charAt(0),2<=c.length&&"["===t?e[l]=o(c):"\\"!==t&&(e[l]=c.replace(/[a-zA-Z]/g,(function(t){return t=t.charCodeAt(0),"["+String.fromCharCode(-33&t,32|t)+"]"})));return e.join("")}for(var i=0,a=!1,s=!1,l=0,u=t.length;l<u;++l){var c=t[l];if(c.ignoreCase)s=!0;else if(/[a-z]/i.test(c.source.replace(/\\u[0-9a-f]{4}|\\x[0-9a-f]{2}|\\[^ux]/gi,""))){a=!0,s=!1;break}}var h={b:8,t:9,n:10,v:11,f:12,r:13},p=[];for(l=0,u=t.length;l<u;++l){if((c=t[l]).global||c.multiline)throw Error(""+c);p.push("(?:"+r(c)+")")}return new RegExp(p.join("|"),s?"gi":"g")}(i)}();var i=n.length;return function e(s){for(var l=s.i,u=s.h,c=[l,"pln"],h=0,p=s.a.match(o)||[],f={},d=0,m=p.length;d<m;++d){var y,g=p[d],v=f[g],b=void 0;if("string"==typeof v)y=!1;else{var _=r[g.charAt(0)];if(_)b=g.match(_[1]),v=_[0];else{for(y=0;y<i;++y)if(_=n[y],b=g.match(_[1])){v=_[0];break}b||(v="pln")}!(y=5<=v.length&&"lang-"===v.substring(0,5))||b&&"string"==typeof b[1]||(y=!1,v="src"),y||(f[g]=v)}if(_=h,h+=g.length,y){y=b[1];var w=g.indexOf(y),E=w+y.length;b[2]&&(w=(E=g.length-b[2].length)-y.length),v=v.substring(5),t(u,l+_,g.substring(0,w),e,c),t(u,l+_+w,y,a(v,y),c),t(u,l+_+E,g.substring(E),e,c)}else c.push(l+_,v)}s.g=c}}function o(t){var e=[],o=[];t.tripleQuotedStrings?e.push(["str",/^(?:\'\'\'(?:[^\'\\]|\\[\s\S]|\'{1,2}(?=[^\']))*(?:\'\'\'|$)|\"\"\"(?:[^\"\\]|\\[\s\S]|\"{1,2}(?=[^\"]))*(?:\"\"\"|$)|\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$))/,null,"'\""]):t.multiLineStrings?e.push(["str",/^(?:\'(?:[^\\\']|\\[\s\S])*(?:\'|$)|\"(?:[^\\\"]|\\[\s\S])*(?:\"|$)|\`(?:[^\\\`]|\\[\s\S])*(?:\`|$))/,null,"'\"`"]):e.push(["str",/^(?:\'(?:[^\\\'\r\n]|\\.)*(?:\'|$)|\"(?:[^\\\"\r\n]|\\.)*(?:\"|$))/,null,"\"'"]),t.verbatimStrings&&o.push(["str",/^@\"(?:[^\"]|\"\")*(?:\"|$)/,null]);var r=t.hashComments;if(r&&(t.cStyleComments?(1<r?e.push(["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,null,"#"]):e.push(["com",/^#(?:(?:define|e(?:l|nd)if|else|error|ifn?def|include|line|pragma|undef|warning)\b|[^\r\n]*)/,null,"#"]),o.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h(?:h|pp|\+\+)?|[a-z]\w*)>/,null])):e.push(["com",/^#[^\r\n]*/,null,"#"])),t.cStyleComments&&(o.push(["com",/^\/\/[^\r\n]*/,null]),o.push(["com",/^\/\*[\s\S]*?(?:\*\/|$)/,null])),r=t.regexLiterals){var i=(r=1<r?"":"\n\r")?".":"[\\S\\s]";o.push(["lang-regex",RegExp("^(?:^^\\.?|[+-]|[!=]=?=?|\\#|%=?|&&?=?|\\(|\\*=?|[+\\-]=|->|\\/=?|::?|<<?=?|>>?>?=?|,|;|\\?|@|\\[|~|{|\\^\\^?=?|\\|\\|?=?|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\\s*(/(?=[^/*"+r+"])(?:[^/\\x5B\\x5C"+r+"]|\\x5C"+i+"|\\x5B(?:[^\\x5C\\x5D"+r+"]|\\x5C"+i+")*(?:\\x5D|$))+/)")])}return(r=t.types)&&o.push(["typ",r]),(r=(""+t.keywords).replace(/^ | $/g,"")).length&&o.push(["kwd",new RegExp("^(?:"+r.replace(/[\s,]+/g,"|")+")\\b"),null]),e.push(["pln",/^\s+/,null," \r\n\t"]),r="^.[^\\s\\w.$@'\"`/\\\\]*",t.regexLiterals&&(r+="(?!s*/)"),o.push(["lit",/^@[a-z_$][a-z_$@0-9]*/i,null],["typ",/^(?:[@_]?[A-Z]+[a-z][A-Za-z_$@0-9]*|\w+_t\b)/,null],["pln",/^[a-z_$][a-z_$@0-9]*/i,null],["lit",/^(?:0x[a-f0-9]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+\-]?\d+)?)[a-z]*/i,null,"0123456789"],["pln",/^\\[\s\S]?/,null],["pun",new RegExp(r),null]),n(e,o)}function r(t,e,n){function o(t){var e=t.nodeType;if(1!=e||i.test(t.className)){if((3==e||4==e)&&n){var l=t.nodeValue,u=l.match(a);u&&(e=l.substring(0,u.index),t.nodeValue=e,(l=l.substring(u.index+u[0].length))&&t.parentNode.insertBefore(s.createTextNode(l),t.nextSibling),r(t),e||t.parentNode.removeChild(t))}}else if("br"===t.nodeName)r(t),t.parentNode&&t.parentNode.removeChild(t);else for(t=t.firstChild;t;t=t.nextSibling)o(t)}function r(t){for(;!t.nextSibling;)if(!(t=t.parentNode))return;t=function t(e,n){var o=n?e.cloneNode(!1):e;if(r=e.parentNode){var r=t(r,1),i=e.nextSibling;r.appendChild(o);for(var a=i;a;a=i)i=a.nextSibling,r.appendChild(a)}return o}(t.nextSibling,0);for(var e;(e=t.parentNode)&&1===e.nodeType;)t=e;u.push(t)}for(var i=/(?:^|\s)nocode(?:\s|$)/,a=/\r\n?|\n/,s=t.ownerDocument,l=s.createElement("li");t.firstChild;)l.appendChild(t.firstChild);for(var u=[l],c=0;c<u.length;++c)o(u[c]);e===(0|e)&&u[0].setAttribute("value",e);var h=s.createElement("ol");h.className="linenums",e=Math.max(0,e-1|0)||0,c=0;for(var p=u.length;c<p;++c)(l=u[c]).className="L"+(c+e)%10,l.firstChild||l.appendChild(s.createTextNode("")),h.appendChild(l);t.appendChild(h)}function i(t,e){for(var n=e.length;0<=--n;){var o=e[n];v.hasOwnProperty(o)?c.console&&console.warn("cannot override language handler %s",o):v[o]=t}}function a(t,e){return t&&v.hasOwnProperty(t)||(t=/^\s*</.test(e)?"default-markup":"default-code"),v[t]}function s(t){var e=t.j;try{var n=function(t,e){var n=/(?:^|\s)nocode(?:\s|$)/,o=[],r=0,i=[],a=0;return function t(s){var l=s.nodeType;if(1==l){if(!n.test(s.className)){for(l=s.firstChild;l;l=l.nextSibling)t(l);"br"!==(l=s.nodeName.toLowerCase())&&"li"!==l||(o[a]="\n",i[a<<1]=r++,i[a++<<1|1]=s)}}else 3!=l&&4!=l||(l=s.nodeValue).length&&(l=e?l.replace(/\r\n?/g,"\n"):l.replace(/[ \t\r\n]+/g," "),o[a]=l,i[a<<1]=r,r+=l.length,i[a++<<1|1]=s)}(t),{a:o.join("").replace(/\n$/,""),c:i}}(t.h,t.l),o=n.a;t.a=o,t.c=n.c,t.i=0,a(e,o)(t);var r,i,s=(s=/\bMSIE\s(\d+)/.exec(navigator.userAgent))&&8>=+s[1],l=(e=/\n/g,t.a),u=l.length,h=(n=0,t.c),p=h.length,f=(o=0,t.g),d=f.length,m=0;for(f[d]=u,i=r=0;i<d;)f[i]!==f[i+2]?(f[r++]=f[i++],f[r++]=f[i++]):i+=2;for(d=r,i=r=0;i<d;){for(var y=f[i],g=f[i+1],v=i+2;v+2<=d&&f[v+1]===g;)v+=2;f[r++]=y,f[r++]=g,i=v}f.length=r;var b=t.h;t="",b&&(t=b.style.display,b.style.display="none");try{for(;o<p;){var _,w=h[o+2]||u,E=f[m+2]||u,k=(v=Math.min(w,E),h[o+1]);if(1!==k.nodeType&&(_=l.substring(n,v))){s&&(_=_.replace(e,"\r")),k.nodeValue=_;var S=k.ownerDocument,x=S.createElement("span");x.className=f[m+1];var P=k.parentNode;P.replaceChild(x,k),x.appendChild(k),n<w&&(h[o+1]=k=S.createTextNode(l.substring(v,w)),P.insertBefore(k,x.nextSibling))}(n=v)>=w&&(o+=2),n>=E&&(m+=2)}}finally{b&&(b.style.display=t)}}catch(t){c.console&&console.log(t&&t.stack||t)}}var l,u,c=window,h=[l=[[u=["break,continue,do,else,for,if,return,while"],"auto,case,char,const,default,double,enum,extern,float,goto,inline,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],"abstract,assert,boolean,byte,extends,finally,final,implements,import,instanceof,interface,null,native,package,strictfp,super,synchronized,throws,transient"],p=[l,"abstract,as,base,bool,by,byte,checked,decimal,delegate,descending,dynamic,event,finally,fixed,foreach,from,group,implicit,in,interface,internal,into,is,let,lock,null,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var,virtual,where"],f=[u,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"],d=[u,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],m=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)\b/,y=/\S/,g=o({keywords:[b=[l,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,delegate,dynamic_cast,explicit,export,friend,generic,late_check,mutable,namespace,nullptr,property,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],p,h,l=[l,"debugger,eval,export,function,get,instanceof,null,set,undefined,var,with,Infinity,NaN"],"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",f,d,u=[u,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"]],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),v={};i(g,["default-code"]),i(n([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\s\S]*?(?:-\->|$)/],["lang-",/^<\?([\s\S]+?)(?:\?>|$)/],["lang-",/^<%([\s\S]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\s\S]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\s\S]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\s\S]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),"default-markup htm html mxml xhtml xml xsl".split(" ")),i(n([["pln",/^[\s]+/,null," \t\r\n"],["atv",/^(?:\"[^\"]*\"?|\'[^\']*\'?)/,null,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w.:-]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^>\'\"\s]*(?:[^>\'\"\s\/]|\/(?=\s)))/],["pun",/^[=<>\/]+/],["lang-js",/^on\w+\s*=\s*\"([^\"]+)\"/i],["lang-js",/^on\w+\s*=\s*\'([^\']+)\'/i],["lang-js",/^on\w+\s*=\s*([^\"\'>\s]+)/i],["lang-css",/^style\s*=\s*\"([^\"]+)\"/i],["lang-css",/^style\s*=\s*\'([^\']+)\'/i],["lang-css",/^style\s*=\s*([^\"\'>\s]+)/i]]),["in.tag"]),i(n([],[["atv",/^[\s\S]+/]]),["uq.val"]),i(o({keywords:b,hashComments:!0,cStyleComments:!0,types:m}),"c cc cpp cxx cyc m".split(" ")),i(o({keywords:"null,true,false"}),["json"]),i(o({keywords:p,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:m}),["cs"]),i(o({keywords:h,cStyleComments:!0}),["java"]),i(o({keywords:u,hashComments:!0,multiLineStrings:!0}),["bash","bsh","csh","sh"]),i(o({keywords:f,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py","python"]),i(o({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",hashComments:!0,multiLineStrings:!0,regexLiterals:2}),["perl","pl","pm"]),i(o({keywords:d,hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb","ruby"]),i(o({keywords:l,cStyleComments:!0,regexLiterals:!0}),["javascript","js"]),i(o({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,throw,true,try,unless,until,when,while,yes",hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),["coffee"]),i(n([],[["str",/^[\s\S]+/]]),["regex"]);var b,_=c.PR={createSimpleLexer:n,registerLangHandler:i,sourceDecorator:o,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ",prettyPrintOne:c.prettyPrintOne=function(t,e,n){n=n||!1,e=e||null;var o=document.createElement("div");return o.innerHTML="<pre>"+t+"</pre>",o=o.firstChild,n&&r(o,n,!0),s({j:e,m:n,h:o,l:1,a:null,i:null,c:null,g:null}),o.innerHTML},prettyPrint:c.prettyPrint=function(t,n){for(var o=(i=n||document.body).ownerDocument||document,i=[i.getElementsByTagName("pre"),i.getElementsByTagName("code"),i.getElementsByTagName("xmp")],a=[],l=0;l<i.length;++l)for(var u=0,h=i[l].length;u<h;++u)a.push(i[l][u]);i=null;var p=Date;p.now||(p={now:function(){return+new Date}});var f=0,d=/\blang(?:uage)?-([\w.]+)(?!\S)/,m=/\bprettyprint\b/,y=/\bprettyprinted\b/,g=/pre|xmp/i,v=/^code$/i,b=/^(?:pre|code|xmp)$/i,_={};!function n(){for(var i=c.PR_SHOULD_USE_CONTINUATION?p.now()+250:1/0;f<a.length&&p.now()<i;f++){for(var l=a[f],u=_,h=l;(h=h.previousSibling)&&((k=(7===(w=h.nodeType)||8===w)&&h.nodeValue)?/^\??prettify\b/.test(k):3===w&&!/\S/.test(h.nodeValue));)if(k){u={},k.replace(/\b(\w+)=([\w:.%+-]+)/g,(function(t,e,n){u[e]=n}));break}if(h=l.className,(u!==_||m.test(h))&&!y.test(h)){for(w=!1,k=l.parentNode;k;k=k.parentNode)if(b.test(k.tagName)&&k.className&&m.test(k.className)){w=!0;break}if(!w){var w,E;if(l.className+=" prettyprinted",(w=u.lang)||(!(w=h.match(d))&&(E=e(l))&&v.test(E.tagName)&&(w=E.className.match(d)),w&&(w=w[1])),g.test(l.tagName))k=1;else{var k=l.currentStyle,S=o.defaultView;k=(k=k?k.whiteSpace:S&&S.getComputedStyle?S.getComputedStyle(l,null).getPropertyValue("white-space"):0)&&"pre"===k.substring(0,3)}(S="true"===(S=u.linenums)||+S)||(S=!!(S=h.match(/\blinenums\b(?::(\d+))?/))&&(!S[1]||!S[1].length||+S[1])),S&&r(l,S,k),s({j:w,h:l,m:S,l:k,a:null,i:null,c:null,g:null})}}}f<a.length?c.setTimeout(n,250):"function"==typeof t&&t()}()}};"function"==typeof(b=c.define)&&b.amd&&b("google-code-prettify",[],(function(){return _}))}()},7526:(t,e)=>{"use strict";e.byteLength=function(t){var e=s(t),n=e[0],o=e[1];return 3*(n+o)/4-o},e.toByteArray=function(t){var e,n,i=s(t),a=i[0],l=i[1],u=new r(function(t,e,n){return 3*(e+n)/4-n}(0,a,l)),c=0,h=l>0?a-4:a;for(n=0;n<h;n+=4)e=o[t.charCodeAt(n)]<<18|o[t.charCodeAt(n+1)]<<12|o[t.charCodeAt(n+2)]<<6|o[t.charCodeAt(n+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=255&e;return 2===l&&(e=o[t.charCodeAt(n)]<<2|o[t.charCodeAt(n+1)]>>4,u[c++]=255&e),1===l&&(e=o[t.charCodeAt(n)]<<10|o[t.charCodeAt(n+1)]<<4|o[t.charCodeAt(n+2)]>>2,u[c++]=e>>8&255,u[c++]=255&e),u},e.fromByteArray=function(t){for(var e,o=t.length,r=o%3,i=[],a=16383,s=0,u=o-r;s<u;s+=a)i.push(l(t,s,s+a>u?u:s+a));return 1===r?(e=t[o-1],i.push(n[e>>2]+n[e<<4&63]+"==")):2===r&&(e=(t[o-2]<<8)+t[o-1],i.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"=")),i.join("")};for(var n=[],o=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=i[a],o[i.charCodeAt(a)]=a;function s(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,o){for(var r,i,a=[],s=e;s<o;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(n[(i=r)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return a.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},8287:(t,e,n)=>{"use strict";const o=n(7526),r=n(251),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=l,e.INSPECT_MAX_BYTES=50;const a=2147483647;function s(t){if(t>a)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,l.prototype),e}function l(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,n)}function u(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!l.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|m(t,e);let o=s(n);const r=o.write(t,e);return r!==n&&(o=o.slice(0,r)),o}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Y(t,Uint8Array)){const e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return p(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Y(t,ArrayBuffer)||t&&Y(t.buffer,ArrayBuffer))return f(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(Y(t,SharedArrayBuffer)||t&&Y(t.buffer,SharedArrayBuffer)))return f(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const o=t.valueOf&&t.valueOf();if(null!=o&&o!==t)return l.from(o,e,n);const r=function(t){if(l.isBuffer(t)){const e=0|d(t.length),n=s(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||K(t.length)?s(0):p(t):"Buffer"===t.type&&Array.isArray(t.data)?p(t.data):void 0}(t);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return l.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return c(t),s(t<0?0:0|d(t))}function p(t){const e=t.length<0?0:0|d(t.length),n=s(e);for(let o=0;o<e;o+=1)n[o]=255&t[o];return n}function f(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let o;return o=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(o,l.prototype),o}function d(t){if(t>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|t}function m(t,e){if(l.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Y(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,o=arguments.length>2&&!0===arguments[2];if(!o&&0===n)return 0;let r=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(t).length;default:if(r)return o?-1:H(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){let o=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return j(this,e,n);case"utf8":case"utf-8":return P(this,e,n);case"ascii":return O(this,e,n);case"latin1":case"binary":return C(this,e,n);case"base64":return x(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,n);default:if(o)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),o=!0}}function g(t,e,n){const o=t[e];t[e]=t[n],t[n]=o}function v(t,e,n,o,r){if(0===t.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),K(n=+n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=l.from(e,o)),l.isBuffer(e))return 0===e.length?-1:b(t,e,n,o,r);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,o,r);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,o,r){let i,a=1,s=t.length,l=e.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(t.length<2||e.length<2)return-1;a=2,s/=2,l/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(r){let o=-1;for(i=n;i<s;i++)if(u(t,i)===u(e,-1===o?0:i-o)){if(-1===o&&(o=i),i-o+1===l)return o*a}else-1!==o&&(i-=i-o),o=-1}else for(n+l>s&&(n=s-l),i=n;i>=0;i--){let n=!0;for(let o=0;o<l;o++)if(u(t,i+o)!==u(e,o)){n=!1;break}if(n)return i}return-1}function _(t,e,n,o){n=Number(n)||0;const r=t.length-n;o?(o=Number(o))>r&&(o=r):o=r;const i=e.length;let a;for(o>i/2&&(o=i/2),a=0;a<o;++a){const o=parseInt(e.substr(2*a,2),16);if(K(o))return a;t[n+a]=o}return a}function w(t,e,n,o){return G(H(e,t.length-n),t,n,o)}function E(t,e,n,o){return G(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,o)}function k(t,e,n,o){return G(V(e),t,n,o)}function S(t,e,n,o){return G(function(t,e){let n,o,r;const i=[];for(let a=0;a<t.length&&!((e-=2)<0);++a)n=t.charCodeAt(a),o=n>>8,r=n%256,i.push(r),i.push(o);return i}(e,t.length-n),t,n,o)}function x(t,e,n){return 0===e&&n===t.length?o.fromByteArray(t):o.fromByteArray(t.slice(e,n))}function P(t,e,n){n=Math.min(t.length,n);const o=[];let r=e;for(;r<n;){const e=t[r];let i=null,a=e>239?4:e>223?3:e>191?2:1;if(r+a<=n){let n,o,s,l;switch(a){case 1:e<128&&(i=e);break;case 2:n=t[r+1],128==(192&n)&&(l=(31&e)<<6|63&n,l>127&&(i=l));break;case 3:n=t[r+1],o=t[r+2],128==(192&n)&&128==(192&o)&&(l=(15&e)<<12|(63&n)<<6|63&o,l>2047&&(l<55296||l>57343)&&(i=l));break;case 4:n=t[r+1],o=t[r+2],s=t[r+3],128==(192&n)&&128==(192&o)&&128==(192&s)&&(l=(15&e)<<18|(63&n)<<12|(63&o)<<6|63&s,l>65535&&l<1114112&&(i=l))}}null===i?(i=65533,a=1):i>65535&&(i-=65536,o.push(i>>>10&1023|55296),i=56320|1023&i),o.push(i),r+=a}return function(t){const e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);let n="",o=0;for(;o<e;)n+=String.fromCharCode.apply(String,t.slice(o,o+=T));return n}(o)}l.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(t,e,n){return u(t,e,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(t,e,n){return function(t,e,n){return c(t),t<=0?s(t):void 0!==e?"string"==typeof n?s(t).fill(e,n):s(t).fill(e):s(t)}(t,e,n)},l.allocUnsafe=function(t){return h(t)},l.allocUnsafeSlow=function(t){return h(t)},l.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==l.prototype},l.compare=function(t,e){if(Y(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),Y(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,o=e.length;for(let r=0,i=Math.min(n,o);r<i;++r)if(t[r]!==e[r]){n=t[r],o=e[r];break}return n<o?-1:o<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const o=l.allocUnsafe(e);let r=0;for(n=0;n<t.length;++n){let e=t[n];if(Y(e,Uint8Array))r+e.length>o.length?(l.isBuffer(e)||(e=l.from(e)),e.copy(o,r)):Uint8Array.prototype.set.call(o,e,r);else{if(!l.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(o,r)}r+=e.length}return o},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)g(this,e,e+1);return this},l.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},l.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},l.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?P(this,0,t):y.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){let t="";const n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},i&&(l.prototype[i]=l.prototype.inspect),l.prototype.compare=function(t,e,n,o,r){if(Y(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===o&&(o=0),void 0===r&&(r=this.length),e<0||n>t.length||o<0||r>this.length)throw new RangeError("out of range index");if(o>=r&&e>=n)return 0;if(o>=r)return-1;if(e>=n)return 1;if(this===t)return 0;let i=(r>>>=0)-(o>>>=0),a=(n>>>=0)-(e>>>=0);const s=Math.min(i,a),u=this.slice(o,r),c=t.slice(e,n);for(let t=0;t<s;++t)if(u[t]!==c[t]){i=u[t],a=c[t];break}return i<a?-1:a<i?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},l.prototype.write=function(t,e,n,o){if(void 0===e)o="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)o=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}const r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");let i=!1;for(;;)switch(o){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":case"latin1":case"binary":return E(this,t,e,n);case"base64":return k(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function O(t,e,n){let o="";n=Math.min(t.length,n);for(let r=e;r<n;++r)o+=String.fromCharCode(127&t[r]);return o}function C(t,e,n){let o="";n=Math.min(t.length,n);for(let r=e;r<n;++r)o+=String.fromCharCode(t[r]);return o}function j(t,e,n){const o=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>o)&&(n=o);let r="";for(let o=e;o<n;++o)r+=Q[t[o]];return r}function L(t,e,n){const o=t.slice(e,n);let r="";for(let t=0;t<o.length-1;t+=2)r+=String.fromCharCode(o[t]+256*o[t+1]);return r}function A(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function N(t,e,n,o,r,i){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<i)throw new RangeError('"value" argument is out of bounds');if(n+o>t.length)throw new RangeError("Index out of range")}function I(t,e,n,o,r){Z(e,o,r,t,n,7);let i=Number(e&BigInt(4294967295));t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i;let a=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=a,a>>=8,t[n++]=a,a>>=8,t[n++]=a,a>>=8,t[n++]=a,n}function R(t,e,n,o,r){Z(e,o,r,t,n,7);let i=Number(e&BigInt(4294967295));t[n+7]=i,i>>=8,t[n+6]=i,i>>=8,t[n+5]=i,i>>=8,t[n+4]=i;let a=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=a,a>>=8,t[n+2]=a,a>>=8,t[n+1]=a,a>>=8,t[n]=a,n+8}function M(t,e,n,o,r,i){if(n+o>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(t,e,n,o,i){return e=+e,n>>>=0,i||M(t,0,n,4),r.write(t,e,n,o,23,4),n+4}function F(t,e,n,o,i){return e=+e,n>>>=0,i||M(t,0,n,8),r.write(t,e,n,o,52,8),n+8}l.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const o=this.subarray(t,e);return Object.setPrototypeOf(o,l.prototype),o},l.prototype.readUintLE=l.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||A(t,e,this.length);let o=this[t],r=1,i=0;for(;++i<e&&(r*=256);)o+=this[t+i]*r;return o},l.prototype.readUintBE=l.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||A(t,e,this.length);let o=this[t+--e],r=1;for(;e>0&&(r*=256);)o+=this[t+--e]*r;return o},l.prototype.readUint8=l.prototype.readUInt8=function(t,e){return t>>>=0,e||A(t,1,this.length),this[t]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(t,e){return t>>>=0,e||A(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(t,e){return t>>>=0,e||A(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(t,e){return t>>>=0,e||A(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(t,e){return t>>>=0,e||A(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readBigUInt64LE=J((function(t){q(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||$(t,this.length-8);const o=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,r=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(o)+(BigInt(r)<<BigInt(32))})),l.prototype.readBigUInt64BE=J((function(t){q(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||$(t,this.length-8);const o=e*2**24+65536*this[++t]+256*this[++t]+this[++t],r=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(o)<<BigInt(32))+BigInt(r)})),l.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||A(t,e,this.length);let o=this[t],r=1,i=0;for(;++i<e&&(r*=256);)o+=this[t+i]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*e)),o},l.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||A(t,e,this.length);let o=e,r=1,i=this[t+--o];for(;o>0&&(r*=256);)i+=this[t+--o]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*e)),i},l.prototype.readInt8=function(t,e){return t>>>=0,e||A(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){t>>>=0,e||A(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){t>>>=0,e||A(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return t>>>=0,e||A(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return t>>>=0,e||A(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readBigInt64LE=J((function(t){q(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||$(t,this.length-8);const o=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(o)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),l.prototype.readBigInt64BE=J((function(t){q(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||$(t,this.length-8);const o=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(o)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),l.prototype.readFloatLE=function(t,e){return t>>>=0,e||A(t,4,this.length),r.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return t>>>=0,e||A(t,4,this.length),r.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return t>>>=0,e||A(t,8,this.length),r.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return t>>>=0,e||A(t,8,this.length),r.read(this,t,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(t,e,n,o){t=+t,e>>>=0,n>>>=0,o||N(this,t,e,n,Math.pow(2,8*n)-1,0);let r=1,i=0;for(this[e]=255&t;++i<n&&(r*=256);)this[e+i]=t/r&255;return e+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(t,e,n,o){t=+t,e>>>=0,n>>>=0,o||N(this,t,e,n,Math.pow(2,8*n)-1,0);let r=n-1,i=1;for(this[e+r]=255&t;--r>=0&&(i*=256);)this[e+r]=t/i&255;return e+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,1,255,0),this[e]=255&t,e+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigUInt64LE=J((function(t,e=0){return I(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=J((function(t,e=0){return R(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(t,e,n,o){if(t=+t,e>>>=0,!o){const o=Math.pow(2,8*n-1);N(this,t,e,n,o-1,-o)}let r=0,i=1,a=0;for(this[e]=255&t;++r<n&&(i*=256);)t<0&&0===a&&0!==this[e+r-1]&&(a=1),this[e+r]=(t/i|0)-a&255;return e+n},l.prototype.writeIntBE=function(t,e,n,o){if(t=+t,e>>>=0,!o){const o=Math.pow(2,8*n-1);N(this,t,e,n,o-1,-o)}let r=n-1,i=1,a=0;for(this[e+r]=255&t;--r>=0&&(i*=256);)t<0&&0===a&&0!==this[e+r+1]&&(a=1),this[e+r]=(t/i|0)-a&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigInt64LE=J((function(t,e=0){return I(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=J((function(t,e=0){return R(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(t,e,n){return z(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return z(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,o){if(!l.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),o||0===o||(o=this.length),e>=t.length&&(e=t.length),e||(e=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-e<o-n&&(o=t.length-e+n);const r=o-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,o):Uint8Array.prototype.set.call(t,this.subarray(n,o),e),r},l.prototype.fill=function(t,e,n,o){if("string"==typeof t){if("string"==typeof e?(o=e,e=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!l.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(1===t.length){const e=t.charCodeAt(0);("utf8"===o&&e<128||"latin1"===o)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let r;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(r=e;r<n;++r)this[r]=t;else{const i=l.isBuffer(t)?t:l.from(t,o),a=i.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(r=0;r<n-e;++r)this[r+e]=i[r%a]}return this};const B={};function D(t,e,n){B[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function U(t){let e="",n=t.length;const o="-"===t[0]?1:0;for(;n>=o+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function Z(t,e,n,o,r,i){if(t>n||t<e){const o="bigint"==typeof e?"n":"";let r;throw r=i>3?0===e||e===BigInt(0)?`>= 0${o} and < 2${o} ** ${8*(i+1)}${o}`:`>= -(2${o} ** ${8*(i+1)-1}${o}) and < 2 ** ${8*(i+1)-1}${o}`:`>= ${e}${o} and <= ${n}${o}`,new B.ERR_OUT_OF_RANGE("value",r,t)}!function(t,e,n){q(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||$(e,t.length-(n+1))}(o,r,i)}function q(t,e){if("number"!=typeof t)throw new B.ERR_INVALID_ARG_TYPE(e,"number",t)}function $(t,e,n){if(Math.floor(t)!==t)throw q(t,n),new B.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new B.ERR_BUFFER_OUT_OF_BOUNDS;throw new B.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}D("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),D("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),D("ERR_OUT_OF_RANGE",(function(t,e,n){let o=`The value of "${t}" is out of range.`,r=n;return Number.isInteger(n)&&Math.abs(n)>2**32?r=U(String(n)):"bigint"==typeof n&&(r=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(r=U(r)),r+="n"),o+=` It must be ${e}. Received ${r}`,o}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function H(t,e){let n;e=e||1/0;const o=t.length;let r=null;const i=[];for(let a=0;a<o;++a){if(n=t.charCodeAt(a),n>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(a+1===o){(e-=3)>-1&&i.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&i.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function V(t){return o.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function G(t,e,n,o){let r;for(r=0;r<o&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}function Y(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function K(t){return t!=t}const Q=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const o=16*n;for(let r=0;r<16;++r)e[o+r]=t[n]+t[r]}return e}();function J(t){return"undefined"==typeof BigInt?X:t}function X(){throw new Error("BigInt not supported")}},8075:(t,e,n)=>{"use strict";var o=n(453),r=n(487),i=r(o("String.prototype.indexOf"));t.exports=function(t,e){var n=o(t,!!e);return"function"==typeof n&&i(t,".prototype.")>-1?r(n):n}},487:(t,e,n)=>{"use strict";var o=n(6743),r=n(453),i=n(6897),a=n(9675),s=r("%Function.prototype.apply%"),l=r("%Function.prototype.call%"),u=r("%Reflect.apply%",!0)||o.call(l,s),c=n(655),h=r("%Math.max%");t.exports=function(t){if("function"!=typeof t)throw new a("a function is required");var e=u(o,l,arguments);return i(e,1+h(0,t.length-(arguments.length-1)),!0)};var p=function(){return u(o,s,arguments)};c?c(t.exports,"apply",{value:p}):t.exports.apply=p},41:(t,e,n)=>{"use strict";var o=n(655),r=n(8068),i=n(9675),a=n(5795);t.exports=function(t,e,n){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new i("`obj` must be an object or a function`");if("string"!=typeof e&&"symbol"!=typeof e)throw new i("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new i("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new i("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new i("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new i("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,u=arguments.length>5?arguments[5]:null,c=arguments.length>6&&arguments[6],h=!!a&&a(t,e);if(o)o(t,e,{configurable:null===u&&h?h.configurable:!u,enumerable:null===s&&h?h.enumerable:!s,value:n,writable:null===l&&h?h.writable:!l});else{if(!c&&(s||l||u))throw new r("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");t[e]=n}}},8452:(t,e,n)=>{"use strict";var o=n(1189),r="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),i=Object.prototype.toString,a=Array.prototype.concat,s=n(41),l=n(592)(),u=function(t,e,n,o){if(e in t)if(!0===o){if(t[e]===n)return}else if("function"!=typeof(r=o)||"[object Function]"!==i.call(r)||!o())return;var r;l?s(t,e,n,!0):s(t,e,n)},c=function(t,e){var n=arguments.length>2?arguments[2]:{},i=o(e);r&&(i=a.call(i,Object.getOwnPropertySymbols(e)));for(var s=0;s<i.length;s+=1)u(t,i[s],e[i[s]],n[i[s]])};c.supportsDescriptors=!!l,t.exports=c},655:(t,e,n)=>{"use strict";var o=n(453)("%Object.defineProperty%",!0)||!1;if(o)try{o({},"a",{value:1})}catch(t){o=!1}t.exports=o},1237:t=>{"use strict";t.exports=EvalError},9383:t=>{"use strict";t.exports=Error},9290:t=>{"use strict";t.exports=RangeError},9538:t=>{"use strict";t.exports=ReferenceError},8068:t=>{"use strict";t.exports=SyntaxError},9675:t=>{"use strict";t.exports=TypeError},5345:t=>{"use strict";t.exports=URIError},5388:(t,e,n)=>{"use strict";var o=n(9675);t.exports=function(t){if(null==t)throw new o(arguments.length>0&&arguments[1]||"Cannot call method on "+t);return t}},9797:function(t,e,n){var o=n(8287).Buffer;!function(t){"use strict";function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}let r="undefined"!=typeof self?self:n.g;var i="undefined"!=typeof navigator,a=i&&"undefined"==typeof HTMLImageElement,s=!(void 0===n.g||"undefined"==typeof process||!process.versions||!process.versions.node);let l=r.Buffer;var u=!!l;const c=t=>void 0!==t;function h(t){return void 0===t||(t instanceof Map?0===t.size:0===Object.values(t).filter(c).length)}function p(t){let e=new Error(t);throw delete e.stack,e}function f(t){let e=function(t){let e=0;return t.ifd0.enabled&&(e+=1024),t.exif.enabled&&(e+=2048),t.makerNote&&(e+=2048),t.userComment&&(e+=1024),t.gps.enabled&&(e+=512),t.interop.enabled&&(e+=100),t.ifd1.enabled&&(e+=1024),e+2048}(t);return t.jfif.enabled&&(e+=50),t.xmp.enabled&&(e+=2e4),t.iptc.enabled&&(e+=14e3),t.icc.enabled&&(e+=6e3),e}const d=t=>String.fromCharCode.apply(null,t),m="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;class y{static from(t,e){return t instanceof this&&t.le===e?t:new y(t,void 0,void 0,e)}constructor(t,e=0,n,o){if("boolean"==typeof o&&(this.le=o),Array.isArray(t)&&(t=new Uint8Array(t)),0===t)this.byteOffset=0,this.byteLength=0;else if(t instanceof ArrayBuffer){void 0===n&&(n=t.byteLength-e);let o=new DataView(t,e,n);this._swapDataView(o)}else if(t instanceof Uint8Array||t instanceof DataView||t instanceof y){void 0===n&&(n=t.byteLength-e),(e+=t.byteOffset)+n>t.byteOffset+t.byteLength&&p("Creating view outside of available memory in ArrayBuffer");let o=new DataView(t.buffer,e,n);this._swapDataView(o)}else if("number"==typeof t){let e=new DataView(new ArrayBuffer(t));this._swapDataView(e)}else p("Invalid input argument for BufferView: "+t)}_swapArrayBuffer(t){this._swapDataView(new DataView(t))}_swapBuffer(t){this._swapDataView(new DataView(t.buffer,t.byteOffset,t.byteLength))}_swapDataView(t){this.dataView=t,this.buffer=t.buffer,this.byteOffset=t.byteOffset,this.byteLength=t.byteLength}_lengthToEnd(t){return this.byteLength-t}set(t,e,n=y){return t instanceof DataView||t instanceof y?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||p("BufferView.set(): Invalid data argument."),this.toUint8().set(t,e),new n(this,e,t.byteLength)}subarray(t,e){return e=e||this._lengthToEnd(t),new y(this,t,e)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(t,e){return new Uint8Array(this.buffer,this.byteOffset+t,e)}getString(t=0,e=this.byteLength){return n=this.getUint8Array(t,e),m?m.decode(n):u?o.from(n).toString("utf8"):decodeURIComponent(escape(d(n)));var n}getLatin1String(t=0,e=this.byteLength){let n=this.getUint8Array(t,e);return d(n)}getUnicodeString(t=0,e=this.byteLength){const n=[];for(let o=0;o<e&&t+o<this.byteLength;o+=2)n.push(this.getUint16(t+o));return d(n)}getInt8(t){return this.dataView.getInt8(t)}getUint8(t){return this.dataView.getUint8(t)}getInt16(t,e=this.le){return this.dataView.getInt16(t,e)}getInt32(t,e=this.le){return this.dataView.getInt32(t,e)}getUint16(t,e=this.le){return this.dataView.getUint16(t,e)}getUint32(t,e=this.le){return this.dataView.getUint32(t,e)}getFloat32(t,e=this.le){return this.dataView.getFloat32(t,e)}getFloat64(t,e=this.le){return this.dataView.getFloat64(t,e)}getFloat(t,e=this.le){return this.dataView.getFloat32(t,e)}getDouble(t,e=this.le){return this.dataView.getFloat64(t,e)}getUintBytes(t,e,n){switch(e){case 1:return this.getUint8(t,n);case 2:return this.getUint16(t,n);case 4:return this.getUint32(t,n);case 8:return this.getUint64&&this.getUint64(t,n)}}getUint(t,e,n){switch(e){case 8:return this.getUint8(t,n);case 16:return this.getUint16(t,n);case 32:return this.getUint32(t,n);case 64:return this.getUint64&&this.getUint64(t,n)}}toString(t){return this.dataView.toString(t,this.constructor.name)}ensureChunk(){}}function g(t,e){p(`${t} '${e}' was not loaded, try using full build of exifr.`)}class v extends Map{constructor(t){super(),this.kind=t}get(t,e){return this.has(t)||g(this.kind,t),e&&(t in e||function(t,e){p(`Unknown ${t} '${e}'.`)}(this.kind,t),e[t].enabled||g(this.kind,t)),super.get(t)}keyList(){return Array.from(this.keys())}}var b=new v("file parser"),_=new v("segment parser"),w=new v("file reader");const E="Invalid input argument";function k(t,e){return(n=t).startsWith("data:")||n.length>1e4?x(t,e,"base64"):i?S(t,e,"url",P):s?x(t,e,"fs"):void p(E);var n}async function S(t,e,n,o){return w.has(n)?x(t,e,n):o?async function(t,e){let n=await e(t);return new y(n)}(t,o):void p(`Parser ${n} is not loaded`)}async function x(t,e,n){let o=new(w.get(n))(t,e);return await o.read(),o}async function P(t){return fetch(t).then((t=>t.arrayBuffer()))}async function T(t){return new Promise(((e,n)=>{let o=new FileReader;o.onloadend=()=>e(o.result||new ArrayBuffer),o.onerror=n,o.readAsArrayBuffer(t)}))}class O extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function C(t,e,n){let o=new O;for(let[t,e]of n)o.set(t,e);if(Array.isArray(e))for(let n of e)t.set(n,o);else t.set(e,o);return o}function j(t,e,n){let o,r=t.get(e);for(o of n)r.set(o[0],o[1])}const L=new Map,A=new Map,N=new Map,I=37500,R=37510,M=33723,z=34675,F=34665,B=34853,D=40965,U=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],Z=["jfif","xmp","icc","iptc","ihdr"],q=["tiff",...Z],$=["ifd0","ifd1","exif","gps","interop"],W=[...q,...$],H=["makerNote","userComment"],V=["translateKeys","translateValues","reviveValues","multiSegment"],G=[...V,"sanitize","mergeOutput","silentErrors"];class Y{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class K extends Y{get needed(){return this.enabled||this.deps.size>0}constructor(t,n,o,r){if(super(),e(this,"enabled",!1),e(this,"skip",new Set),e(this,"pick",new Set),e(this,"deps",new Set),e(this,"translateKeys",!1),e(this,"translateValues",!1),e(this,"reviveValues",!1),this.key=t,this.enabled=n,this.parse=this.enabled,this.applyInheritables(r),this.canBeFiltered=$.includes(t),this.canBeFiltered&&(this.dict=L.get(t)),void 0!==o)if(Array.isArray(o))this.parse=this.enabled=!0,this.canBeFiltered&&o.length>0&&this.translateTagSet(o,this.pick);else if("object"==typeof o){if(this.enabled=!0,this.parse=!1!==o.parse,this.canBeFiltered){let{pick:t,skip:e}=o;t&&t.length>0&&this.translateTagSet(t,this.pick),e&&e.length>0&&this.translateTagSet(e,this.skip)}this.applyInheritables(o)}else!0===o||!1===o?this.parse=this.enabled=o:p(`Invalid options argument: ${o}`)}applyInheritables(t){let e,n;for(e of V)n=t[e],void 0!==n&&(this[e]=n)}translateTagSet(t,e){if(this.dict){let n,o,{tagKeys:r,tagValues:i}=this.dict;for(n of t)"string"==typeof n?(o=i.indexOf(n),-1===o&&(o=r.indexOf(Number(n))),-1!==o&&e.add(Number(r[o]))):e.add(n)}else for(let n of t)e.add(n)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,nt(this.pick,this.deps)):this.enabled&&this.pick.size>0&&nt(this.pick,this.deps)}}var Q={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},J=new Map;class X extends Y{static useCached(t){let e=J.get(t);return void 0!==e||(e=new this(t),J.set(t,e)),e}constructor(t){super(),!0===t?this.setupFromTrue():void 0===t?this.setupFromUndefined():Array.isArray(t)?this.setupFromArray(t):"object"==typeof t?this.setupFromObject(t):p(`Invalid options argument ${t}`),void 0===this.firstChunkSize&&(this.firstChunkSize=i?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let t;for(t of U)this[t]=Q[t];for(t of G)this[t]=Q[t];for(t of H)this[t]=Q[t];for(t of W)this[t]=new K(t,Q[t],void 0,this)}setupFromTrue(){let t;for(t of U)this[t]=Q[t];for(t of G)this[t]=Q[t];for(t of H)this[t]=!0;for(t of W)this[t]=new K(t,!0,void 0,this)}setupFromArray(t){let e;for(e of U)this[e]=Q[e];for(e of G)this[e]=Q[e];for(e of H)this[e]=Q[e];for(e of W)this[e]=new K(e,!1,void 0,this);this.setupGlobalFilters(t,void 0,$)}setupFromObject(t){let e;for(e of($.ifd0=$.ifd0||$.image,$.ifd1=$.ifd1||$.thumbnail,Object.assign(this,t),U))this[e]=et(t[e],Q[e]);for(e of G)this[e]=et(t[e],Q[e]);for(e of H)this[e]=et(t[e],Q[e]);for(e of q)this[e]=new K(e,Q[e],t[e],this);for(e of $)this[e]=new K(e,Q[e],t[e],this.tiff);this.setupGlobalFilters(t.pick,t.skip,$,W),!0===t.tiff?this.batchEnableWithBool($,!0):!1===t.tiff?this.batchEnableWithUserValue($,t):Array.isArray(t.tiff)?this.setupGlobalFilters(t.tiff,void 0,$):"object"==typeof t.tiff&&this.setupGlobalFilters(t.tiff.pick,t.tiff.skip,$)}batchEnableWithBool(t,e){for(let n of t)this[n].enabled=e}batchEnableWithUserValue(t,e){for(let n of t){let t=e[n];this[n].enabled=!1!==t&&void 0!==t}}setupGlobalFilters(t,e,n,o=n){if(t&&t.length){for(let t of o)this[t].enabled=!1;let e=tt(t,n);for(let[t,n]of e)nt(this[t].pick,n),this[t].enabled=!0}else if(e&&e.length){let t=tt(e,n);for(let[e,n]of t)nt(this[e].skip,n)}}filterNestedSegmentTags(){let{ifd0:t,exif:e,xmp:n,iptc:o,icc:r}=this;this.makerNote?e.deps.add(I):e.skip.add(I),this.userComment?e.deps.add(R):e.skip.add(R),n.enabled||t.skip.add(700),o.enabled||t.skip.add(M),r.enabled||t.skip.add(z)}traverseTiffDependencyTree(){let{ifd0:t,exif:e,gps:n,interop:o}=this;o.needed&&(e.deps.add(D),t.deps.add(D)),e.needed&&t.deps.add(F),n.needed&&t.deps.add(B),this.tiff.enabled=$.some((t=>!0===this[t].enabled))||this.makerNote||this.userComment;for(let t of $)this[t].finalizeFilters()}get onlyTiff(){return!Z.map((t=>this[t].enabled)).some((t=>!0===t))&&this.tiff.enabled}checkLoadedPlugins(){for(let t of q)this[t].enabled&&!_.has(t)&&g("segment parser",t)}}function tt(t,e){let n,o,r,i,a=[];for(r of e){for(i of(n=L.get(r),o=[],n))(t.includes(i[0])||t.includes(i[1]))&&o.push(i[0]);o.length&&a.push([r,o])}return a}function et(t,e){return void 0!==t?t:void 0!==e?e:void 0}function nt(t,e){for(let n of e)t.add(n)}e(X,"default",Q);class ot{constructor(t){e(this,"parsers",{}),this.options=X.useCached(t)}setup(){if(this.fileParser)return;let{file:t}=this,e=t.getUint16(0);for(let[n,o]of b)if(o.canHandle(t,e))return this.fileParser=new o(this.options,this.file,this.parsers),t[n]=!0;p("Unknown file format")}async read(t){this.file=await function(t,e){return"string"==typeof t?k(t,e):i&&!a&&t instanceof HTMLImageElement?k(t.src,e):t instanceof Uint8Array||t instanceof ArrayBuffer||t instanceof DataView?new y(t):i&&t instanceof Blob?S(t,e,"blob",T):void p(E)}(t,this.options)}async parse(){this.setup();let t={},e=[];return this.options.silentErrors?(await this.doParse(t,e).catch((t=>e.push(t))),e.push(...this.fileParser.errors)):await this.doParse(t,e),this.file.close&&this.file.close(),this.options.silentErrors&&e.length>0&&(t.errors=e),h(n=t)?void 0:n;var n}async doParse(t,e){await this.fileParser.parse();let n=Object.values(this.parsers).map((async e=>{let n=await e.parse();e.assignToOutput(t,n)}));if(this.options.silentErrors){const t=t=>e.push(t);n=n.map((e=>e.catch(t)))}await Promise.all(n)}async extractThumbnail(){this.setup();let{options:t,file:e}=this,n=_.get("tiff",t);var o;if(e.tiff?o={start:0,type:"tiff"}:e.jpeg&&(o=await this.fileParser.getOrFindSegment("tiff")),void 0===o)return;let r=await this.fileParser.ensureSegmentChunk(o),i=this.parsers.tiff=new n(r,t,e),a=await i.extractThumbnail();return e.close&&e.close(),a}}async function rt(t,e){let n=new ot(e);return await n.read(t),n.parse()}var it=Object.freeze({__proto__:null,parse:rt,Exifr:ot,fileParsers:b,segmentParsers:_,fileReaders:w,tagKeys:L,tagValues:A,tagRevivers:N,createDictionary:C,extendDictionary:j,fetchUrlAsArrayBuffer:P,readBlobAsArrayBuffer:T,chunkedProps:U,otherSegments:Z,segments:q,tiffBlocks:$,segmentsAndBlocks:W,tiffExtractables:H,inheritables:V,allFormatters:G,Options:X});class at{static findPosition(t,e){let n=t.getUint16(e+2)+2,o="function"==typeof this.headerLength?this.headerLength(t,e,n):this.headerLength,r=e+o,i=n-o;return{offset:e,length:n,headerLength:o,start:r,size:i,end:r+i}}static parse(t,e={}){return new this(t,new X({[this.type]:e})).parse()}normalizeInput(t){return t instanceof y?t:new y(t)}constructor(t,n={},o){e(this,"errors",[]),e(this,"raw",new Map),e(this,"handleError",(t=>{if(!this.options.silentErrors)throw t;this.errors.push(t.message)})),this.chunk=this.normalizeInput(t),this.file=o,this.type=this.constructor.type,this.globalOptions=this.options=n,this.localOptions=n[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(t,e){let n=N.get(e),o=A.get(e),r=L.get(e),i=this.options[e],a=i.reviveValues&&!!n,s=i.translateValues&&!!o,l=i.translateKeys&&!!r,u={};for(let[e,i]of t)a&&n.has(e)?i=n.get(e)(i):s&&o.has(e)&&(i=this.translateValue(i,o.get(e))),l&&r.has(e)&&(e=r.get(e)||e),u[e]=i;return u}translateValue(t,e){return e[t]||e.DEFAULT||t}assignToOutput(t,e){this.assignObjectToOutput(t,this.constructor.type,e)}assignObjectToOutput(t,e,n){if(this.globalOptions.mergeOutput)return Object.assign(t,n);t[e]?Object.assign(t[e],n):t[e]=n}}function st(t){return 192===t||194===t||196===t||219===t||221===t||218===t||254===t}function lt(t){return t>=224&&t<=239}function ut(t,e,n){for(let[o,r]of _)if(r.canHandle(t,e,n))return o}e(at,"headerLength",4),e(at,"type",void 0),e(at,"multiSegment",!1),e(at,"canHandle",(()=>!1));class ct extends class{constructor(t,n,o){e(this,"errors",[]),e(this,"ensureSegmentChunk",(async t=>{let e=t.start,n=t.size||65536;if(this.file.chunked)if(this.file.available(e,n))t.chunk=this.file.subarray(e,n);else try{t.chunk=await this.file.readChunk(e,n)}catch(e){p(`Couldn't read segment: ${JSON.stringify(t)}. ${e.message}`)}else this.file.byteLength>e+n?t.chunk=this.file.subarray(e,n):void 0===t.size?t.chunk=this.file.subarray(e):p("Segment unreachable: "+JSON.stringify(t));return t.chunk})),this.extendOptions&&this.extendOptions(t),this.options=t,this.file=n,this.parsers=o}injectSegment(t,e){this.options[t].enabled&&this.createParser(t,e)}createParser(t,e){let n=new(_.get(t))(e,this.options,this.file);return this.parsers[t]=n}createParsers(t){for(let e of t){let{type:t,chunk:n}=e,o=this.options[t];if(o&&o.enabled){let e=this.parsers[t];e&&e.append||e||this.createParser(t,n)}}}async readSegments(t){let e=t.map(this.ensureSegmentChunk);await Promise.all(e)}}{constructor(...t){super(...t),e(this,"appSegments",[]),e(this,"jpegSegments",[]),e(this,"unknownSegments",[])}static canHandle(t,e){return 65496===e}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(t){!0===t?(this.findAll=!0,this.wanted=new Set(_.keyList())):(t=void 0===t?_.keyList().filter((t=>this.options[t].enabled)):t.filter((t=>this.options[t].enabled&&_.has(t))),this.findAll=!1,this.remaining=new Set(t),this.wanted=new Set(t)),this.unfinishedMultiSegment=!1}async findAppSegments(t=0,e){this.setupSegmentFinderArgs(e);let{file:n,findAll:o,wanted:r,remaining:i}=this;if(!o&&this.file.chunked&&(o=Array.from(r).some((t=>{let e=_.get(t),n=this.options[t];return e.multiSegment&&n.multiSegment})),o&&await this.file.readWhole()),t=this.findAppSegmentsInRange(t,n.byteLength),!this.options.onlyTiff&&n.chunked){let e=!1;for(;i.size>0&&!e&&(n.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:o}=n,r=this.appSegments.some((t=>!this.file.available(t.offset||t.start,t.length||t.size)));if(e=t>o&&!r?!await n.readNextChunk(t):!await n.readNextChunk(o),void 0===(t=this.findAppSegmentsInRange(t,n.byteLength)))return}}}findAppSegmentsInRange(t,e){e-=2;let n,o,r,i,a,s,{file:l,findAll:u,wanted:c,remaining:h,options:p}=this;for(;t<e;t++)if(255===l.getUint8(t))if(n=l.getUint8(t+1),lt(n)){if(o=l.getUint16(t+2),r=ut(l,t,o),r&&c.has(r)&&(i=_.get(r),a=i.findPosition(l,t),s=p[r],a.type=r,this.appSegments.push(a),!u&&(i.multiSegment&&s.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||h.delete(r)):h.delete(r),0===h.size)))break;p.recordUnknownSegments&&(a=at.findPosition(l,t),a.marker=n,this.unknownSegments.push(a)),t+=o+1}else if(st(n)){if(o=l.getUint16(t+2),218===n&&!1!==p.stopAfterSos)return;p.recordJpegSegments&&this.jpegSegments.push({offset:t,length:o,marker:n}),t+=o+1}return t}mergeMultiSegments(){if(!this.appSegments.some((t=>t.multiSegment)))return;let t=function(t,e){let n,o,r,i=new Map;for(let e=0;e<t.length;e++)n=t[e],o=n.type,i.has(o)?r=i.get(o):i.set(o,r=[]),r.push(n);return Array.from(i)}(this.appSegments);this.mergedAppSegments=t.map((([t,e])=>{let n=_.get(t,this.options);return n.handleMultiSegments?{type:t,chunk:n.handleMultiSegments(e)}:e[0]}))}getSegment(t){return this.appSegments.find((e=>e.type===t))}async getOrFindSegment(t){let e=this.getSegment(t);return void 0===e&&(await this.findAppSegments(0,[t]),e=this.getSegment(t)),e}}e(ct,"type","jpeg"),b.set("jpeg",ct);const ht=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class pt extends at{parseHeader(){var t=this.chunk.getUint16();18761===t?this.le=!0:19789===t&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(t,e,n=new Map){let{pick:o,skip:r}=this.options[e];o=new Set(o);let i=o.size>0,a=0===r.size,s=this.chunk.getUint16(t);t+=2;for(let l=0;l<s;l++){let s=this.chunk.getUint16(t);if(i){if(o.has(s)&&(n.set(s,this.parseTag(t,s,e)),o.delete(s),0===o.size))break}else!a&&r.has(s)||n.set(s,this.parseTag(t,s,e));t+=12}return n}parseTag(t,e,n){let{chunk:o}=this,r=o.getUint16(t+2),i=o.getUint32(t+4),a=ht[r];if(a*i<=4?t+=8:t=o.getUint32(t+8),(r<1||r>13)&&p(`Invalid TIFF value type. block: ${n.toUpperCase()}, tag: ${e.toString(16)}, type: ${r}, offset ${t}`),t>o.byteLength&&p(`Invalid TIFF value offset. block: ${n.toUpperCase()}, tag: ${e.toString(16)}, type: ${r}, offset ${t} is outside of chunk size ${o.byteLength}`),1===r)return o.getUint8Array(t,i);if(2===r)return""===(s=function(t){for(;t.endsWith("\0");)t=t.slice(0,-1);return t}(s=o.getString(t,i)).trim())?void 0:s;var s;if(7===r)return o.getUint8Array(t,i);if(1===i)return this.parseTagValue(r,t);{let e=new(function(t){switch(t){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:case 10:default:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 11:return Float32Array;case 12:return Float64Array}}(r))(i),n=a;for(let o=0;o<i;o++)e[o]=this.parseTagValue(r,t),t+=n;return e}}parseTagValue(t,e){let{chunk:n}=this;switch(t){case 1:return n.getUint8(e);case 3:return n.getUint16(e);case 4:case 13:return n.getUint32(e);case 5:return n.getUint32(e)/n.getUint32(e+4);case 6:return n.getInt8(e);case 8:return n.getInt16(e);case 9:return n.getInt32(e);case 10:return n.getInt32(e)/n.getInt32(e+4);case 11:return n.getFloat(e);case 12:return n.getDouble(e);default:p(`Invalid tiff type ${t}`)}}}class ft extends pt{static canHandle(t,e){return 225===t.getUint8(e+1)&&1165519206===t.getUint32(e+4)&&0===t.getUint16(e+8)}async parse(){this.parseHeader();let{options:t}=this;return t.ifd0.enabled&&await this.parseIfd0Block(),t.exif.enabled&&await this.safeParse("parseExifBlock"),t.gps.enabled&&await this.safeParse("parseGpsBlock"),t.interop.enabled&&await this.safeParse("parseInteropBlock"),t.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(t){let e=this[t]();return void 0!==e.catch&&(e=e.catch(this.handleError)),e}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let t=this.chunk.getUint16(this.ifd0Offset),e=this.ifd0Offset+2+12*t;this.ifd1Offset=this.chunk.getUint32(e)}}parseBlock(t,e){let n=new Map;return this[e]=n,this.parseTags(t,e,n),n}async parseIfd0Block(){if(this.ifd0)return;let{file:t}=this;this.findIfd0Offset(),this.ifd0Offset<8&&p("Malformed EXIF data"),!t.chunked&&this.ifd0Offset>t.byteLength&&p(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${t.byteLength}`),t.tiff&&await t.ensureChunk(this.ifd0Offset,f(this.options));let e=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==e.size?(this.exifOffset=e.get(F),this.interopOffset=e.get(D),this.gpsOffset=e.get(B),this.xmp=e.get(700),this.iptc=e.get(M),this.icc=e.get(z),this.options.sanitize&&(e.delete(F),e.delete(D),e.delete(B),e.delete(700),e.delete(M),e.delete(z)),e):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,f(this.options));let t=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=t.get(D)),this.makerNote=t.get(I),this.userComment=t.get(R),this.options.sanitize&&(t.delete(D),t.delete(I),t.delete(R)),this.unpack(t,41728),this.unpack(t,41729),t}unpack(t,e){let n=t.get(e);n&&1===n.length&&t.set(e,n[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let t=this.parseBlock(this.gpsOffset,"gps");return t&&t.has(2)&&t.has(4)&&(t.set("latitude",dt(...t.get(2),t.get(1))),t.set("longitude",dt(...t.get(4),t.get(3)))),t}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(t=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||t))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let t=this.ifd1.get(513),e=this.ifd1.get(514);return this.chunk.getUint8Array(t,e)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let t,e,n,o={};for(e of $)if(t=this[e],!h(t))if(n=this.canTranslate?this.translateBlock(t,e):Object.fromEntries(t),this.options.mergeOutput){if("ifd1"===e)continue;Object.assign(o,n)}else o[e]=n;return this.makerNote&&(o.makerNote=this.makerNote),this.userComment&&(o.userComment=this.userComment),o}assignToOutput(t,e){if(this.globalOptions.mergeOutput)Object.assign(t,e);else for(let[n,o]of Object.entries(e))this.assignObjectToOutput(t,n,o)}}function dt(t,e,n,o){var r=t+e/60+n/3600;return"S"!==o&&"W"!==o||(r*=-1),r}e(ft,"type","tiff"),e(ft,"headerLength",10),_.set("tiff",ft);var mt=Object.freeze({__proto__:null,default:it,Exifr:ot,fileParsers:b,segmentParsers:_,fileReaders:w,tagKeys:L,tagValues:A,tagRevivers:N,createDictionary:C,extendDictionary:j,fetchUrlAsArrayBuffer:P,readBlobAsArrayBuffer:T,chunkedProps:U,otherSegments:Z,segments:q,tiffBlocks:$,segmentsAndBlocks:W,tiffExtractables:H,inheritables:V,allFormatters:G,Options:X,parse:rt});const yt={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},gt=Object.assign({},yt,{firstChunkSize:4e4,gps:[1,2,3,4]}),vt=Object.assign({},yt,{firstChunkSize:4e4,ifd0:[274]}),bt=Object.assign({},yt,{tiff:!1,ifd1:!0,mergeOutput:!1});async function _t(t){let e=new ot(vt);await e.read(t);let n=await e.parse();if(n&&n.ifd0)return n.ifd0[274]}const wt=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});if(t.rotateCanvas=!0,t.rotateCss=!0,"object"==typeof navigator){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let n=e.match(/OS (\d+)_(\d+)/);if(n){let[,e,o]=n,r=Number(e)+.1*Number(o);t.rotateCanvas=r<13.4,t.rotateCss=!1}}else if(e.includes("OS X 10")){let[,n]=e.match(/OS X 10[_.](\d+)/);t.rotateCanvas=t.rotateCss=Number(n)<15}if(e.includes("Chrome/")){let[,n]=e.match(/Chrome\/(\d+)/);t.rotateCanvas=t.rotateCss=Number(n)<81}else if(e.includes("Firefox/")){let[,n]=e.match(/Firefox\/(\d+)/);t.rotateCanvas=t.rotateCss=Number(n)<77}}class Et extends y{constructor(...t){super(...t),e(this,"ranges",new kt),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(t,e,n){if(0===t&&0===this.byteLength&&n){let t=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(t)}else{let n=t+e;if(n>this.byteLength){let{dataView:t}=this._extend(n);this._swapDataView(t)}}}_extend(t){let e;e=u?l.allocUnsafe(t):new Uint8Array(t);let n=new DataView(e.buffer,e.byteOffset,e.byteLength);return e.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:e,dataView:n}}subarray(t,e,n=!1){return e=e||this._lengthToEnd(t),n&&this._tryExtend(t,e),this.ranges.add(t,e),super.subarray(t,e)}set(t,e,n=!1){n&&this._tryExtend(e,t.byteLength,t);let o=super.set(t,e);return this.ranges.add(e,o.byteLength),o}async ensureChunk(t,e){this.chunked&&(this.ranges.available(t,e)||await this.readChunk(t,e))}available(t,e){return this.ranges.available(t,e)}}class kt{constructor(){e(this,"list",[])}get length(){return this.list.length}add(t,e,n=0){let o=t+e,r=this.list.filter((e=>St(t,e.offset,o)||St(t,e.end,o)));if(r.length>0){t=Math.min(t,...r.map((t=>t.offset))),o=Math.max(o,...r.map((t=>t.end))),e=o-t;let n=r.shift();n.offset=t,n.length=e,n.end=o,this.list=this.list.filter((t=>!r.includes(t)))}else this.list.push({offset:t,length:e,end:o})}available(t,e){let n=t+e;return this.list.some((e=>e.offset<=t&&n<=e.end))}}function St(t,e,n){return t<=e&&e<=n}class xt extends Et{constructor(t,n){super(0),e(this,"chunksRead",0),this.input=t,this.options=n}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(t=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let e=this.options.chunkSize,n=await this.readChunk(t,e);return!!n&&n.byteLength===e}async readChunk(t,e){if(this.chunksRead++,0!==(e=this.safeWrapAddress(t,e)))return this._readChunk(t,e)}safeWrapAddress(t,e){return void 0!==this.size&&t+e>this.size?Math.max(0,this.size-t):e}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}w.set("blob",class extends xt{async readWhole(){this.chunked=!1;let t=await T(this.input);this._swapArrayBuffer(t)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(t,e){let n=e?t+e:void 0,o=this.input.slice(t,n),r=await T(o);return this.set(r,t,!0)}}),t.Exifr=ot,t.Options=X,t.allFormatters=G,t.chunkedProps=U,t.createDictionary=C,t.default=mt,t.disableAllOptions=yt,t.extendDictionary=j,t.fetchUrlAsArrayBuffer=P,t.fileParsers=b,t.fileReaders=w,t.gps=async function(t){let e=new ot(gt);await e.read(t);let n=await e.parse();if(n&&n.gps){let{latitude:t,longitude:e}=n.gps;return{latitude:t,longitude:e}}},t.gpsOnlyOptions=gt,t.inheritables=V,t.orientation=_t,t.orientationOnlyOptions=vt,t.otherSegments=Z,t.parse=rt,t.readBlobAsArrayBuffer=T,t.rotation=async function(e){let n=await _t(e);return Object.assign({canvas:t.rotateCanvas,css:t.rotateCss},wt[n])},t.rotations=wt,t.segmentParsers=_,t.segments=q,t.segmentsAndBlocks=W,t.tagKeys=L,t.tagRevivers=N,t.tagValues=A,t.thumbnail=async function(t){let e=new ot(bt);await e.read(t);let n=await e.extractThumbnail();return n&&u?l.from(n):n},t.thumbnailOnlyOptions=bt,t.thumbnailUrl=async function(t){let e=await this.thumbnail(t);if(void 0!==e){let t=new Blob([e]);return URL.createObjectURL(t)}},t.tiffBlocks=$,t.tiffExtractables=H,Object.defineProperty(t,"__esModule",{value:!0})}(e)},2881:(t,e,n)=>{var o={EventEmitter:n(4566),EmitterSubscription:n(7274)};t.exports=o},4566:(t,e,n)=>{"use strict";var o=n(7274),r=n(9402),i=n(9395),a=n(646),s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._subscriber=new r,this._currentSubscription=null}return t.prototype.addListener=function(t,e,n){return this._subscriber.addSubscription(t,new o(this._subscriber,e,n))},t.prototype.once=function(t,e,n){var o=this;return this.addListener(t,(function(){o.removeCurrentListener(),e.apply(n,arguments)}))},t.prototype.removeAllListeners=function(t){this._subscriber.removeAllSubscriptions(t)},t.prototype.removeCurrentListener=function(){this._currentSubscription||a(!1),this._subscriber.removeSubscription(this._currentSubscription)},t.prototype.listeners=function(t){var e=this._subscriber.getSubscriptionsForType(t);return e?e.filter(i.thatReturnsTrue).map((function(t){return t.listener})):[]},t.prototype.emit=function(t){var e=this._subscriber.getSubscriptionsForType(t);if(e){for(var n=Object.keys(e),o=0;o<n.length;o++){var r=e[n[o]];r&&(this._currentSubscription=r,this.__emitToSubscription.apply(this,[r].concat(Array.prototype.slice.call(arguments))))}this._currentSubscription=null}},t.prototype.__emitToSubscription=function(t,e){var n=Array.prototype.slice.call(arguments,2);t.listener.apply(t.context,n)},t}();t.exports=s},7274:(t,e,n)=>{"use strict";var o=function(t){function e(n,o,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t.call(this,n),this.listener=o,this.context=r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(n(5856));t.exports=o},5856:t=>{"use strict";var e=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.subscriber=e}return t.prototype.remove=function(){this.subscriber&&(this.subscriber.removeSubscription(this),this.subscriber=null)},t}();t.exports=e},9402:(t,e,n)=>{"use strict";var o=n(646),r=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._subscriptionsForType={},this._currentSubscription=null}return t.prototype.addSubscription=function(t,e){e.subscriber!==this&&o(!1),this._subscriptionsForType[t]||(this._subscriptionsForType[t]=[]);var n=this._subscriptionsForType[t].length;return this._subscriptionsForType[t].push(e),e.eventType=t,e.key=n,e},t.prototype.removeAllSubscriptions=function(t){void 0===t?this._subscriptionsForType={}:delete this._subscriptionsForType[t]},t.prototype.removeSubscription=function(t){var e=t.eventType,n=t.key,o=this._subscriptionsForType[e];o&&delete o[n]},t.prototype.getSubscriptionsForType=function(t){return this._subscriptionsForType[t]},t}();t.exports=r},9395:t=>{"use strict";function e(t){return function(){return t}}var n=function(){};n.thatReturns=e,n.thatReturnsFalse=e(!1),n.thatReturnsTrue=e(!0),n.thatReturnsNull=e(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(t){return t},t.exports=n},646:t=>{"use strict";t.exports=function(t,e,n,o,r,i,a,s){if(!t){var l;if(void 0===e)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,o,r,i,a,s],c=0;(l=new Error(e.replace(/%s/g,(function(){return u[c++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},4213:function(t,e,n){var o,r;void 0===(r="function"==typeof(o=function(){"use strict";function e(t,e,n){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){s(o.response,e,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function r(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,a=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(t,n,a){var s=i.URL||i.webkitURL,l=document.createElement("a");n=n||t.name||"download",l.download=n,l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?r(l):o(l.href)?e(t,n,a):r(l,l.target="_blank")):(l.href=s.createObjectURL(t),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){r(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,n,i){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,i),n);else if(o(t))e(t,n,i);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){r(a)}))}}:function(t,n,o,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return e(t,n,o);var s="application/octet-stream"===t.type,l=/constructor/i.test(i.HTMLElement)||i.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||s&&l||a)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},c.readAsDataURL(t)}else{var h=i.URL||i.webkitURL,p=h.createObjectURL(t);r?r.location=p:location.href=p,r=null,setTimeout((function(){h.revokeObjectURL(p)}),4e4)}});i.saveAs=s.saveAs=s,t.exports=s})?o.apply(e,[]):o)||(t.exports=r)},9353:t=>{"use strict";var e=Object.prototype.toString,n=Math.max,o=function(t,e){for(var n=[],o=0;o<t.length;o+=1)n[o]=t[o];for(var r=0;r<e.length;r+=1)n[r+t.length]=e[r];return n};t.exports=function(t){var r=this;if("function"!=typeof r||"[object Function]"!==e.apply(r))throw new TypeError("Function.prototype.bind called on incompatible "+r);for(var i,a=function(t,e){for(var n=[],o=1,r=0;o<t.length;o+=1,r+=1)n[r]=t[o];return n}(arguments),s=n(0,r.length-a.length),l=[],u=0;u<s;u++)l[u]="$"+u;if(i=Function("binder","return function ("+function(t,e){for(var n="",o=0;o<t.length;o+=1)n+=t[o],o+1<t.length&&(n+=",");return n}(l)+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof i){var e=r.apply(this,o(a,arguments));return Object(e)===e?e:this}return r.apply(t,o(a,arguments))})),r.prototype){var c=function(){};c.prototype=r.prototype,i.prototype=new c,c.prototype=null}return i}},6743:(t,e,n)=>{"use strict";var o=n(9353);t.exports=Function.prototype.bind||o},453:(t,e,n)=>{"use strict";var o,r=n(9383),i=n(1237),a=n(9290),s=n(9538),l=n(8068),u=n(9675),c=n(5345),h=Function,p=function(t){try{return h('"use strict"; return ('+t+").constructor;")()}catch(t){}},f=Object.getOwnPropertyDescriptor;if(f)try{f({},"")}catch(t){f=null}var d=function(){throw new u},m=f?function(){try{return d}catch(t){try{return f(arguments,"callee").get}catch(t){return d}}}():d,y=n(4039)(),g=n(24)(),v=Object.getPrototypeOf||(g?function(t){return t.__proto__}:null),b={},_="undefined"!=typeof Uint8Array&&v?v(Uint8Array):o,w={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?o:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?o:ArrayBuffer,"%ArrayIteratorPrototype%":y&&v?v([][Symbol.iterator]()):o,"%AsyncFromSyncIteratorPrototype%":o,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":"undefined"==typeof Atomics?o:Atomics,"%BigInt%":"undefined"==typeof BigInt?o:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?o:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?o:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?o:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":i,"%Float32Array%":"undefined"==typeof Float32Array?o:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?o:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?o:FinalizationRegistry,"%Function%":h,"%GeneratorFunction%":b,"%Int8Array%":"undefined"==typeof Int8Array?o:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?o:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?o:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":y&&v?v(v([][Symbol.iterator]())):o,"%JSON%":"object"==typeof JSON?JSON:o,"%Map%":"undefined"==typeof Map?o:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&y&&v?v((new Map)[Symbol.iterator]()):o,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?o:Promise,"%Proxy%":"undefined"==typeof Proxy?o:Proxy,"%RangeError%":a,"%ReferenceError%":s,"%Reflect%":"undefined"==typeof Reflect?o:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?o:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&y&&v?v((new Set)[Symbol.iterator]()):o,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?o:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":y&&v?v(""[Symbol.iterator]()):o,"%Symbol%":y?Symbol:o,"%SyntaxError%":l,"%ThrowTypeError%":m,"%TypedArray%":_,"%TypeError%":u,"%Uint8Array%":"undefined"==typeof Uint8Array?o:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?o:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?o:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?o:Uint32Array,"%URIError%":c,"%WeakMap%":"undefined"==typeof WeakMap?o:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?o:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?o:WeakSet};if(v)try{null.error}catch(t){var E=v(v(t));w["%Error.prototype%"]=E}var k=function t(e){var n;if("%AsyncFunction%"===e)n=p("async function () {}");else if("%GeneratorFunction%"===e)n=p("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=p("async function* () {}");else if("%AsyncGenerator%"===e){var o=t("%AsyncGeneratorFunction%");o&&(n=o.prototype)}else if("%AsyncIteratorPrototype%"===e){var r=t("%AsyncGenerator%");r&&v&&(n=v(r.prototype))}return w[e]=n,n},S={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},x=n(6743),P=n(9957),T=x.call(Function.call,Array.prototype.concat),O=x.call(Function.apply,Array.prototype.splice),C=x.call(Function.call,String.prototype.replace),j=x.call(Function.call,String.prototype.slice),L=x.call(Function.call,RegExp.prototype.exec),A=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,N=/\\(\\)?/g,I=function(t,e){var n,o=t;if(P(S,o)&&(o="%"+(n=S[o])[0]+"%"),P(w,o)){var r=w[o];if(r===b&&(r=k(o)),void 0===r&&!e)throw new u("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:o,value:r}}throw new l("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new u("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new u('"allowMissing" argument must be a boolean');if(null===L(/^%?[^%]*%?$/,t))throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(t){var e=j(t,0,1),n=j(t,-1);if("%"===e&&"%"!==n)throw new l("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new l("invalid intrinsic syntax, expected opening `%`");var o=[];return C(t,A,(function(t,e,n,r){o[o.length]=n?C(r,N,"$1"):e||t})),o}(t),o=n.length>0?n[0]:"",r=I("%"+o+"%",e),i=r.name,a=r.value,s=!1,c=r.alias;c&&(o=c[0],O(n,T([0,1],c)));for(var h=1,p=!0;h<n.length;h+=1){var d=n[h],m=j(d,0,1),y=j(d,-1);if(('"'===m||"'"===m||"`"===m||'"'===y||"'"===y||"`"===y)&&m!==y)throw new l("property names with quotes must have matching quotes");if("constructor"!==d&&p||(s=!0),P(w,i="%"+(o+="."+d)+"%"))a=w[i];else if(null!=a){if(!(d in a)){if(!e)throw new u("base intrinsic for "+t+" exists, but the property is not available.");return}if(f&&h+1>=n.length){var g=f(a,d);a=(p=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:a[d]}else p=P(a,d),a=a[d];p&&!s&&(w[i]=a)}}return a}},5795:(t,e,n)=>{"use strict";var o=n(453)("%Object.getOwnPropertyDescriptor%",!0);if(o)try{o([],"length")}catch(t){o=null}t.exports=o},592:(t,e,n)=>{"use strict";var o=n(655),r=function(){return!!o};r.hasArrayLengthDefineBug=function(){if(!o)return null;try{return 1!==o([],"length",{value:1}).length}catch(t){return!0}},t.exports=r},24:t=>{"use strict";var e={__proto__:null,foo:{}},n=Object;t.exports=function(){return{__proto__:e}.foo===e.foo&&!(e instanceof n)}},4039:(t,e,n)=>{"use strict";var o="undefined"!=typeof Symbol&&Symbol,r=n(1333);t.exports=function(){return"function"==typeof o&&"function"==typeof Symbol&&"symbol"==typeof o("foo")&&"symbol"==typeof Symbol("bar")&&r()}},1333:t=>{"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var o=Object.getOwnPropertySymbols(t);if(1!==o.length||o[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},9957:(t,e,n)=>{"use strict";var o=Function.prototype.call,r=Object.prototype.hasOwnProperty,i=n(6743);t.exports=i.call(o,r)},4146:t=>{"use strict";var e={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o=Object.defineProperty,r=Object.getOwnPropertyNames,i=Object.getOwnPropertySymbols,a=Object.getOwnPropertyDescriptor,s=Object.getPrototypeOf,l=s&&s(Object);t.exports=function t(u,c,h){if("string"!=typeof c){if(l){var p=s(c);p&&p!==l&&t(u,p,h)}var f=r(c);i&&(f=f.concat(i(c)));for(var d=0;d<f.length;++d){var m=f[d];if(!(e[m]||n[m]||h&&h[m])){var y=a(c,m);try{o(u,m,y)}catch(t){}}}return u}return u}},251:(t,e)=>{e.read=function(t,e,n,o,r){var i,a,s=8*r-o-1,l=(1<<s)-1,u=l>>1,c=-7,h=n?r-1:0,p=n?-1:1,f=t[e+h];for(h+=p,i=f&(1<<-c)-1,f>>=-c,c+=s;c>0;i=256*i+t[e+h],h+=p,c-=8);for(a=i&(1<<-c)-1,i>>=-c,c+=o;c>0;a=256*a+t[e+h],h+=p,c-=8);if(0===i)i=1-u;else{if(i===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,o),i-=u}return(f?-1:1)*a*Math.pow(2,i-o)},e.write=function(t,e,n,o,r,i){var a,s,l,u=8*i-r-1,c=(1<<u)-1,h=c>>1,p=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=o?0:i-1,d=o?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=c):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),(e+=a+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(a++,l/=2),a+h>=c?(s=0,a=c):a+h>=1?(s=(e*l-1)*Math.pow(2,r),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[n+f]=255&s,f+=d,s/=256,r-=8);for(a=a<<r|s,u+=r;u>0;t[n+f]=255&a,f+=d,a/=256,u-=8);t[n+f-d]|=128*m}},6894:(t,e,n)=>{var o=n(311),r=Object.prototype.hasOwnProperty,i=Array.prototype.splice,a=Object.prototype.toString,s=function(t){return a.call(t).slice(8,-1)},l=Object.assign||function(t,e){return u(e).forEach((function(n){r.call(e,n)&&(t[n]=e[n])})),t},u="function"==typeof Object.getOwnPropertySymbols?function(t){return Object.keys(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.keys(t)};function c(t){if(Array.isArray(t))return l(t.constructor(t.length),t);if("Map"===s(t))return new Map(t);if("Set"===s(t))return new Set(t);if(t&&"object"==typeof t){var e=Object.getPrototypeOf(t);return l(Object.create(e),t)}return t}function h(){var t=l({},p);return e.extend=function(e,n){t[e]=n},e.isEquals=function(t,e){return t===e},e;function e(n,i){"function"==typeof i&&(i={$apply:i}),Array.isArray(n)&&Array.isArray(i)||o(!Array.isArray(i),"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."),o("object"==typeof i&&null!==i,"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: %s.",Object.keys(t).join(", "));var a=n;return u(i).forEach((function(o){if(r.call(t,o)){var l=n===a;a=t[o](i[o],a,i,n),l&&e.isEquals(a,n)&&(a=n)}else{var u="Map"===s(n)?e(n.get(o),i[o]):e(n[o],i[o]),h="Map"===s(a)?a.get(o):a[o];e.isEquals(u,h)&&(void 0!==u||r.call(n,o))||(a===n&&(a=c(n)),"Map"===s(a)?a.set(o,u):a[o]=u)}})),a}}var p={$push:function(t,e,n){return d(e,n,"$push"),t.length?e.concat(t):e},$unshift:function(t,e,n){return d(e,n,"$unshift"),t.length?t.concat(e):e},$splice:function(t,e,n,r){return function(t,e){o(Array.isArray(t),"Expected $splice target to be an array; got %s",t),y(e.$splice)}(e,n),t.forEach((function(t){y(t),e===r&&t.length&&(e=c(r)),i.apply(e,t)})),e},$set:function(t,e,n){return function(t){o(1===Object.keys(t).length,"Cannot have more than one key in an object with $set")}(n),t},$toggle:function(t,e){m(t,"$toggle");var n=t.length?c(e):e;return t.forEach((function(t){n[t]=!e[t]})),n},$unset:function(t,e,n,o){return m(t,"$unset"),t.forEach((function(t){Object.hasOwnProperty.call(e,t)&&(e===o&&(e=c(o)),delete e[t])})),e},$add:function(t,e,n,o){return g(e,"$add"),m(t,"$add"),"Map"===s(e)?t.forEach((function(t){var n=t[0],r=t[1];e===o&&e.get(n)!==r&&(e=c(o)),e.set(n,r)})):t.forEach((function(t){e!==o||e.has(t)||(e=c(o)),e.add(t)})),e},$remove:function(t,e,n,o){return g(e,"$remove"),m(t,"$remove"),t.forEach((function(t){e===o&&e.has(t)&&(e=c(o)),e.delete(t)})),e},$merge:function(t,e,n,r){var i,a;return i=e,o((a=t)&&"object"==typeof a,"update(): $merge expects a spec of type 'object'; got %s",a),o(i&&"object"==typeof i,"update(): $merge expects a target of type 'object'; got %s",i),u(t).forEach((function(n){t[n]!==e[n]&&(e===r&&(e=c(r)),e[n]=t[n])})),e},$apply:function(t,e){var n;return o("function"==typeof(n=t),"update(): expected spec of $apply to be a function; got %s.",n),t(e)}},f=h();function d(t,e,n){o(Array.isArray(t),"update(): expected target of %s to be an array; got %s.",n,t),m(e[n],n)}function m(t,e){o(Array.isArray(t),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",e,t)}function y(t){o(Array.isArray(t),"update(): expected spec of $splice to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",t)}function g(t,e){var n=s(t);o("Map"===n||"Set"===n,"update(): %s expects a target of type Set or Map; got %s",e,n)}t.exports=f,t.exports.default=f,t.exports.newContext=h},311:t=>{"use strict";t.exports=function(t,e,n,o,r,i,a,s){if(!t){var l;if(void 0===e)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,o,r,i,a,s],c=0;(l=new Error(e.replace(/%s/g,(function(){return u[c++]})))).name="Invariant Violation"}throw l.framesToPop=1,l}}},3481:function(t,e){!function(t){"use strict";var e=Object.freeze;function n(t){var e,n,o,r;for(n=1,o=arguments.length;n<o;n++)for(e in r=arguments[n])t[e]=r[e];return t}Object.freeze=function(t){return t};var o=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function r(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var o=n.call(arguments,2);return function(){return t.apply(e,o.length?o.concat(n.call(arguments)):arguments)}}var i=0;function a(t){return t._leaflet_id=t._leaflet_id||++i,t._leaflet_id}function s(t,e,n){var o,r,i,a;return a=function(){o=!1,r&&(i.apply(n,r),r=!1)},i=function(){o?r=arguments:(t.apply(n,arguments),setTimeout(a,e),o=!0)},i}function l(t,e,n){var o=e[1],r=e[0],i=o-r;return t===o&&n?t:((t-r)%i+i)%i+r}function u(){return!1}function c(t,e){var n=Math.pow(10,void 0===e?6:e);return Math.round(t*n)/n}function h(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function p(t){return h(t).split(/\s+/)}function f(t,e){for(var n in t.hasOwnProperty("options")||(t.options=t.options?o(t.options):{}),e)t.options[n]=e[n];return t.options}function d(t,e,n){var o=[];for(var r in t)o.push(encodeURIComponent(n?r.toUpperCase():r)+"="+encodeURIComponent(t[r]));return(e&&-1!==e.indexOf("?")?"&":"?")+o.join("&")}var m=/\{ *([\w_-]+) *\}/g;function y(t,e){return t.replace(m,(function(t,n){var o=e[n];if(void 0===o)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o}))}var g=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function v(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var b="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function _(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var w=0;function E(t){var e=+new Date,n=Math.max(0,16-(e-w));return w=e+n,window.setTimeout(t,n)}var k=window.requestAnimationFrame||_("RequestAnimationFrame")||E,S=window.cancelAnimationFrame||_("CancelAnimationFrame")||_("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function x(t,e,n){if(!n||k!==E)return k.call(window,r(t,e));t.call(e)}function P(t){t&&S.call(window,t)}var T=(Object.freeze||Object)({freeze:e,extend:n,create:o,bind:r,lastId:i,stamp:a,throttle:s,wrapNum:l,falseFn:u,formatNum:c,trim:h,splitWords:p,setOptions:f,getParamString:d,template:y,isArray:g,indexOf:v,emptyImageUrl:b,requestFn:k,cancelFn:S,requestAnimFrame:x,cancelAnimFrame:P});function O(){}O.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},r=e.__super__=this.prototype,i=o(r);for(var a in i.constructor=e,e.prototype=i,this)this.hasOwnProperty(a)&&"prototype"!==a&&"__super__"!==a&&(e[a]=this[a]);return t.statics&&(n(e,t.statics),delete t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=g(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),n.apply(null,[i].concat(t.includes)),delete t.includes),i.options&&(t.options=n(o(i.options),t.options)),n(i,t),i._initHooks=[],i.callInitHooks=function(){if(!this._initHooksCalled){r.callInitHooks&&r.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;t<e;t++)i._initHooks[t].call(this)}},e},O.include=function(t){return n(this.prototype,t),this},O.mergeOptions=function(t){return n(this.prototype.options,t),this},O.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var C={on:function(t,e,n){if("object"==typeof t)for(var o in t)this._on(o,t[o],e);else for(var r=0,i=(t=p(t)).length;r<i;r++)this._on(t[r],e,n);return this},off:function(t,e,n){if(t)if("object"==typeof t)for(var o in t)this._off(o,t[o],e);else for(var r=0,i=(t=p(t)).length;r<i;r++)this._off(t[r],e,n);else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var o=this._events[t];o||(o=[],this._events[t]=o),n===this&&(n=void 0);for(var r={fn:e,ctx:n},i=o,a=0,s=i.length;a<s;a++)if(i[a].fn===e&&i[a].ctx===n)return;i.push(r)},_off:function(t,e,n){var o,r,i;if(this._events&&(o=this._events[t]))if(e){if(n===this&&(n=void 0),o)for(r=0,i=o.length;r<i;r++){var a=o[r];if(a.ctx===n&&a.fn===e)return a.fn=u,this._firingCount&&(this._events[t]=o=o.slice()),void o.splice(r,1)}}else{for(r=0,i=o.length;r<i;r++)o[r].fn=u;delete this._events[t]}},fire:function(t,e,o){if(!this.listens(t,o))return this;var r=n({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var i=this._events[t];if(i){this._firingCount=this._firingCount+1||1;for(var a=0,s=i.length;a<s;a++){var l=i[a];l.fn.call(l.ctx||this,r)}this._firingCount--}}return o&&this._propagateEvent(r),this},listens:function(t,e){var n=this._events&&this._events[t];if(n&&n.length)return!0;if(e)for(var o in this._eventParents)if(this._eventParents[o].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var o in t)this.once(o,t[o],e);return this}var i=r((function(){this.off(t,e,n).off(t,i,n)}),this);return this.on(t,e,n).on(t,i,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[a(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[a(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,n({layer:t.target,propagatedFrom:t.target},t),!0)}};C.addEventListener=C.on,C.removeEventListener=C.clearAllEventListeners=C.off,C.addOneTimeEventListener=C.once,C.fireEvent=C.fire,C.hasEventListeners=C.listens;var j=O.extend(C);function A(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var N=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function I(t,e,n){return t instanceof A?t:g(t)?new A(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new A(t.x,t.y):new A(t,e,n)}function R(t,e){if(t)for(var n=e?[t,e]:t,o=0,r=n.length;o<r;o++)this.extend(n[o])}function M(t,e){return!t||t instanceof R?t:new R(t,e)}function z(t,e){if(t)for(var n=e?[t,e]:t,o=0,r=n.length;o<r;o++)this.extend(n[o])}function F(t,e){return t instanceof z?t:new z(t,e)}function B(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function D(t,e,n){return t instanceof B?t:g(t)&&"object"!=typeof t[0]?3===t.length?new B(t[0],t[1],t[2]):2===t.length?new B(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new B(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new B(t,e,n)}A.prototype={clone:function(){return new A(this.x,this.y)},add:function(t){return this.clone()._add(I(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(I(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new A(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new A(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=N(this.x),this.y=N(this.y),this},distanceTo:function(t){var e=(t=I(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=I(t)).x===this.x&&t.y===this.y},contains:function(t){return t=I(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+c(this.x)+", "+c(this.y)+")"}},R.prototype={extend:function(t){return t=I(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new A((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new A(this.min.x,this.max.y)},getTopRight:function(){return new A(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof A?I(t):M(t))instanceof R?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=M(t);var e=this.min,n=this.max,o=t.min,r=t.max,i=r.x>=e.x&&o.x<=n.x,a=r.y>=e.y&&o.y<=n.y;return i&&a},overlaps:function(t){t=M(t);var e=this.min,n=this.max,o=t.min,r=t.max,i=r.x>e.x&&o.x<n.x,a=r.y>e.y&&o.y<n.y;return i&&a},isValid:function(){return!(!this.min||!this.max)}},z.prototype={extend:function(t){var e,n,o=this._southWest,r=this._northEast;if(t instanceof B)e=t,n=t;else{if(!(t instanceof z))return t?this.extend(D(t)||F(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return o||r?(o.lat=Math.min(e.lat,o.lat),o.lng=Math.min(e.lng,o.lng),r.lat=Math.max(n.lat,r.lat),r.lng=Math.max(n.lng,r.lng)):(this._southWest=new B(e.lat,e.lng),this._northEast=new B(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,o=Math.abs(e.lat-n.lat)*t,r=Math.abs(e.lng-n.lng)*t;return new z(new B(e.lat-o,e.lng-r),new B(n.lat+o,n.lng+r))},getCenter:function(){return new B((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new B(this.getNorth(),this.getWest())},getSouthEast:function(){return new B(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof B||"lat"in t?D(t):F(t);var e,n,o=this._southWest,r=this._northEast;return t instanceof z?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=o.lat&&n.lat<=r.lat&&e.lng>=o.lng&&n.lng<=r.lng},intersects:function(t){t=F(t);var e=this._southWest,n=this._northEast,o=t.getSouthWest(),r=t.getNorthEast(),i=r.lat>=e.lat&&o.lat<=n.lat,a=r.lng>=e.lng&&o.lng<=n.lng;return i&&a},overlaps:function(t){t=F(t);var e=this._southWest,n=this._northEast,o=t.getSouthWest(),r=t.getNorthEast(),i=r.lat>e.lat&&o.lat<n.lat,a=r.lng>e.lng&&o.lng<n.lng;return i&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=F(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},B.prototype={equals:function(t,e){return!!t&&(t=D(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+c(this.lat,t)+", "+c(this.lng,t)+")"},distanceTo:function(t){return q.distance(this,D(t))},wrap:function(){return q.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return F([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new B(this.lat,this.lng,this.alt)}};var U,Z={latLngToPoint:function(t,e){var n=this.projection.project(t),o=this.scale(e);return this.transformation._transform(n,o)},pointToLatLng:function(t,e){var n=this.scale(e),o=this.transformation.untransform(t,n);return this.projection.unproject(o)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new R(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?l(t.lng,this.wrapLng,!0):t.lng;return new B(this.wrapLat?l(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),o=e.lat-n.lat,r=e.lng-n.lng;if(0===o&&0===r)return t;var i=t.getSouthWest(),a=t.getNorthEast();return new z(new B(i.lat-o,i.lng-r),new B(a.lat-o,a.lng-r))}},q=n({},Z,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,o=t.lat*n,r=e.lat*n,i=Math.sin((e.lat-t.lat)*n/2),a=Math.sin((e.lng-t.lng)*n/2),s=i*i+Math.cos(o)*Math.cos(r)*a*a,l=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return this.R*l}}),$={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,o=Math.max(Math.min(n,t.lat),-n),r=Math.sin(o*e);return new A(this.R*t.lng*e,this.R*Math.log((1+r)/(1-r))/2)},unproject:function(t){var e=180/Math.PI;return new B((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(U=6378137*Math.PI,new R([-U,-U],[U,U]))};function W(t,e,n,o){if(g(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=o}function H(t,e,n,o){return new W(t,e,n,o)}W.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new A((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var V=n({},q,{code:"EPSG:3857",projection:$,transformation:function(){var t=.5/(Math.PI*$.R);return H(t,.5,-t,.5)}()}),G=n({},V,{code:"EPSG:900913"});function Y(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function K(t,e){var n,o,r,i,a,s,l="";for(n=0,r=t.length;n<r;n++){for(o=0,i=(a=t[n]).length;o<i;o++)l+=(o?"L":"M")+(s=a[o]).x+" "+s.y;l+=e?Tt?"z":"x":""}return l||"M0 0"}var Q=document.documentElement.style,J="ActiveXObject"in window,X=J&&!document.addEventListener,tt="msLaunchUri"in navigator&&!("documentMode"in document),et=Ct("webkit"),nt=Ct("android"),ot=Ct("android 2")||Ct("android 3"),rt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),it=nt&&Ct("Google")&&rt<537&&!("AudioNode"in window),at=!!window.opera,st=Ct("chrome"),lt=Ct("gecko")&&!et&&!at&&!J,ut=!st&&Ct("safari"),ct=Ct("phantom"),ht="OTransition"in Q,pt=0===navigator.platform.indexOf("Win"),ft=J&&"transition"in Q,dt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ot,mt="MozPerspective"in Q,yt=!window.L_DISABLE_3D&&(ft||dt||mt)&&!ht&&!ct,gt="undefined"!=typeof orientation||Ct("mobile"),vt=gt&&et,bt=gt&&dt,_t=!window.PointerEvent&&window.MSPointerEvent,wt=!(!window.PointerEvent&&!_t),Et=!window.L_NO_TOUCH&&(wt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),kt=gt&&at,St=gt&&lt,xt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Pt=!!document.createElement("canvas").getContext,Tt=!(!document.createElementNS||!Y("svg").createSVGRect),Ot=!Tt&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(t){return!1}}();function Ct(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var jt=(Object.freeze||Object)({ie:J,ielt9:X,edge:tt,webkit:et,android:nt,android23:ot,androidStock:it,opera:at,chrome:st,gecko:lt,safari:ut,phantom:ct,opera12:ht,win:pt,ie3d:ft,webkit3d:dt,gecko3d:mt,any3d:yt,mobile:gt,mobileWebkit:vt,mobileWebkit3d:bt,msPointer:_t,pointer:wt,touch:Et,mobileOpera:kt,mobileGecko:St,retina:xt,canvas:Pt,svg:Tt,vml:Ot}),Lt=_t?"MSPointerDown":"pointerdown",At=_t?"MSPointerMove":"pointermove",Nt=_t?"MSPointerUp":"pointerup",It=_t?"MSPointerCancel":"pointercancel",Rt=["INPUT","SELECT","OPTION"],Mt={},zt=!1,Ft=0;function Bt(t,e,n,o){return"touchstart"===e?function(t,e,n){var o=r((function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(Rt.indexOf(t.target.tagName)<0))return;oe(t)}qt(t,e)}));t["_leaflet_touchstart"+n]=o,t.addEventListener(Lt,o,!1),zt||(document.documentElement.addEventListener(Lt,Dt,!0),document.documentElement.addEventListener(At,Ut,!0),document.documentElement.addEventListener(Nt,Zt,!0),document.documentElement.addEventListener(It,Zt,!0),zt=!0)}(t,n,o):"touchmove"===e?function(t,e,n){var o=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&qt(t,e)};t["_leaflet_touchmove"+n]=o,t.addEventListener(At,o,!1)}(t,n,o):"touchend"===e&&function(t,e,n){var o=function(t){qt(t,e)};t["_leaflet_touchend"+n]=o,t.addEventListener(Nt,o,!1),t.addEventListener(It,o,!1)}(t,n,o),this}function Dt(t){Mt[t.pointerId]=t,Ft++}function Ut(t){Mt[t.pointerId]&&(Mt[t.pointerId]=t)}function Zt(t){delete Mt[t.pointerId],Ft--}function qt(t,e){for(var n in t.touches=[],Mt)t.touches.push(Mt[n]);t.changedTouches=[t],e(t)}var $t=_t?"MSPointerDown":wt?"pointerdown":"touchstart",Wt=_t?"MSPointerUp":wt?"pointerup":"touchend",Ht="_leaflet_";function Vt(t,e,n){var o,r,i=!1;function a(t){var e;if(wt){if(!tt||"mouse"===t.pointerType)return;e=Ft}else e=t.touches.length;if(!(e>1)){var n=Date.now(),a=n-(o||n);r=t.touches?t.touches[0]:t,i=a>0&&a<=250,o=n}}function s(t){if(i&&!r.cancelBubble){if(wt){if(!tt||"mouse"===t.pointerType)return;var n,a,s={};for(a in r)n=r[a],s[a]=n&&n.bind?n.bind(r):n;r=s}r.type="dblclick",e(r),o=null}}return t[Ht+$t+n]=a,t[Ht+Wt+n]=s,t[Ht+"dblclick"+n]=e,t.addEventListener($t,a,!1),t.addEventListener(Wt,s,!1),t.addEventListener("dblclick",e,!1),this}function Gt(t,e){var n=t[Ht+$t+e],o=t[Ht+Wt+e],r=t[Ht+"dblclick"+e];return t.removeEventListener($t,n,!1),t.removeEventListener(Wt,o,!1),tt||t.removeEventListener("dblclick",r,!1),this}function Yt(t,e,n,o){if("object"==typeof e)for(var r in e)Jt(t,r,e[r],n);else for(var i=0,a=(e=p(e)).length;i<a;i++)Jt(t,e[i],n,o);return this}var Kt="_leaflet_events";function Qt(t,e,n,o){if("object"==typeof e)for(var r in e)Xt(t,r,e[r],n);else if(e)for(var i=0,a=(e=p(e)).length;i<a;i++)Xt(t,e[i],n,o);else{for(var s in t[Kt])Xt(t,s,t[Kt][s]);delete t[Kt]}return this}function Jt(t,e,n,o){var r=e+a(n)+(o?"_"+a(o):"");if(t[Kt]&&t[Kt][r])return this;var i=function(e){return n.call(o||t,e||window.event)},s=i;wt&&0===e.indexOf("touch")?Bt(t,e,i,r):!Et||"dblclick"!==e||!Vt||wt&&st?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",i,!1):"mouseenter"===e||"mouseleave"===e?(i=function(e){e=e||window.event,pe(t,e)&&s(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",i,!1)):("click"===e&&nt&&(i=function(t){!function(t,e){var n=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,o=le&&n-le;o&&o>100&&o<500||t.target._simulatedClick&&!t._simulated?re(t):(le=n,e(t))}(t,s)}),t.addEventListener(e,i,!1)):"attachEvent"in t&&t.attachEvent("on"+e,i):Vt(t,i,r),t[Kt]=t[Kt]||{},t[Kt][r]=i}function Xt(t,e,n,o){var r=e+a(n)+(o?"_"+a(o):""),i=t[Kt]&&t[Kt][r];if(!i)return this;wt&&0===e.indexOf("touch")?function(t,e,n){var o=t["_leaflet_"+e+n];"touchstart"===e?t.removeEventListener(Lt,o,!1):"touchmove"===e?t.removeEventListener(At,o,!1):"touchend"===e&&(t.removeEventListener(Nt,o,!1),t.removeEventListener(It,o,!1))}(t,e,r):!Et||"dblclick"!==e||!Gt||wt&&st?"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",i,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,i,!1):"detachEvent"in t&&t.detachEvent("on"+e,i):Gt(t,r),t[Kt][r]=null}function te(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,he(t),this}function ee(t){return Jt(t,"mousewheel",te),this}function ne(t){return Yt(t,"mousedown touchstart dblclick",te),Jt(t,"click",ce),this}function oe(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function re(t){return oe(t),te(t),this}function ie(t,e){if(!e)return new A(t.clientX,t.clientY);var n=e.getBoundingClientRect(),o=n.width/e.offsetWidth||1,r=n.height/e.offsetHeight||1;return new A(t.clientX/o-n.left-e.clientLeft,t.clientY/r-n.top-e.clientTop)}var ae=pt&&st?2*window.devicePixelRatio:lt?window.devicePixelRatio:1;function se(t){return tt?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/ae:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var le,ue={};function ce(t){ue[t.type]=!0}function he(t){var e=ue[t.type];return ue[t.type]=!1,e}function pe(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(t){return!1}return n!==t}var fe,de,me,ye,ge,ve=(Object.freeze||Object)({on:Yt,off:Qt,stopPropagation:te,disableScrollPropagation:ee,disableClickPropagation:ne,preventDefault:oe,stop:re,getMousePosition:ie,getWheelDelta:se,fakeStop:ce,skipped:he,isExternalTarget:pe,addListener:Yt,removeListener:Qt}),be=Re(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),_e=Re(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),we="webkitTransition"===_e||"OTransition"===_e?_e+"End":"transitionend";function Ee(t){return"string"==typeof t?document.getElementById(t):t}function ke(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var o=document.defaultView.getComputedStyle(t,null);n=o?o[e]:null}return"auto"===n?null:n}function Se(t,e,n){var o=document.createElement(t);return o.className=e||"",n&&n.appendChild(o),o}function xe(t){var e=t.parentNode;e&&e.removeChild(t)}function Pe(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Te(t){var e=t.parentNode;e.lastChild!==t&&e.appendChild(t)}function Oe(t){var e=t.parentNode;e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function Ce(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=Ne(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function je(t,e){if(void 0!==t.classList)for(var n=p(e),o=0,r=n.length;o<r;o++)t.classList.add(n[o]);else if(!Ce(t,e)){var i=Ne(t);Ae(t,(i?i+" ":"")+e)}}function Le(t,e){void 0!==t.classList?t.classList.remove(e):Ae(t,h((" "+Ne(t)+" ").replace(" "+e+" "," ")))}function Ae(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function Ne(t){return void 0===t.className.baseVal?t.className:t.className.baseVal}function Ie(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var n=!1,o="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(o)}catch(t){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+o+"(opacity="+e+")"}(t,e)}function Re(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function Me(t,e,n){var o=e||new A(0,0);t.style[be]=(ft?"translate("+o.x+"px,"+o.y+"px)":"translate3d("+o.x+"px,"+o.y+"px,0)")+(n?" scale("+n+")":"")}function ze(t,e){t._leaflet_pos=e,yt?Me(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Fe(t){return t._leaflet_pos||new A(0,0)}if("onselectstart"in document)fe=function(){Yt(window,"selectstart",oe)},de=function(){Qt(window,"selectstart",oe)};else{var Be=Re(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);fe=function(){if(Be){var t=document.documentElement.style;me=t[Be],t[Be]="none"}},de=function(){Be&&(document.documentElement.style[Be]=me,me=void 0)}}function De(){Yt(window,"dragstart",oe)}function Ue(){Qt(window,"dragstart",oe)}function Ze(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(qe(),ye=t,ge=t.style.outline,t.style.outline="none",Yt(window,"keydown",qe))}function qe(){ye&&(ye.style.outline=ge,ye=void 0,ge=void 0,Qt(window,"keydown",qe))}var $e=(Object.freeze||Object)({TRANSFORM:be,TRANSITION:_e,TRANSITION_END:we,get:Ee,getStyle:ke,create:Se,remove:xe,empty:Pe,toFront:Te,toBack:Oe,hasClass:Ce,addClass:je,removeClass:Le,setClass:Ae,getClass:Ne,setOpacity:Ie,testProp:Re,setTransform:Me,setPosition:ze,getPosition:Fe,disableTextSelection:fe,enableTextSelection:de,disableImageDrag:De,enableImageDrag:Ue,preventOutline:Ze,restoreOutline:qe}),We=j.extend({run:function(t,e,n,o){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(o||.5,.2),this._startPos=Fe(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=x(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),ze(this._el,n),this.fire("step")},_complete:function(){P(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),He=j.extend({options:{crs:V,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=f(this,e),this._initContainer(t),this._initLayout(),this._onResize=r(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(D(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._zoomAnimated=_e&&yt&&!kt&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Yt(this._proxy,we,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,o){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(D(t),e,this.options.maxBounds),o=o||{},this._stop(),this._loaded&&!o.reset&&!0!==o&&(void 0!==o.animate&&(o.zoom=n({animate:o.animate},o.zoom),o.pan=n({animate:o.animate,duration:o.duration},o.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,o.zoom):this._tryAnimatedPan(t,o.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(yt?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(yt?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var o=this.getZoomScale(e),r=this.getSize().divideBy(2),i=(t instanceof A?t:this.latLngToContainerPoint(t)).subtract(r).multiplyBy(1-1/o),a=this.containerPointToLatLng(r.add(i));return this.setView(a,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():F(t);var n=I(e.paddingTopLeft||e.padding||[0,0]),o=I(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,n.add(o));if((r="number"==typeof e.maxZoom?Math.min(e.maxZoom,r):r)===1/0)return{center:t.getCenter(),zoom:r};var i=o.subtract(n).divideBy(2),a=this.project(t.getSouthWest(),r),s=this.project(t.getNorthEast(),r);return{center:this.unproject(a.add(s).divideBy(2).add(i),r),zoom:r}},fitBounds:function(t,e){if(!(t=F(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=I(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new We,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){je(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(!1===(n=n||{}).animate||!yt)return this.setView(t,e,n);this._stop();var o=this.project(this.getCenter()),r=this.project(t),i=this.getSize(),a=this._zoom;t=D(t),e=void 0===e?a:e;var s=Math.max(i.x,i.y),l=s*this.getZoomScale(a,e),u=r.distanceTo(o)||1,c=1.42,h=c*c;function p(t){var e=(l*l-s*s+(t?-1:1)*h*h*u*u)/(2*(t?l:s)*h*u),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function f(t){return(Math.exp(t)-Math.exp(-t))/2}function d(t){return(Math.exp(t)+Math.exp(-t))/2}var m=p(0);function y(t){return s*(d(m)*(f(e=m+c*t)/d(e))-f(m))/h;var e}var g=Date.now(),v=(p(1)-m)/c,b=n.duration?1e3*n.duration:1e3*v*.8;return this._moveStart(!0,n.noMoveStart),function n(){var i=(Date.now()-g)/b,l=function(t){return 1-Math.pow(1-t,1.5)}(i)*v;i<=1?(this._flyToFrame=x(n,this),this._move(this.unproject(o.add(r.subtract(o).multiplyBy(y(l)/u)),a),this.getScaleZoom(s/function(t){return s*(d(m)/d(m+c*t))}(l),a),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return(t=F(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),o=this._limitCenter(n,this._zoom,F(t));return n.equals(o)||this.panTo(o,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=n({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var o=this.getSize(),i=e.divideBy(2).round(),a=o.divideBy(2).round(),s=i.subtract(a);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(r(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:o})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=n({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=r(this._handleGeolocationResponse,this),o=r(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,o,t):navigator.geolocation.getCurrentPosition(e,o,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=new B(t.coords.latitude,t.coords.longitude),n=e.toBounds(t.coords.accuracy),o=this._locateOptions;if(o.setView){var r=this.getBoundsZoom(n);this.setView(e,o.maxZoom?Math.min(r,o.maxZoom):r)}var i={latlng:e,bounds:n,timestamp:t.timestamp};for(var a in t.coords)"number"==typeof t.coords[a]&&(i[a]=t.coords[a]);this.fire("locationfound",i)},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),xe(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)xe(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=Se("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new z(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=F(t),n=I(n||[0,0]);var o=this.getZoom()||0,r=this.getMinZoom(),i=this.getMaxZoom(),a=t.getNorthWest(),s=t.getSouthEast(),l=this.getSize().subtract(n),u=M(this.project(s,o),this.project(a,o)).getSize(),c=yt?this.options.zoomSnap:1,h=l.x/u.x,p=l.y/u.y,f=e?Math.max(h,p):Math.min(h,p);return o=this.getScaleZoom(f,o),c&&(o=Math.round(o/(c/100))*(c/100),o=e?Math.ceil(o/c)*c:Math.floor(o/c)*c),Math.max(r,Math.min(i,o))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new A(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new R(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=void 0===e?this._zoom:e;var o=n.zoom(t*n.scale(e));return isNaN(o)?1/0:o},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(D(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(I(t),e)},layerPointToLatLng:function(t){var e=I(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(D(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(D(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(F(t))},distance:function(t,e){return this.options.crs.distance(D(t),D(e))},containerPointToLayerPoint:function(t){return I(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return I(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(I(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(D(t)))},mouseEventToContainerPoint:function(t){return ie(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=Ee(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Yt(e,"scroll",this._onScroll,this),this._containerId=a(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&yt,je(t,"leaflet-container"+(Et?" leaflet-touch":"")+(xt?" leaflet-retina":"")+(X?" leaflet-oldie":"")+(ut?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=ke(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ze(this._mapPane,new A(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(je(t.markerPane,"leaflet-zoom-hide"),je(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){ze(this._mapPane,new A(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var o=this._zoom!==e;this._moveStart(o,!1)._move(t,e)._moveEnd(o),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n){void 0===e&&(e=this._zoom);var o=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(o||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return P(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ze(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[a(this._container)]=this;var e=t?Qt:Yt;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),yt&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){P(this._resizeRequest),this._resizeRequest=x((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,o=[],r="mouseout"===e||"mouseover"===e,i=t.target||t.srcElement,s=!1;i;){if((n=this._targets[a(i)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(n)){s=!0;break}if(n&&n.listens(e,!0)){if(r&&!pe(i,t))break;if(o.push(n),r)break}if(i===this._container)break;i=i.parentNode}return o.length||s||r||!pe(i,t)||(o=[this]),o},_handleDOMEvent:function(t){if(this._loaded&&!he(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e||Ze(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,o){if("click"===t.type){var r=n({},t);r.type="preclick",this._fireDOMEvent(r,r.type,o)}if(!t._stopped&&(o=(o||[]).concat(this._findEventTargets(t,e))).length){var i=o[0];"contextmenu"===e&&i.listens(e,!0)&&oe(t);var a={originalEvent:t};if("keypress"!==t.type){var s=i.getLatLng&&(!i._radius||i._radius<=10);a.containerPoint=s?this.latLngToContainerPoint(i.getLatLng()):this.mouseEventToContainerPoint(t),a.layerPoint=this.containerPointToLayerPoint(a.containerPoint),a.latlng=s?i.getLatLng():this.layerPointToLatLng(a.layerPoint)}for(var l=0;l<o.length;l++)if(o[l].fire(e,a,!0),a.originalEvent._stopped||!1===o[l].options.bubblingMouseEvents&&-1!==v(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Fe(this._mapPane)||new A(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var o=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(o)},_latLngBoundsToNewLayerBounds:function(t,e,n){var o=this._getNewPixelOrigin(n,e);return M([this.project(t.getSouthWest(),e)._subtract(o),this.project(t.getNorthWest(),e)._subtract(o),this.project(t.getSouthEast(),e)._subtract(o),this.project(t.getNorthEast(),e)._subtract(o)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var o=this.project(t,e),r=this.getSize().divideBy(2),i=new R(o.subtract(r),o.add(r)),a=this._getBoundsOffset(i,n,e);return a.round().equals([0,0])?t:this.unproject(o.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),o=new R(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(o,e))},_getBoundsOffset:function(t,e,n){var o=M(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),r=o.min.subtract(t.min),i=o.max.subtract(t.max);return new A(this._rebound(r.x,-i.x),this._rebound(r.y,-i.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),o=yt?this.options.zoomSnap:1;return o&&(t=Math.round(t/o)*o),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Le(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n)||(this.panBy(n,e),0))},_createAnimProxy:function(){var t=this._proxy=Se("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=be,n=this._proxy.style[e];Me(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",(function(){var t=this.getCenter(),e=this.getZoom();Me(this._proxy,this.project(t,e),this.getZoomScale(e,1))}),this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){xe(this._proxy),delete this._proxy},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var o=this.getZoomScale(e),r=this._getCenterOffset(t)._divideBy(1-1/o);return!(!0!==n.animate&&!this.getSize().contains(r)||(x((function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,n,o){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,je(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:o}),setTimeout(r(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Le(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),x((function(){this._moveEnd(!0)}),this))}});var Ve=O.extend({options:{position:"topright"},initialize:function(t){f(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),o=t._controlCorners[n];return je(e,"leaflet-control"),-1!==n.indexOf("bottom")?o.insertBefore(e,o.firstChild):o.appendChild(e),this},remove:function(){return this._map?(xe(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Ge=function(t){return new Ve(t)};He.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=Se("div",e+"control-container",this._container);function o(o,r){var i=e+o+" "+e+r;t[o+r]=Se("div",i,n)}o("top","left"),o("top","right"),o("bottom","left"),o("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)xe(this._controlCorners[t]);xe(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ye=Ve.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,o){return n<o?-1:o<n?1:0}},initialize:function(t,e,n){for(var o in f(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[o],o);for(o in e)this._addLayer(e[o],o,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Ve.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(a(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){je(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(je(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):Le(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Le(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=Se("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),ne(e),ee(e);var o=this._form=Se("form",t+"-list");n&&(this._map.on("click",this.collapse,this),nt||Yt(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var r=this._layersLink=Se("a",t+"-toggle",e);r.href="#",r.title="Layers",Et?(Yt(r,"click",re),Yt(r,"click",this.expand,this)):Yt(r,"focus",this.expand,this),n||this.expand(),this._baseLayersList=Se("div",t+"-base",o),this._separator=Se("div",t+"-separator",o),this._overlaysList=Se("div",t+"-overlays",o),e.appendChild(o)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&a(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(r((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Pe(this._baseLayersList),Pe(this._overlaysList),this._layerControlInputs=[];var t,e,n,o,r=0;for(n=0;n<this._layers.length;n++)o=this._layers[n],this._addItem(o),e=e||o.overlay,t=t||!o.overlay,r+=o.overlay?0:1;return this.options.hideSingleBase&&(t=t&&r>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(a(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",o=document.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var e,n=document.createElement("label"),o=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=o):e=this._createRadioElement("leaflet-base-layers",o),this._layerControlInputs.push(e),e.layerId=a(t.layer),Yt(e,"click",this._onInputClick,this);var r=document.createElement("span");r.innerHTML=" "+t.name;var i=document.createElement("div");return n.appendChild(i),i.appendChild(e),i.appendChild(r),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,n=this._layerControlInputs,o=[],r=[];this._handlingClick=!0;for(var i=n.length-1;i>=0;i--)t=n[i],e=this._getLayer(t.layerId).layer,t.checked?o.push(e):t.checked||r.push(e);for(i=0;i<r.length;i++)this._map.hasLayer(r[i])&&this._map.removeLayer(r[i]);for(i=0;i<o.length;i++)this._map.hasLayer(o[i])||this._map.addLayer(o[i]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,o=this._map.getZoom(),r=n.length-1;r>=0;r--)t=n[r],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&o<e.options.minZoom||void 0!==e.options.maxZoom&&o>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Ke=Ve.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=Se("div",e+" leaflet-bar"),o=this.options;return this._zoomInButton=this._createButton(o.zoomInText,o.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(o.zoomOutText,o.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,o,r){var i=Se("a",n,o);return i.innerHTML=t,i.href="#",i.title=e,i.setAttribute("role","button"),i.setAttribute("aria-label",e),ne(i),Yt(i,"click",re),Yt(i,"click",r,this),Yt(i,"click",this._refocusOnMap,this),i},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";Le(this._zoomInButton,e),Le(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&je(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&je(this._zoomInButton,e)}});He.mergeOptions({zoomControl:!0}),He.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new Ke,this.addControl(this.zoomControl))}));var Qe=Ve.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=Se("div",e),o=this.options;return this._addScales(o,e+"-line",n),t.on(o.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=Se("div",e,n)),t.imperial&&(this._iScale=Se("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e,n,o,r=3.2808399*t;r>5280?(e=r/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mi",n/e)):(o=this._getRoundNum(r),this._updateScale(this._iScale,o+" ft",o/r))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),Je=Ve.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){f(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=Se("div","leaflet-control-attribution"),ne(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}}});He.mergeOptions({attributionControl:!0}),He.addInitHook((function(){this.options.attributionControl&&(new Je).addTo(this)}));Ve.Layers=Ye,Ve.Zoom=Ke,Ve.Scale=Qe,Ve.Attribution=Je,Ge.layers=function(t,e,n){return new Ye(t,e,n)},Ge.zoom=function(t){return new Ke(t)},Ge.scale=function(t){return new Qe(t)},Ge.attribution=function(t){return new Je(t)};var Xe=O.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Xe.addTo=function(t,e){return t.addHandler(e,this),this};var tn,en={Events:C},nn=Et?"touchstart mousedown":"mousedown",on={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},rn={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},an=j.extend({options:{clickTolerance:3},initialize:function(t,e,n,o){f(this,o),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(Yt(this._dragStartTarget,nn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(an._dragging===this&&this.finishDrag(),Qt(this._dragStartTarget,nn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!Ce(this._element,"leaflet-zoom-anim")&&!(an._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(an._dragging=this,this._preventOutline&&Ze(this._element),De(),fe(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t;this._startPoint=new A(e.clientX,e.clientY),Yt(document,rn[t.type],this._onMove,this),Yt(document,on[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new A(e.clientX,e.clientY).subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(oe(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Fe(this._element).subtract(n),je(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),je(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,P(this._animRequest),this._lastEvent=t,this._animRequest=x(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ze(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in Le(document.body,"leaflet-dragging"),this._lastTarget&&(Le(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),rn)Qt(document,rn[t],this._onMove,this),Qt(document,on[t],this._onUp,this);Ue(),de(),this._moved&&this._moving&&(P(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,an._dragging=!1}});function sn(t,e){if(!e||!t.length)return t.slice();var n=e*e;return function(t,e){var n=t.length,o=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);o[0]=o[n-1]=1,un(t,o,e,0,n-1);var r,i=[];for(r=0;r<n;r++)o[r]&&i.push(t[r]);return i}(t=function(t,e){for(var n=[t[0]],o=1,r=0,i=t.length;o<i;o++)fn(t[o],t[r])>e&&(n.push(t[o]),r=o);return r<i-1&&n.push(t[i-1]),n}(t,n),n)}function ln(t,e,n){return Math.sqrt(dn(t,e,n,!0))}function un(t,e,n,o,r){var i,a,s,l=0;for(a=o+1;a<=r-1;a++)(s=dn(t[a],t[o],t[r],!0))>l&&(i=a,l=s);l>n&&(e[i]=1,un(t,e,n,o,i),un(t,e,n,i,r))}function cn(t,e,n,o,r){var i,a,s,l=o?tn:pn(t,n),u=pn(e,n);for(tn=u;;){if(!(l|u))return[t,e];if(l&u)return!1;s=pn(a=hn(t,e,i=l||u,n,r),n),i===l?(t=a,l=s):(e=a,u=s)}}function hn(t,e,n,o,r){var i,a,s=e.x-t.x,l=e.y-t.y,u=o.min,c=o.max;return 8&n?(i=t.x+s*(c.y-t.y)/l,a=c.y):4&n?(i=t.x+s*(u.y-t.y)/l,a=u.y):2&n?(i=c.x,a=t.y+l*(c.x-t.x)/s):1&n&&(i=u.x,a=t.y+l*(u.x-t.x)/s),new A(i,a,r)}function pn(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function fn(t,e){var n=e.x-t.x,o=e.y-t.y;return n*n+o*o}function dn(t,e,n,o){var r,i=e.x,a=e.y,s=n.x-i,l=n.y-a,u=s*s+l*l;return u>0&&((r=((t.x-i)*s+(t.y-a)*l)/u)>1?(i=n.x,a=n.y):r>0&&(i+=s*r,a+=l*r)),s=t.x-i,l=t.y-a,o?s*s+l*l:new A(i,a)}function mn(t){return!g(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function yn(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),mn(t)}var gn=(Object.freeze||Object)({simplify:sn,pointToSegmentDistance:ln,closestPointOnSegment:function(t,e,n){return dn(t,e,n)},clipSegment:cn,_getEdgeIntersection:hn,_getBitCode:pn,_sqClosestPointOnSegment:dn,isFlat:mn,_flat:yn});function vn(t,e,n){var o,r,i,a,s,l,u,c,h,p=[1,4,2,8];for(r=0,u=t.length;r<u;r++)t[r]._code=pn(t[r],e);for(a=0;a<4;a++){for(c=p[a],o=[],r=0,i=(u=t.length)-1;r<u;i=r++)s=t[r],l=t[i],s._code&c?l._code&c||((h=hn(l,s,c,e,n))._code=pn(h,e),o.push(h)):(l._code&c&&((h=hn(l,s,c,e,n))._code=pn(h,e),o.push(h)),o.push(s));t=o}return t}var bn=(Object.freeze||Object)({clipPolygon:vn}),_n={project:function(t){return new A(t.lng,t.lat)},unproject:function(t){return new B(t.y,t.x)},bounds:new R([-180,-90],[180,90])},wn={R:6378137,R_MINOR:6356752.314245179,bounds:new R([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,o=t.lat*e,r=this.R_MINOR/n,i=Math.sqrt(1-r*r),a=i*Math.sin(o),s=Math.tan(Math.PI/4-o/2)/Math.pow((1-a)/(1+a),i/2);return o=-n*Math.log(Math.max(s,1e-10)),new A(t.lng*e*n,o)},unproject:function(t){for(var e,n=180/Math.PI,o=this.R,r=this.R_MINOR/o,i=Math.sqrt(1-r*r),a=Math.exp(-t.y/o),s=Math.PI/2-2*Math.atan(a),l=0,u=.1;l<15&&Math.abs(u)>1e-7;l++)e=i*Math.sin(s),e=Math.pow((1-e)/(1+e),i/2),s+=u=Math.PI/2-2*Math.atan(a*e)-s;return new B(s*n,t.x*n/o)}},En=(Object.freeze||Object)({LonLat:_n,Mercator:wn,SphericalMercator:$}),kn=n({},q,{code:"EPSG:3395",projection:wn,transformation:function(){var t=.5/(Math.PI*wn.R);return H(t,.5,-t,.5)}()}),Sn=n({},q,{code:"EPSG:4326",projection:_n,transformation:H(1/180,1,-1/180,.5)}),xn=n({},Z,{projection:_n,transformation:H(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,o=e.lat-t.lat;return Math.sqrt(n*n+o*o)},infinite:!0});Z.Earth=q,Z.EPSG3395=kn,Z.EPSG3857=V,Z.EPSG900913=G,Z.EPSG4326=Sn,Z.Simple=xn;var Pn=j.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[a(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[a(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",(function(){e.off(n,this)}),this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});He.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=a(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=a(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&a(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?g(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[a(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=a(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var o in this._zoomBoundLayers){var r=this._zoomBoundLayers[o].options;t=void 0===r.minZoom?t:Math.min(t,r.minZoom),e=void 0===r.maxZoom?e:Math.max(e,r.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Tn=Pn.extend({initialize:function(t,e){var n,o;if(f(this,e),this._layers={},t)for(n=0,o=t.length;n<o;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,o=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,o);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return a(t)}}),On=Tn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Tn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Tn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new z;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),Cn=O.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){f(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var o=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(o,t),o},_setIconStyles:function(t,e){var n=this.options,o=n[e+"Size"];"number"==typeof o&&(o=[o,o]);var r=I(o),i=I("shadow"===e&&n.shadowAnchor||n.iconAnchor||r&&r.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return xt&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});var jn=Cn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return jn.imagePath||(jn.imagePath=this._detectIconPath()),(this.options.imagePath||jn.imagePath)+Cn.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=Se("div","leaflet-default-icon-path",document.body),e=ke(t,"background-image")||ke(t,"backgroundImage");return document.body.removeChild(t),null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Ln=Xe.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new an(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),je(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Le(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,o=this._marker.options.autoPanSpeed,r=this._marker.options.autoPanPadding,i=L.DomUtil.getPosition(e._icon),a=n.getPixelBounds(),s=n.getPixelOrigin(),l=M(a.min._subtract(s).add(r),a.max._subtract(s).subtract(r));if(!l.contains(i)){var u=I((Math.max(l.max.x,i.x)-l.max.x)/(a.max.x-l.max.x)-(Math.min(l.min.x,i.x)-l.min.x)/(a.min.x-l.min.x),(Math.max(l.max.y,i.y)-l.max.y)/(a.max.y-l.max.y)-(Math.min(l.min.y,i.y)-l.min.y)/(a.min.y-l.min.y)).multiplyBy(o);n.panBy(u,{animate:!1}),this._draggable._newPos._add(u),this._draggable._startPos._add(u),L.DomUtil.setPosition(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=x(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(P(this._panRequest),this._panRequest=x(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,o=Fe(e._icon),r=e._map.layerPointToLatLng(o);n&&ze(n,o),e._latlng=r,t.latlng=r,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){P(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),An=Pn.extend({options:{icon:new jn,interactive:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},initialize:function(t,e){f(this,e),this._latlng=D(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=D(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),o=!1;n!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(n.title=t.title),"IMG"===n.tagName&&(n.alt=t.alt||"")),je(n,e),t.keyboard&&(n.tabIndex="0"),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var r=t.icon.createShadow(this._shadow),i=!1;r!==this._shadow&&(this._removeShadow(),i=!0),r&&(je(r,e),r.alt=""),this._shadow=r,t.opacity<1&&this._updateOpacity(),o&&this.getPane().appendChild(this._icon),this._initInteraction(),r&&i&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),xe(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&xe(this._shadow),this._shadow=null},_setPos:function(t){ze(this._icon,t),this._shadow&&ze(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(je(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ln)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ln(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;Ie(this._icon,t),this._shadow&&Ie(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});var Nn=Pn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return f(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),In=Nn.extend({options:{fill:!0,radius:10},initialize:function(t,e){f(this,e),this._latlng=D(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=D(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Nn.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),o=[t+n,e+n];this._pxBounds=new R(this._point.subtract(o),this._point.add(o))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});var Rn=In.extend({initialize:function(t,e,o){if("number"==typeof e&&(e=n({},o,{radius:e})),f(this,e),this._latlng=D(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new z(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Nn.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,o=n.options.crs;if(o.distance===q.distance){var r=Math.PI/180,i=this._mRadius/q.R/r,a=n.project([e+i,t]),s=n.project([e-i,t]),l=a.add(s).divideBy(2),u=n.unproject(l).lat,c=Math.acos((Math.cos(i*r)-Math.sin(e*r)*Math.sin(u*r))/(Math.cos(e*r)*Math.cos(u*r)))/r;(isNaN(c)||0===c)&&(c=i/Math.cos(Math.PI/180*e)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(c)?0:l.x-n.project([u,t-c]).x,this._radiusY=l.y-a.y}else{var h=o.unproject(o.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(h).x}this._updateBounds()}});var Mn=Nn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){f(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,o=1/0,r=null,i=dn,a=0,s=this._parts.length;a<s;a++)for(var l=this._parts[a],u=1,c=l.length;u<c;u++){var h=i(t,e=l[u-1],n=l[u],!0);h<o&&(o=h,r=i(t,e,n))}return r&&(r.distance=Math.sqrt(o)),r},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,o,r,i,a,s=this._rings[0],l=s.length;if(!l)return null;for(t=0,e=0;t<l-1;t++)e+=s[t].distanceTo(s[t+1])/2;if(0===e)return this._map.layerPointToLatLng(s[0]);for(t=0,o=0;t<l-1;t++)if(r=s[t],i=s[t+1],(o+=n=r.distanceTo(i))>e)return a=(o-e)/n,this._map.layerPointToLatLng([i.x-a*(i.x-r.x),i.y-a*(i.y-r.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=D(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new z,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return mn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=mn(t),o=0,r=t.length;o<r;o++)n?(e[o]=D(t[o]),this._bounds.extend(e[o])):e[o]=this._convertLatLngs(t[o]);return e},_project:function(){var t=new R;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),n=new A(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(n),t.max._add(n),this._pxBounds=t)},_projectLatlngs:function(t,e,n){var o,r,i=t[0]instanceof B,a=t.length;if(i){for(r=[],o=0;o<a;o++)r[o]=this._map.latLngToLayerPoint(t[o]),n.extend(r[o]);e.push(r)}else for(o=0;o<a;o++)this._projectLatlngs(t[o],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,o,r,i,a,s,l=this._parts;for(e=0,o=0,r=this._rings.length;e<r;e++)for(n=0,i=(s=this._rings[e]).length;n<i-1;n++)(a=cn(s[n],s[n+1],t,n,!0))&&(l[o]=l[o]||[],l[o].push(a[0]),a[1]===s[n+1]&&n!==i-2||(l[o].push(a[1]),o++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,o=t.length;n<o;n++)t[n]=sn(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,o,r,i,a,s,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,i=this._parts.length;n<i;n++)for(o=0,r=(a=(s=this._parts[n]).length)-1;o<a;r=o++)if((e||0!==o)&&ln(t,s[r],s[o])<=l)return!0;return!1}});Mn._flat=yn;var zn=Mn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,o,r,i,a,s,l,u=this._rings[0],c=u.length;if(!c)return null;for(i=a=s=0,t=0,e=c-1;t<c;e=t++)n=u[t],o=u[e],r=n.y*o.x-o.y*n.x,a+=(n.x+o.x)*r,s+=(n.y+o.y)*r,i+=3*r;return l=0===i?u[0]:[a/i,s/i],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=Mn.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof B&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){Mn.prototype._setLatLngs.call(this,t),mn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return mn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new A(e,e);if(t=new R(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var o,r=0,i=this._rings.length;r<i;r++)(o=vn(this._rings[r],t,!0)).length&&this._parts.push(o)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,o,r,i,a,s,l,u=!1;if(!this._pxBounds.contains(t))return!1;for(r=0,s=this._parts.length;r<s;r++)for(i=0,a=(l=(e=this._parts[r]).length)-1;i<l;a=i++)n=e[i],o=e[a],n.y>t.y!=o.y>t.y&&t.x<(o.x-n.x)*(t.y-n.y)/(o.y-n.y)+n.x&&(u=!u);return u||Mn.prototype._containsPoint.call(this,t,!0)}});var Fn=On.extend({initialize:function(t,e){f(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,o,r=g(t)?t:t.features;if(r){for(e=0,n=r.length;e<n;e++)((o=r[e]).geometries||o.geometry||o.features||o.coordinates)&&this.addData(o);return this}var i=this.options;if(i.filter&&!i.filter(t))return this;var a=Bn(t,i);return a?(a.feature=Wn(t),a.defaultOptions=a.options,this.resetStyle(a),i.onEachFeature&&i.onEachFeature(t,a),this.addLayer(a)):this},resetStyle:function(t){return t.options=n({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}});function Bn(t,e){var n,o,r,i,a="Feature"===t.type?t.geometry:t,s=a?a.coordinates:null,l=[],u=e&&e.pointToLayer,c=e&&e.coordsToLatLng||Dn;if(!s&&!a)return null;switch(a.type){case"Point":return n=c(s),u?u(t,n):new An(n);case"MultiPoint":for(r=0,i=s.length;r<i;r++)n=c(s[r]),l.push(u?u(t,n):new An(n));return new On(l);case"LineString":case"MultiLineString":return o=Un(s,"LineString"===a.type?0:1,c),new Mn(o,e);case"Polygon":case"MultiPolygon":return o=Un(s,"Polygon"===a.type?1:2,c),new zn(o,e);case"GeometryCollection":for(r=0,i=a.geometries.length;r<i;r++){var h=Bn({geometry:a.geometries[r],type:"Feature",properties:t.properties},e);h&&l.push(h)}return new On(l);default:throw new Error("Invalid GeoJSON object.")}}function Dn(t){return new B(t[1],t[0],t[2])}function Un(t,e,n){for(var o,r=[],i=0,a=t.length;i<a;i++)o=e?Un(t[i],e-1,n):(n||Dn)(t[i]),r.push(o);return r}function Zn(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[c(t.lng,e),c(t.lat,e),c(t.alt,e)]:[c(t.lng,e),c(t.lat,e)]}function qn(t,e,n,o){for(var r=[],i=0,a=t.length;i<a;i++)r.push(e?qn(t[i],e-1,n,o):Zn(t[i],o));return!e&&n&&r.push(r[0]),r}function $n(t,e){return t.feature?n({},t.feature,{geometry:e}):Wn(e)}function Wn(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Hn={toGeoJSON:function(t){return $n(this,{type:"Point",coordinates:Zn(this.getLatLng(),t)})}};function Vn(t,e){return new Fn(t,e)}An.include(Hn),Rn.include(Hn),In.include(Hn),Mn.include({toGeoJSON:function(t){var e=!mn(this._latlngs);return $n(this,{type:(e?"Multi":"")+"LineString",coordinates:qn(this._latlngs,e?1:0,!1,t)})}}),zn.include({toGeoJSON:function(t){var e=!mn(this._latlngs),n=e&&!mn(this._latlngs[0]),o=qn(this._latlngs,n?2:e?1:0,!0,t);return e||(o=[o]),$n(this,{type:(n?"Multi":"")+"Polygon",coordinates:o})}}),Tn.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(n){e.push(n.toGeoJSON(t).geometry.coordinates)})),$n(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,o=[];return this.eachLayer((function(e){if(e.toGeoJSON){var r=e.toGeoJSON(t);if(n)o.push(r.geometry);else{var i=Wn(r);"FeatureCollection"===i.type?o.push.apply(o,i.features):o.push(i)}}})),n?$n(this,{geometries:o,type:"GeometryCollection"}):{type:"FeatureCollection",features:o}}});var Gn=Vn,Yn=Pn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=F(e),f(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(je(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){xe(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&Te(this._image),this},bringToBack:function(){return this._map&&Oe(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=F(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:Se("img");je(e,"leaflet-image-layer"),this._zoomAnimated&&je(e,"leaflet-zoom-animated"),this.options.className&&je(e,this.options.className),e.onselectstart=u,e.onmousemove=u,e.onload=r(this.fire,this,"load"),e.onerror=r(this._overlayOnError,this,"error"),this.options.crossOrigin&&(e.crossOrigin=""),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Me(this._image,n,e)},_reset:function(){var t=this._image,e=new R(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();ze(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){Ie(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Kn=Yn.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:Se("video");if(je(e,"leaflet-image-layer"),this._zoomAnimated&&je(e,"leaflet-zoom-animated"),e.onselectstart=u,e.onmousemove=u,e.onloadeddata=r(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),o=[],i=0;i<n.length;i++)o.push(n[i].src);this._url=n.length>0?o:[e.src]}else{g(this._url)||(this._url=[this._url]),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop;for(var a=0;a<this._url.length;a++){var s=Se("source");s.src=this._url[a],e.appendChild(s)}}}});var Qn=Pn.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){f(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Ie(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Ie(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(Ie(this._container,0),this._removeTimeout=setTimeout(r(xe,void 0,this._container),200)):xe(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=D(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Te(this._container),this},bringToBack:function(){return this._map&&Oe(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=I(this.options.offset),n=this._getAnchor();this._zoomAnimated?ze(this._container,t.add(n)):e=e.add(t).add(n);var o=this._containerBottom=-e.y,r=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=o+"px",this._container.style.left=r+"px"}},_getAnchor:function(){return[0,0]}}),Jn=Qn.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){Qn.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Nn||this._source.on("preclick",te))},onRemove:function(t){Qn.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Nn||this._source.off("preclick",te))},getEvents:function(){var t=Qn.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=Se("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=Se("div",t+"-content-wrapper",e);if(this._contentNode=Se("div",t+"-content",n),ne(n),ee(this._contentNode),Yt(n,"contextmenu",te),this._tipContainer=Se("div",t+"-tip-container",e),this._tip=Se("div",t+"-tip",this._tipContainer),this.options.closeButton){var o=this._closeButton=Se("a",t+"-close-button",e);o.href="#close",o.innerHTML="&#215;",Yt(o,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var o=t.offsetHeight,r=this.options.maxHeight,i="leaflet-popup-scrolled";r&&o>r?(e.height=r+"px",je(t,i)):Le(t,i),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();ze(this._container,e.add(n))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(ke(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,o=this._containerWidth,r=new A(this._containerLeft,-n-this._containerBottom);r._add(Fe(this._container));var i=t.layerPointToContainerPoint(r),a=I(this.options.autoPanPadding),s=I(this.options.autoPanPaddingTopLeft||a),l=I(this.options.autoPanPaddingBottomRight||a),u=t.getSize(),c=0,h=0;i.x+o+l.x>u.x&&(c=i.x+o-u.x+l.x),i.x-c-s.x<0&&(c=i.x-s.x),i.y+n+l.y>u.y&&(h=i.y+n-u.y+l.y),i.y-h-s.y<0&&(h=i.y-s.y),(c||h)&&t.fire("autopanstart").panBy([c,h])}},_onCloseButtonClick:function(t){this._close(),re(t)},_getAnchor:function(){return I(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});He.mergeOptions({closePopupOnClick:!0}),He.include({openPopup:function(t,e,n){return t instanceof Jn||(t=new Jn(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),Pn.include({bindPopup:function(t,e){return t instanceof Jn?(f(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new Jn(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof Pn||(e=t,t=this),t instanceof On)for(var n in this._layers){t=this._layers[n];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(re(t),e instanceof Nn?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var Xn=Qn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){Qn.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){Qn.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=Qn.prototype.getEvents.call(this);return Et&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Se("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,n=this._container,o=e.latLngToContainerPoint(e.getCenter()),r=e.layerPointToContainerPoint(t),i=this.options.direction,a=n.offsetWidth,s=n.offsetHeight,l=I(this.options.offset),u=this._getAnchor();"top"===i?t=t.add(I(-a/2+l.x,-s+l.y+u.y,!0)):"bottom"===i?t=t.subtract(I(a/2-l.x,-l.y,!0)):"center"===i?t=t.subtract(I(a/2+l.x,s/2-u.y+l.y,!0)):"right"===i||"auto"===i&&r.x<o.x?(i="right",t=t.add(I(l.x+u.x,u.y-s/2+l.y,!0))):(i="left",t=t.subtract(I(a+u.x-l.x,s/2-u.y-l.y,!0))),Le(n,"leaflet-tooltip-right"),Le(n,"leaflet-tooltip-left"),Le(n,"leaflet-tooltip-top"),Le(n,"leaflet-tooltip-bottom"),je(n,"leaflet-tooltip-"+i),ze(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Ie(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return I(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});He.include({openTooltip:function(t,e,n){return t instanceof Xn||(t=new Xn(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),Pn.include({bindTooltip:function(t,e){return t instanceof Xn?(f(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new Xn(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),Et&&(n.click=this._openTooltip)),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof Pn||(e=t,t=this),t instanceof On)for(var n in this._layers){t=this._layers[n];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(je(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(Le(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,n,o=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),o=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(o)}});var to=Cn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var o=I(n.bgPos);e.style.backgroundPosition=-o.x+"px "+-o.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});Cn.Default=jn;var eo=Pn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:gt,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){f(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),xe(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Te(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Oe(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=s(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof A?t:new A(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,o=-t(-1/0,1/0),r=0,i=n.length;r<i;r++)e=n[r].style.zIndex,n[r]!==this._container&&e&&(o=t(o,+e));isFinite(o)&&(this.options.zIndex=o+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!X){Ie(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var o in this._tiles){var r=this._tiles[o];if(r.current&&r.loaded){var i=Math.min(1,(t-r.loaded)/200);Ie(r.el,i),i<1?e=!0:(r.active?n=!0:this._onOpaqueTile(r),r.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(P(this._fadeFrame),this._fadeFrame=x(this._updateOpacity,this))}},_onOpaqueTile:u,_initContainer:function(){this._container||(this._container=Se("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(xe(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var o=this._levels[t],r=this._map;return o||((o=this._levels[t]={}).el=Se("div","leaflet-tile-container leaflet-zoom-animated",this._container),o.el.style.zIndex=e,o.origin=r.project(r.unproject(r.getPixelOrigin()),t).round(),o.zoom=t,this._setZoomTransform(o,r.getCenter(),r.getZoom()),o.el.offsetWidth,this._onCreateLevel(o)),this._level=o,o}},_onUpdateLevel:u,_onRemoveLevel:u,_onCreateLevel:u,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var o=e.coords;this._retainParent(o.x,o.y,o.z,o.z-5)||this._retainChildren(o.x,o.y,o.z,o.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)xe(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,o){var r=Math.floor(t/2),i=Math.floor(e/2),a=n-1,s=new A(+r,+i);s.z=+a;var l=this._tileCoordsToKey(s),u=this._tiles[l];return u&&u.active?(u.retain=!0,!0):(u&&u.loaded&&(u.retain=!0),a>o&&this._retainParent(r,i,a,o))},_retainChildren:function(t,e,n,o){for(var r=2*t;r<2*t+2;r++)for(var i=2*e;i<2*e+2;i++){var a=new A(r,i);a.z=n+1;var s=this._tileCoordsToKey(a),l=this._tiles[s];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<o&&this._retainChildren(r,i,n+1,o))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,o){var r=this._clampZoom(Math.round(e));(void 0!==this.options.maxZoom&&r>this.options.maxZoom||void 0!==this.options.minZoom&&r<this.options.minZoom)&&(r=void 0);var i=this.options.updateWhenZooming&&r!==this._tileZoom;o&&!i||(this._tileZoom=r,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==r&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var o=this._map.getZoomScale(n,t.zoom),r=t.origin.multiplyBy(o).subtract(this._map._getNewPixelOrigin(e,n)).round();yt?Me(t.el,r,o):ze(t.el,r)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),o=this._tileZoom,r=this._map.getPixelWorldBounds(this._tileZoom);r&&(this._globalTileRange=this._pxBoundsToTileRange(r)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],o).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],o).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],o).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],o).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),o=e.getZoomScale(n,this._tileZoom),r=e.project(t,this._tileZoom).floor(),i=e.getSize().divideBy(2*o);return new R(r.subtract(i),r.add(i))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var o=this._getTiledPixelBounds(t),r=this._pxBoundsToTileRange(o),i=r.getCenter(),a=[],s=this.options.keepBuffer,l=new R(r.getBottomLeft().subtract([s,-s]),r.getTopRight().add([s,-s]));if(!(isFinite(r.min.x)&&isFinite(r.min.y)&&isFinite(r.max.x)&&isFinite(r.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var u in this._tiles){var c=this._tiles[u].coords;c.z===this._tileZoom&&l.contains(new A(c.x,c.y))||(this._tiles[u].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(t,n);else{for(var h=r.min.y;h<=r.max.y;h++)for(var p=r.min.x;p<=r.max.x;p++){var f=new A(p,h);if(f.z=this._tileZoom,this._isValidTile(f)){var d=this._tiles[this._tileCoordsToKey(f)];d?d.current=!0:a.push(f)}}if(a.sort((function(t,e){return t.distanceTo(i)-e.distanceTo(i)})),0!==a.length){this._loading||(this._loading=!0,this.fire("loading"));var m=document.createDocumentFragment();for(p=0;p<a.length;p++)this._addTile(a[p],m);this._level.el.appendChild(m)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var o=this._tileCoordsToBounds(t);return F(this.options.bounds).overlaps(o)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),o=t.scaleBy(n),r=o.add(n);return[e.unproject(o,t.z),e.unproject(r,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new z(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new A(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(it||e.el.setAttribute("src",b),xe(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){je(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=u,t.onmousemove=u,X&&this.options.opacity<1&&Ie(t,this.options.opacity),nt&&!ot&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var n=this._getTilePos(t),o=this._tileCoordsToKey(t),i=this.createTile(this._wrapCoords(t),r(this._tileReady,this,t));this._initTile(i),this.createTile.length<2&&x(r(this._tileReady,this,t,null,i)),ze(i,n),this._tiles[o]={el:i,coords:t,current:!0},e.appendChild(i),this.fire("tileloadstart",{tile:i,coords:t})},_tileReady:function(t,e,n){if(this._map){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var o=this._tileCoordsToKey(t);(n=this._tiles[o])&&(n.loaded=+new Date,this._map._fadeAnimated?(Ie(n.el,0),P(this._fadeFrame),this._fadeFrame=x(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(je(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),X||!this._map._fadeAnimated?x(this._pruneTiles,this):setTimeout(r(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new A(this._wrapX?l(t.x,this._wrapX):t.x,this._wrapY?l(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new R(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});var no=eo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=f(this,e)).detectRetina&&xt&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),nt||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return Yt(n,"load",r(this._tileOnLoad,this,e,n)),Yt(n,"error",r(this._tileOnError,this,e,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:xt?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var o=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=o),e["-y"]=o}return y(this._url,n(e,this.options))},_tileOnLoad:function(t,e){X?setTimeout(r(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var o=this.options.errorTileUrl;o&&e.getAttribute("src")!==o&&(e.src=o),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=u,e.onerror=u,e.complete||(e.src=b,xe(e),delete this._tiles[t]))}});function oo(t,e){return new no(t,e)}var ro=no.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var o=n({},this.defaultWmsParams);for(var r in e)r in this.options||(o[r]=e[r]);var i=(e=f(this,e)).detectRetina&&xt?2:1,a=this.getTileSize();o.width=a.x*i,o.height=a.y*i,this.wmsParams=o},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,no.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,o=M(n.project(e[0]),n.project(e[1])),r=o.min,i=o.max,a=(this._wmsVersion>=1.3&&this._crs===Sn?[r.y,r.x,i.y,i.x]:[r.x,r.y,i.x,i.y]).join(","),s=L.TileLayer.prototype.getTileUrl.call(this,t);return s+d(this.wmsParams,s,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+a},setParams:function(t,e){return n(this.wmsParams,t),e||this.redraw(),this}});no.WMS=ro,oo.wms=function(t,e){return new ro(t,e)};var io=Pn.extend({options:{padding:.1,tolerance:0},initialize:function(t){f(this,t),a(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&je(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),o=Fe(this._container),r=this._map.getSize().multiplyBy(.5+this.options.padding),i=this._map.project(this._center,e),a=this._map.project(t,e).subtract(i),s=r.multiplyBy(-n).add(o).add(r).subtract(a);yt?Me(this._container,s,n):ze(this._container,s)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new R(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ao=io.extend({getEvents:function(){var t=io.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){io.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Yt(t,"mousemove",s(this._onMouseMove,32,this),this),Yt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Yt(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){delete this._ctx,xe(this._container),Qt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},io.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),o=xt?2:1;ze(e,t.min),e.width=o*n.x,e.height=o*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",xt&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){io.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[a(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,o=e.prev;n?n.prev=o:this._drawLast=o,o?o.next=n:this._drawFirst=n,delete t._order,delete this._layers[L.stamp(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,n=t.options.dashArray.split(","),o=[];for(e=0;e<n.length;e++)o.push(Number(n[e]));t.options._dashArray=o}},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||x(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new R,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var o=this._drawFirst;o;o=o.next)t=o.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,o,r,i,a=t._parts,s=a.length,l=this._ctx;if(s){for(this._drawnLayers[t._leaflet_id]=t,l.beginPath(),n=0;n<s;n++){for(o=0,r=a[n].length;o<r;o++)i=a[n][o],l[o?"lineTo":"moveTo"](i.x,i.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,o=Math.max(Math.round(t._radius),1),r=(Math.max(Math.round(t._radiusY),1)||o)/o;this._drawnLayers[t._leaflet_id]=t,1!==r&&(n.save(),n.scale(1,r)),n.beginPath(),n.arc(e.x,e.y/r,o,0,2*Math.PI,!1),1!==r&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,o=this._map.mouseEventToLayerPoint(t),r=this._drawFirst;r;r=r.next)(e=r.layer).options.interactive&&e._containsPoint(o)&&!this._map._draggableMoved(e)&&(n=e);n&&(ce(t),this._fireEvent([n],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(Le(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){for(var n,o,r=this._drawFirst;r;r=r.next)(n=r.layer).options.interactive&&n._containsPoint(e)&&(o=n);o!==this._hoveredLayer&&(this._handleMouseOut(t),o&&(je(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseover"),this._hoveredLayer=o)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order,n=e.next,o=e.prev;n&&(n.prev=o,o?o.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))},_bringToBack:function(t){var e=t._order,n=e.next,o=e.prev;o&&(o.next=n,n?n.prev=o:o&&(this._drawLast=o),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}});function so(t){return Pt?new ao(t):null}var lo=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),uo={_initContainer:function(){this._container=Se("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(io.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=lo("shape");je(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=lo("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[a(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;xe(e),t.removeInteractiveTarget(e),delete this._layers[a(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,o=t.options,r=t._container;r.stroked=!!o.stroke,r.filled=!!o.fill,o.stroke?(e||(e=t._stroke=lo("stroke")),r.appendChild(e),e.weight=o.weight+"px",e.color=o.color,e.opacity=o.opacity,o.dashArray?e.dashStyle=g(o.dashArray)?o.dashArray.join(" "):o.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=o.lineCap.replace("butt","flat"),e.joinstyle=o.lineJoin):e&&(r.removeChild(e),t._stroke=null),o.fill?(n||(n=t._fill=lo("fill")),r.appendChild(n),n.color=o.fillColor||o.color,n.opacity=o.fillOpacity):n&&(r.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),o=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+o+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){Te(t._container)},_bringToBack:function(t){Oe(t._container)}},co=Ot?lo:Y,ho=io.extend({getEvents:function(){var t=io.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=co("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=co("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){xe(this._container),Qt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){io.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),ze(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=co("path");t.options.className&&je(e,t.options.className),t.options.interactive&&je(e,"leaflet-interactive"),this._updateStyle(t),this._layers[a(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){xe(t._path),t.removeInteractiveTarget(t._path),delete this._layers[a(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,K(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),o="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",r=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+o+2*n+",0 "+o+2*-n+",0 ";this._setPath(t,r)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){Te(t._path)},_bringToBack:function(t){Oe(t._path)}});function po(t){return Tt||Ot?new ho(t):null}Ot&&ho.include(uo),He.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&so()||po()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=ho&&po({pane:t})||ao&&so({pane:t}),this._paneRenderers[t]=e),e}});var fo=zn.extend({initialize:function(t,e){zn.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=F(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});ho.create=co,ho.pointsToPath=K,Fn.geometryToLayer=Bn,Fn.coordsToLatLng=Dn,Fn.coordsToLatLngs=Un,Fn.latLngToCoords=Zn,Fn.latLngsToCoords=qn,Fn.getFeature=$n,Fn.asFeature=Wn,He.mergeOptions({boxZoom:!0});var mo=Xe.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Yt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Qt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){xe(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),fe(),De(),this._startPoint=this._map.mouseEventToContainerPoint(t),Yt(document,{contextmenu:re,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Se("div","leaflet-zoom-box",this._container),je(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new R(this._point,this._startPoint),n=e.getSize();ze(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(xe(this._box),Le(this._container,"leaflet-crosshair")),de(),Ue(),Qt(document,{contextmenu:re,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(r(this._resetState,this),0);var e=new z(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});He.addInitHook("addHandler","boxZoom",mo),He.mergeOptions({doubleClickZoom:!0});var yo=Xe.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),o=e.options.zoomDelta,r=t.originalEvent.shiftKey?n-o:n+o;"center"===e.options.doubleClickZoom?e.setZoom(r):e.setZoomAround(t.containerPoint,r)}});He.addInitHook("addHandler","doubleClickZoom",yo),He.mergeOptions({dragging:!0,inertia:!ot,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var go=Xe.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new an(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}je(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Le(this._map._container,"leaflet-grab"),Le(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=F(this._map.options.maxBounds);this._offsetLimit=M(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,o=this._draggable._newPos.x,r=(o-e+n)%t+e-n,i=(o+e+n)%t-e-n,a=Math.abs(r+n)<Math.abs(i+n)?r:i;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=a},_onDragEnd:function(t){var e=this._map,n=e.options,o=!n.inertia||this._times.length<2;if(e.fire("dragend",t),o)e.fire("moveend");else{this._prunePositions(+new Date);var r=this._lastPos.subtract(this._positions[0]),i=(this._lastTime-this._times[0])/1e3,a=n.easeLinearity,s=r.multiplyBy(a/i),l=s.distanceTo([0,0]),u=Math.min(n.inertiaMaxSpeed,l),c=s.multiplyBy(u/l),h=u/(n.inertiaDeceleration*a),p=c.multiplyBy(-h/2).round();p.x||p.y?(p=e._limitOffset(p,e.options.maxBounds),x((function(){e.panBy(p,{duration:h,easeLinearity:a,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});He.addInitHook("addHandler","dragging",go),He.mergeOptions({keyboard:!0,keyboardPanDelta:80});var vo=Xe.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Yt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Qt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,o=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(o,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,o=this._panKeys={},r=this.keyCodes;for(e=0,n=r.left.length;e<n;e++)o[r.left[e]]=[-1*t,0];for(e=0,n=r.right.length;e<n;e++)o[r.right[e]]=[t,0];for(e=0,n=r.down.length;e<n;e++)o[r.down[e]]=[0,t];for(e=0,n=r.up.length;e<n;e++)o[r.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,o=this._zoomKeys={},r=this.keyCodes;for(e=0,n=r.zoomIn.length;e<n;e++)o[r.zoomIn[e]]=t;for(e=0,n=r.zoomOut.length;e<n;e++)o[r.zoomOut[e]]=-t},_addHooks:function(){Yt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Qt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,o=this._map;if(n in this._panKeys){if(o._panAnim&&o._panAnim._inProgress)return;e=this._panKeys[n],t.shiftKey&&(e=I(e).multiplyBy(3)),o.panBy(e),o.options.maxBounds&&o.panInsideBounds(o.options.maxBounds)}else if(n in this._zoomKeys)o.setZoom(o.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!o._popup||!o._popup.options.closeOnEscapeKey)return;o.closePopup()}re(t)}}});He.addInitHook("addHandler","keyboard",vo),He.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var bo=Xe.extend({addHooks:function(){Yt(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Qt(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=se(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var o=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(r(this._performZoom,this),o),re(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var o=this._delta/(4*this._map.options.wheelPxPerZoomLevel),r=4*Math.log(2/(1+Math.exp(-Math.abs(o))))/Math.LN2,i=n?Math.ceil(r/n)*n:r,a=t._limitZoom(e+(this._delta>0?i:-i))-e;this._delta=0,this._startTime=null,a&&("center"===t.options.scrollWheelZoom?t.setZoom(e+a):t.setZoomAround(this._lastMousePos,e+a))}});He.addInitHook("addHandler","scrollWheelZoom",bo),He.mergeOptions({tap:!0,tapTolerance:15});var _o=Xe.extend({addHooks:function(){Yt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Qt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(oe(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new A(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&je(n,"leaflet-active"),this._holdTimeout=setTimeout(r((function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))}),this),1e3),this._simulateEvent("mousedown",e),Yt(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),Qt(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&Le(n,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new A(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var n=document.createEvent("MouseEvents");n._simulated=!0,e.target._simulatedClick=!0,n.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}});Et&&!wt&&He.addInitHook("addHandler","tap",_o),He.mergeOptions({touchZoom:Et&&!ot,bounceAtZoomLimits:!0});var wo=Xe.extend({addHooks:function(){je(this._map._container,"leaflet-touch-zoom"),Yt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Le(this._map._container,"leaflet-touch-zoom"),Qt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(o)._divideBy(2))),this._startDist=n.distanceTo(o),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Yt(document,"touchmove",this._onTouchMove,this),Yt(document,"touchend",this._onTouchEnd,this),oe(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),o=e.mouseEventToContainerPoint(t.touches[1]),i=n.distanceTo(o)/this._startDist;if(this._zoom=e.getScaleZoom(i,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&i<1||this._zoom>e.getMaxZoom()&&i>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===i)return}else{var a=n._add(o)._divideBy(2)._subtract(this._centerPoint);if(1===i&&0===a.x&&0===a.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(a),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),P(this._animRequest);var s=r(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=x(s,this,!0),oe(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,P(this._animRequest),Qt(document,"touchmove",this._onTouchMove),Qt(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});He.addInitHook("addHandler","touchZoom",wo),He.BoxZoom=mo,He.DoubleClickZoom=yo,He.Drag=go,He.Keyboard=vo,He.ScrollWheelZoom=bo,He.Tap=_o,He.TouchZoom=wo;var Eo=window.L;window.L=t,Object.freeze=e,t.version="1.3.1",t.noConflict=function(){return window.L=Eo,this},t.Control=Ve,t.control=Ge,t.Browser=jt,t.Evented=j,t.Mixin=en,t.Util=T,t.Class=O,t.Handler=Xe,t.extend=n,t.bind=r,t.stamp=a,t.setOptions=f,t.DomEvent=ve,t.DomUtil=$e,t.PosAnimation=We,t.Draggable=an,t.LineUtil=gn,t.PolyUtil=bn,t.Point=A,t.point=I,t.Bounds=R,t.bounds=M,t.Transformation=W,t.transformation=H,t.Projection=En,t.LatLng=B,t.latLng=D,t.LatLngBounds=z,t.latLngBounds=F,t.CRS=Z,t.GeoJSON=Fn,t.geoJSON=Vn,t.geoJson=Gn,t.Layer=Pn,t.LayerGroup=Tn,t.layerGroup=function(t,e){return new Tn(t,e)},t.FeatureGroup=On,t.featureGroup=function(t){return new On(t)},t.ImageOverlay=Yn,t.imageOverlay=function(t,e,n){return new Yn(t,e,n)},t.VideoOverlay=Kn,t.videoOverlay=function(t,e,n){return new Kn(t,e,n)},t.DivOverlay=Qn,t.Popup=Jn,t.popup=function(t,e){return new Jn(t,e)},t.Tooltip=Xn,t.tooltip=function(t,e){return new Xn(t,e)},t.Icon=Cn,t.icon=function(t){return new Cn(t)},t.DivIcon=to,t.divIcon=function(t){return new to(t)},t.Marker=An,t.marker=function(t,e){return new An(t,e)},t.TileLayer=no,t.tileLayer=oo,t.GridLayer=eo,t.gridLayer=function(t){return new eo(t)},t.SVG=ho,t.svg=po,t.Renderer=io,t.Canvas=ao,t.canvas=so,t.Path=Nn,t.CircleMarker=In,t.circleMarker=function(t,e){return new In(t,e)},t.Circle=Rn,t.circle=function(t,e,n){return new Rn(t,e,n)},t.Polyline=Mn,t.polyline=function(t,e){return new Mn(t,e)},t.Polygon=zn,t.polygon=function(t,e){return new zn(t,e)},t.Rectangle=fo,t.rectangle=function(t,e){return new fo(t,e)},t.Map=He,t.map=function(t,e){return new He(t,e)}}(e)},5228:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(t){o[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}()?Object.assign:function(t,r){for(var i,a,s=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),l=1;l<arguments.length;l++){for(var u in i=Object(arguments[l]))n.call(i,u)&&(s[u]=i[u]);if(e){a=e(i);for(var c=0;c<a.length;c++)o.call(i,a[c])&&(s[a[c]]=i[a[c]])}}return s}},8875:(t,e,n)=>{"use strict";var o;if(!Object.keys){var r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=n(1093),s=Object.prototype.propertyIsEnumerable,l=!s.call({toString:null},"toString"),u=s.call((function(){}),"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(t){var e=t.constructor;return e&&e.prototype===t},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!p["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{h(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();o=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===i.call(t),o=a(t),s=e&&"[object String]"===i.call(t),p=[];if(!e&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var d=u&&n;if(s&&t.length>0&&!r.call(t,0))for(var m=0;m<t.length;++m)p.push(String(m));if(o&&t.length>0)for(var y=0;y<t.length;++y)p.push(String(y));else for(var g in t)d&&"prototype"===g||!r.call(t,g)||p.push(String(g));if(l)for(var v=function(t){if("undefined"==typeof window||!f)return h(t);try{return h(t)}catch(t){return!1}}(t),b=0;b<c.length;++b)v&&"constructor"===c[b]||!r.call(t,c[b])||p.push(c[b]);return p}}t.exports=o},1189:(t,e,n)=>{"use strict";var o=Array.prototype.slice,r=n(1093),i=Object.keys,a=i?function(t){return i(t)}:n(8875),s=Object.keys;a.shim=function(){if(Object.keys){var t=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);t||(Object.keys=function(t){return r(t)?s(o.call(t)):s(t)})}else Object.keys=a;return Object.keys||a},t.exports=a},1093:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){var n=e.call(t),o="[object Arguments]"===n;return o||(o="[object Array]"!==n&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),o}},7446:(t,e,n)=>{"use strict";var o=n(5388),r=n(8075),i=r("Object.prototype.propertyIsEnumerable"),a=r("Array.prototype.push");t.exports=function(t){var e=o(t),n=[];for(var r in e)i(e,r)&&a(n,e[r]);return n}},8638:(t,e,n)=>{"use strict";var o=n(8452),r=n(487),i=n(7446),a=n(1927),s=n(3305),l=r(a(),Object);o(l,{getPolyfill:a,implementation:i,shim:s}),t.exports=l},1927:(t,e,n)=>{"use strict";var o=n(7446);t.exports=function(){return"function"==typeof Object.values?Object.values:o}},3305:(t,e,n)=>{"use strict";var o=n(1927),r=n(8452);t.exports=function(){var t=o();return r(Object,{values:t},{values:function(){return Object.values!==t}}),t}},5302:(t,e,n)=>{var o=n(7291);t.exports=function t(e,n,r){return o(n)||(r=n||r,n=[]),r=r||{},e instanceof RegExp?function(t,e){var n=t.source.match(/\((?!\?)/g);if(n)for(var o=0;o<n.length;o++)e.push({name:o,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return c(t,e)}(e,n):o(e)?function(e,n,o){for(var r=[],i=0;i<e.length;i++)r.push(t(e[i],n,o).source);return c(new RegExp("(?:"+r.join("|")+")",h(o)),n)}(e,n,r):function(t,e,n){return p(i(t,n),e,n)}(e,n,r)},t.exports.parse=i,t.exports.compile=function(t,e){return s(i(t,e),e)},t.exports.tokensToFunction=s,t.exports.tokensToRegExp=p;var r=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function i(t,e){for(var n,o=[],i=0,a=0,s="",c=e&&e.delimiter||"/";null!=(n=r.exec(t));){var h=n[0],p=n[1],f=n.index;if(s+=t.slice(a,f),a=f+h.length,p)s+=p[1];else{var d=t[a],m=n[2],y=n[3],g=n[4],v=n[5],b=n[6],_=n[7];s&&(o.push(s),s="");var w=null!=m&&null!=d&&d!==m,E="+"===b||"*"===b,k="?"===b||"*"===b,S=n[2]||c,x=g||v;o.push({name:y||i++,prefix:m||"",delimiter:S,optional:k,repeat:E,partial:w,asterisk:!!_,pattern:x?u(x):_?".*":"[^"+l(S)+"]+?"})}}return a<t.length&&(s+=t.substr(a)),s&&o.push(s),o}function a(t){return encodeURI(t).replace(/[\/?#]/g,(function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}))}function s(t,e){for(var n=new Array(t.length),r=0;r<t.length;r++)"object"==typeof t[r]&&(n[r]=new RegExp("^(?:"+t[r].pattern+")$",h(e)));return function(e,r){for(var i="",s=e||{},l=(r||{}).pretty?a:encodeURIComponent,u=0;u<t.length;u++){var c=t[u];if("string"!=typeof c){var h,p=s[c.name];if(null==p){if(c.optional){c.partial&&(i+=c.prefix);continue}throw new TypeError('Expected "'+c.name+'" to be defined')}if(o(p)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but received `'+JSON.stringify(p)+"`");if(0===p.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var f=0;f<p.length;f++){if(h=l(p[f]),!n[u].test(h))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'", but received `'+JSON.stringify(h)+"`");i+=(0===f?c.prefix:c.delimiter)+h}}else{if(h=c.asterisk?encodeURI(p).replace(/[?#]/g,(function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})):l(p),!n[u].test(h))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but received "'+h+'"');i+=c.prefix+h}}else i+=c}return i}}function l(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function u(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function c(t,e){return t.keys=e,t}function h(t){return t&&t.sensitive?"":"i"}function p(t,e,n){o(e)||(n=e||n,e=[]);for(var r=(n=n||{}).strict,i=!1!==n.end,a="",s=0;s<t.length;s++){var u=t[s];if("string"==typeof u)a+=l(u);else{var p=l(u.prefix),f="(?:"+u.pattern+")";e.push(u),u.repeat&&(f+="(?:"+p+f+")*"),a+=f=u.optional?u.partial?p+"("+f+")?":"(?:"+p+"("+f+"))?":p+"("+f+")"}}var d=l(n.delimiter||"/"),m=a.slice(-d.length)===d;return r||(a=(m?a.slice(0,-d.length):a)+"(?:"+d+"(?=$))?"),a+=i?"$":r&&m?"":"(?="+d+"|$)",c(new RegExp("^"+a,h(n)),e)}},7291:t=>{t.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},2694:(t,e,n)=>{"use strict";var o=n(6925);function r(){}function i(){}i.resetWarningCache=r,t.exports=function(){function t(t,e,n,r,i,a){if(a!==o){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:i,resetWarningCache:r};return n.PropTypes=n,n}},5556:(t,e,n)=>{t.exports=n(2694)()},6925:t=>{"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},5287:(t,e,n)=>{"use strict";var o=n(5228),r="function"==typeof Symbol&&Symbol.for,i=r?Symbol.for("react.element"):60103,a=r?Symbol.for("react.portal"):60106,s=r?Symbol.for("react.fragment"):60107,l=r?Symbol.for("react.strict_mode"):60108,u=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,h=r?Symbol.for("react.context"):60110,p=r?Symbol.for("react.forward_ref"):60112,f=r?Symbol.for("react.suspense"):60113,d=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,y="function"==typeof Symbol&&Symbol.iterator;function g(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function _(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||v}function w(){}function E(t,e,n){this.props=t,this.context=e,this.refs=b,this.updater=n||v}_.prototype.isReactComponent={},_.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(g(85));this.updater.enqueueSetState(this,t,e,"setState")},_.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},w.prototype=_.prototype;var k=E.prototype=new w;k.constructor=E,o(k,_.prototype),k.isPureReactComponent=!0;var S={current:null},x=Object.prototype.hasOwnProperty,P={key:!0,ref:!0,__self:!0,__source:!0};function T(t,e,n){var o,r={},a=null,s=null;if(null!=e)for(o in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)x.call(e,o)&&!P.hasOwnProperty(o)&&(r[o]=e[o]);var l=arguments.length-2;if(1===l)r.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];r.children=u}if(t&&t.defaultProps)for(o in l=t.defaultProps)void 0===r[o]&&(r[o]=l[o]);return{$$typeof:i,type:t,key:a,ref:s,props:r,_owner:S.current}}function O(t){return"object"==typeof t&&null!==t&&t.$$typeof===i}var C=/\/+/g,j=[];function L(t,e,n,o){if(j.length){var r=j.pop();return r.result=t,r.keyPrefix=e,r.func=n,r.context=o,r.count=0,r}return{result:t,keyPrefix:e,func:n,context:o,count:0}}function A(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>j.length&&j.push(t)}function N(t,e,n,o){var r=typeof t;"undefined"!==r&&"boolean"!==r||(t=null);var s=!1;if(null===t)s=!0;else switch(r){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case i:case a:s=!0}}if(s)return n(o,t,""===e?"."+R(t,0):e),1;if(s=0,e=""===e?".":e+":",Array.isArray(t))for(var l=0;l<t.length;l++){var u=e+R(r=t[l],l);s+=N(r,u,n,o)}else if("function"==typeof(u=null===t||"object"!=typeof t?null:"function"==typeof(u=y&&t[y]||t["@@iterator"])?u:null))for(t=u.call(t),l=0;!(r=t.next()).done;)s+=N(r=r.value,u=e+R(r,l++),n,o);else if("object"===r)throw n=""+t,Error(g(31,"[object Object]"===n?"object with keys {"+Object.keys(t).join(", ")+"}":n,""));return s}function I(t,e,n){return null==t?0:N(t,"",e,n)}function R(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function M(t,e){t.func.call(t.context,e,t.count++)}function z(t,e,n){var o=t.result,r=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?F(t,o,n,(function(t){return t})):null!=t&&(O(t)&&(t=function(t,e){return{$$typeof:i,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,r+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(C,"$&/")+"/")+n)),o.push(t))}function F(t,e,n,o,r){var i="";null!=n&&(i=(""+n).replace(C,"$&/")+"/"),I(t,z,e=L(e,i,o,r)),A(e)}var B={current:null};function D(){var t=B.current;if(null===t)throw Error(g(321));return t}var U={ReactCurrentDispatcher:B,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:o};e.Children={map:function(t,e,n){if(null==t)return t;var o=[];return F(t,o,null,e,n),o},forEach:function(t,e,n){if(null==t)return t;I(t,M,e=L(null,null,e,n)),A(e)},count:function(t){return I(t,(function(){return null}),null)},toArray:function(t){var e=[];return F(t,e,null,(function(t){return t})),e},only:function(t){if(!O(t))throw Error(g(143));return t}},e.Component=_,e.Fragment=s,e.Profiler=u,e.PureComponent=E,e.StrictMode=l,e.Suspense=f,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,e.cloneElement=function(t,e,n){if(null==t)throw Error(g(267,t));var r=o({},t.props),a=t.key,s=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,l=S.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)x.call(e,c)&&!P.hasOwnProperty(c)&&(r[c]=void 0===e[c]&&void 0!==u?u[c]:e[c])}var c=arguments.length-2;if(1===c)r.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:i,type:t.type,key:a,ref:s,props:r,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:h,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:c,_context:t},t.Consumer=t},e.createElement=T,e.createFactory=function(t){var e=T.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:p,render:t}},e.isValidElement=O,e.lazy=function(t){return{$$typeof:m,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:d,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return D().useCallback(t,e)},e.useContext=function(t,e){return D().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return D().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return D().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return D().useLayoutEffect(t,e)},e.useMemo=function(t,e){return D().useMemo(t,e)},e.useReducer=function(t,e,n){return D().useReducer(t,e,n)},e.useRef=function(t){return D().useRef(t)},e.useState=function(t){return D().useState(t)},e.version="16.14.0"},6540:(t,e,n)=>{"use strict";t.exports=n(5287)},6897:(t,e,n)=>{"use strict";var o=n(453),r=n(41),i=n(592)(),a=n(5795),s=n(9675),l=o("%Math.floor%");t.exports=function(t,e){if("function"!=typeof t)throw new s("`fn` is not a function");if("number"!=typeof e||e<0||e>4294967295||l(e)!==e)throw new s("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],o=!0,u=!0;if("length"in t&&a){var c=a(t,"length");c&&!c.configurable&&(o=!1),c&&!c.writable&&(u=!1)}return(o||u||!n)&&(i?r(t,"length",e,!0,!0):r(t,"length",e)),t}},9771:t=>{"use strict";t.exports=function(){}},1669:t=>{"use strict";t.exports=jQuery}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={id:o,loaded:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{"use strict";var t=n(6540),e=n(1669),o=n.n(e),r=n(6894),i=n.n(r),a=n(1345),s=n(4378);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e,n){var o;return o=function(t,e){if("object"!=l(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=l(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==l(o)?o:o+"")in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=u(u(u(u(u({},10,{descr:(0,s._)("Queued"),icon:"far fa-hourglass fa-fw"}),20,{descr:(0,s._)("Processing"),icon:"fa fa-cog fa-spin fa-fw"}),30,{descr:(0,s._)("Failed"),icon:"fa fa-times fa-fw"}),40,{descr:(0,s._)("Completed"),icon:"fa fa-check fa-fw"}),50,{descr:(0,s._)("Canceled"),icon:"fa fa-ban fa-fw"});const h={QUEUED:10,RUNNING:20,FAILED:30,COMPLETED:40,CANCELED:50,description:function(t){return c[t]?c[t].descr:""},icon:function(t){return c[t]?c[t].icon:"fa fa-cog fa-spin"}};function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function f(t,e,n){var o;return o=function(t,e){if("object"!=p(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=p(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(e),(e="symbol"==p(o)?o:o+"")in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=f(f(f(f(f({},1,{descr:(0,s._)("Canceling...")}),2,{descr:(0,s._)("Deleting...")}),3,{descr:(0,s._)("Restarting...")}),4,{descr:(0,s._)("Resizing images...")}),5,{descr:(0,s._)("Importing...")});const m={CANCEL:1,REMOVE:2,RESTART:3,RESIZE:4,IMPORT:5,description:function(t){return d[t]?d[t].descr:""}};var y=n(5556),g=n.n(y);function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i,a,s=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=i.call(n)).done)&&(s.push(o.value),s.length!==e);l=!0);}catch(t){u=!0,r=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function w(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,T(o.key),o)}}function E(t,e,n){return e=S(e),function(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,k()?Reflect.construct(e,n||[],S(t).constructor):e.apply(t,n))}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(k=function(){return!!t})()}function S(t){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},S(t)}function x(t,e){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},x(t,e)}function P(t,e,n){return(e=T(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T(t){var e=function(t,e){if("object"!=v(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=v(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(e)?e:e+""}var O=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=E(this,n,[t])).close=e.close.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e)}(n,e),o=n,(r=[{key:"close",value:function(){var t=b(this.props.bind,2),e=t[0],n=t[1];e.setState(P({},n,""))}},{key:"render",value:function(){var e=b(this.props.bind,2),n=e[0],o=e[1];return n.state[o]?t.createElement("div",{className:"alert alert-warning alert-dismissible "+(this.props.className?this.props.className:"")},t.createElement("button",{type:"button",className:"close",title:(0,s._)("Close"),onClick:this.close},t.createElement("span",{"aria-hidden":"true"},"")),n.state[o]):t.createElement("div",null)}}])&&w(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);P(O,"propTypes",{bind:g().array.isRequired});const C=O;var j=n(2280);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function A(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,F(o.key),o)}}function N(t,e,n){return e=R(e),function(t,e){if(e&&("object"===L(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,I()?Reflect.construct(e,n||[],R(t).constructor):e.apply(t,n))}function I(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(I=function(){return!!t})()}function R(t){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},R(t)}function M(t,e){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},M(t,e)}function z(t,e,n){return(e=F(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F(t){var e=function(t,e){if("object"!=L(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=L(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==L(e)?e:e+""}var B=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),z(e=N(this,n,[t]),"handleEnter",(function(t){"Enter"!==t.key&&13!==t.keyCode||e.handleSave(t)})),e.state={showModal:t.show,saving:!1,deleting:!1,error:""},e.setModal=e.setModal.bind(e),e.show=e.show.bind(e),e.hide=e.hide.bind(e),e.handleSave=e.handleSave.bind(e),e.handleDelete=e.handleDelete.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e)}(n,e),r=n,(i=[{key:"setModal",value:function(t){this.modal=t}},{key:"componentDidMount",value:function(){var t=this;this._mounted=!0,o()(this.modal).on("hidden.bs.modal",(function(e){t.hide()})).on("shown.bs.modal",(function(e){t.props.onShow&&t.props.onShow()})),this.componentDidUpdate()}},{key:"componentWillUnmount",value:function(){this._mounted=!1,o()(this.modal).off("hidden.bs.modal hidden.bs.modal").modal("hide")}},{key:"componentDidUpdate",value:function(){this.state.showModal?o()(this.modal).modal("show"):o()(this.modal).modal("hide")}},{key:"show",value:function(){this.props.reset&&this.props.reset(),this.setState({showModal:!0,saving:!1,error:""})}},{key:"hide",value:function(){this.setState({showModal:!1}),this.props.onHide&&this.props.onHide(),this.serverRequest&&(this.serverRequest.abort(),this.serverRequest=null)}},{key:"handleSave",value:function(t){var e=this;if(t.preventDefault(),this.setState({saving:!0,error:""}),this.props.handleSaveFunction)this.props.handleSaveFunction((function(t){t?e.setState({saving:!1,error:t.message}):e.hide()}));else{var n={};this.props.getFormData&&(n=this.props.getFormData()),this.serverRequest=this.props.saveAction(n),this.serverRequest?this.serverRequest.fail((function(t){e.setState({error:t.message||(t.responseJSON||{}).detail||(t.responseJSON||{}).error||t.responseText||(0,s._)("Could not apply changes")})})).always((function(){e.setState({saving:!1}),e.serverRequest=null})).done((function(){e.hide()})):(this.setState({saving:!1}),this.hide())}}},{key:"handleDelete",value:function(){var t=this;this.props.deleteAction&&(this.props.deleteWarning&&!window.confirm(this.props.deleteWarning)||(this.setState({deleting:!0}),this.props.deleteAction().fail((function(e){t._mounted&&t.setState({error:e.message||(e.responseJSON||{}).detail||e.responseText||(0,s._)("Could not delete item")})})).always((function(){t._mounted&&t.setState({deleting:!1})}))))}},{key:"render",value:function(){var e=[];return this.props.deleteAction&&e.push(t.createElement("button",{disabled:this.state.deleting,className:"btn btn-danger",key:"delete",onClick:this.handleDelete},this.state.deleting?t.createElement("span",null,t.createElement("i",{className:"fa fa-circle-notch fa-spin"})," ",(0,s._)("Deleting...")):t.createElement("span",null,t.createElement("i",{className:"fa fa-trash"})," ",(0,s._)("Delete")))),this.props.leftButtons&&(e=e.concat(this.props.leftButtons)),t.createElement("div",{ref:this.setModal,className:"modal form-dialog",tabIndex:"-1","data-backdrop":"static"},t.createElement("div",{className:"modal-dialog"},t.createElement("div",{className:"modal-content"},t.createElement("div",{className:"modal-header"},t.createElement("button",{type:"button",className:"close",onClick:this.hide},t.createElement("span",null,"")),t.createElement("h4",{className:"modal-title"},this.props.title)),t.createElement("div",{className:"modal-body"},t.createElement(C,{bind:[this,"error"]}),t.createElement("div",{className:"form-horizontal",onSubmit:this.handleSave},this.props.children)),t.createElement("div",{className:"modal-footer"},t.createElement("div",{className:"pull-right"},t.createElement("button",{type:"button",className:"btn btn-default",onClick:this.hide,disabled:this.state.saving},(0,s._)("Cancel")),t.createElement("button",{type:"button",className:"btn btn-primary save",onClick:this.handleSave,disabled:this.state.saving},this.state.saving?t.createElement("span",null,t.createElement("i",{className:"fa fa-circle-notch fa-spin"})," ",this.props.savingLabel):t.createElement("span",null,t.createElement("i",{className:this.props.saveIcon})," ",this.props.saveLabel))),e.length>0?t.createElement("div",{className:"text-left"},e):""))))}}])&&A(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(t.Component);z(B,"defaultProps",{title:(0,s._)("Title"),saveLabel:(0,s._)("Save"),savingLabel:(0,s._)("Saving"),saveIcon:"glyphicon glyphicon-plus",deleteWarning:(0,s._)("Are you sure?"),show:!1}),z(B,"propTypes",{getFormData:g().func.isRequired,reset:g().func,saveAction:g().func.isRequired,handleSaveFunction:g().func,onShow:g().func,onHide:g().func,deleteAction:g().func,title:g().string,saveLabel:g().string,savingLabel:g().string,saveIcon:g().string,deleteWarning:g().oneOfType([g().string,g().bool]),show:g().bool});const D=B;function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function Z(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Y(o.key),o)}}function q(t,e,n){return e=H(e),function(t,e){if(e&&("object"===U(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,W()?Reflect.construct(e,n||[],H(t).constructor):e.apply(t,n))}function W(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(W=function(){return!!t})()}function H(t){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},H(t)}function V(t,e){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},V(t,e)}function G(t,e,n){return(e=Y(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y(t){var e=function(t,e){if("object"!=U(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=U(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:e+""}var K={"ignore-gsd":(0,s._)("You might run out of memory if you use this option.")},Q=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),G(e=q(this,n),"handleHelp",(function(t){t.preventDefault(),window.__taskOptionsDocsLink&&window.open(window.__taskOptionsDocsLink+"#"+encodeURIComponent(e.props.name),"task-options")})),e.state={value:void 0!==t.value?t.value:""},e.resetToDefault=e.resetToDefault.bind(e),e.handleInputChange=e.handleInputChange.bind(e),e.handleCheckboxChange=e.handleCheckboxChange.bind(e),e.handleSelectChange=e.handleSelectChange.bind(e),e.isEnumType=e.isEnumType.bind(e),e.supportsFileAPI=e.supportsFileAPI.bind(e),e.loadFile=e.loadFile.bind(e),e.handleFileSelect=e.handleFileSelect.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V(t,e)}(n,e),r=n,(i=[{key:"getValue",value:function(){return""!==this.state.value?this.state.value:void 0}},{key:"setTooltips",value:function(t){null!==t&&o()(t).find('[data-toggle="tooltip"]').tooltip()}},{key:"resetToDefault",value:function(t){this.setState({value:""}),t.preventDefault()}},{key:"handleInputChange",value:function(t){this.setState({value:t.target.value})}},{key:"handleSelectChange",value:function(t){this.setState({value:t.target.value!==this.props.defaultValue?t.target.value:""})}},{key:"handleCheckboxChange",value:function(t){this.setState({value:""===this.state.value||""})}},{key:"isEnumType",value:function(){return"enum"===this.props.type&&Array.isArray(this.props.domain)}},{key:"supportsFileAPI",value:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob}},{key:"loadFile",value:function(){if(this.fileControl){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!1),this.fileControl.dispatchEvent(t)}}},{key:"handleFileSelect",value:function(t){var e=this,n=t.target.files;if(n.length>0){var o=n[0],r=new FileReader;r.onload=function(t){try{var n=JSON.stringify(JSON.parse(t.target.result));e.setState({value:n})}catch(t){console.warn("Cannot parse JSON: ".concat(t.target.result,": ").concat(t))}e.fileControl.value=""},r.readAsText(o)}}},{key:"render",value:function(){var e=this,n="",o="";if("bool"!==this.props.type)if(this.isEnumType()){var r=""!==this.state.value?this.state.value:this.props.defaultValue;n=t.createElement("select",{className:"form-control",value:r,onChange:this.handleSelectChange},this.props.domain.map((function(e){return t.createElement("option",{value:e,key:e},e)})))}else n=t.createElement("input",{type:"text",className:"form-control",placeholder:this.props.defaultValue,value:this.state.value,onChange:this.handleInputChange});else n=t.createElement("div",{className:"checkbox"},t.createElement("label",null,t.createElement("input",{type:"checkbox",checked:""!==this.state.value,onChange:this.handleCheckboxChange})," ",(0,s._)("Enable")));var i="";return this.supportsFileAPI()&&"json"===this.props.domain&&(i=[t.createElement("button",{key:"btn",type:"file",className:"btn glyphicon glyphicon-import btn-primary","data-toggle":"tooltip","data-placement":"left",title:(0,s._)("Click to import a .JSON file"),onClick:function(){return e.loadFile()}}),t.createElement("input",{key:"file-ctrl",className:"file-control",type:"file",accept:"text/plain,application/json,application/geo+json,.geojson",onChange:this.handleFileSelect,ref:function(t){e.fileControl=t}})]),void 0!==K[this.props.name]&&""!==this.state.value&&(o=t.createElement("div",{class:"alert alert-warning"},t.createElement("i",{class:"fa fa-exclamation-triangle"})," ",K[this.props.name])),t.createElement("div",{className:"processing-node-option form-inline form-group form-horizontal",ref:this.setTooltips},t.createElement("label",null,this.props.name," ",!this.isEnumType()&&this.props.domain?"(".concat(this.props.domain,")"):""," ",t.createElement("i",{"data-toggle":"tooltip","data-placement":"bottom",title:this.props.help,onClick:this.handleHelp,className:"fa fa-info-circle info-button help-button"})),t.createElement("br",null),n,i,""!==this.state.value?t.createElement("button",{type:"submit",className:"btn glyphicon glyphicon glyphicon-repeat btn-default","data-toggle":"tooltip","data-placement":"top",title:(0,s._)("Reset to default"),onClick:this.resetToDefault}):"",o)}}])&&Z(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(t.Component);G(Q,"defaultProps",{}),G(Q,"propTypes",{name:g().string.isRequired,defaultValue:g().oneOfType([g().string,g().bool]).isRequired,value:g().oneOfType([g().string,g().bool]),type:g().string,domain:g().oneOfType([g().string,g().array]),help:g().string});const J=Q;function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function tt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,et(o.key),o)}}function et(t){var e=function(t,e){if("object"!=X(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=X(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==X(e)?e:e+""}const nt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getAvailableOptions",value:function(t,e){var n=j.A.clone(e);return n.forEach((function(e){var n;e.defaultValue||(Array.isArray(t)&&(n=t.find((function(t){return t.name==e.name}))),n?(e.defaultValue=e.value,e.value=n.value):(e.defaultValue=void 0!==e.value?e.value:"",delete e.value)),"string"==typeof e.help&&(e.help=(0,s.interpolate)((0,s._)(e.help),{choices:Array.isArray(e.domain)?e.domain.join(", "):e.domain,default:""===e.defaultValue?'""':e.defaultValue}))})),n.sort((function(t,e){return t.name<e.name?-1:1})),n}}],null&&tt(t.prototype,null),e&&tt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();var ot=n(8638),rt=n.n(ot);function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function at(){return at=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},at.apply(this,arguments)}function st(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,ft(o.key),o)}}function lt(t,e,n){return e=ct(e),function(t,e){if(e&&("object"===it(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ut()?Reflect.construct(e,n||[],ct(t).constructor):e.apply(t,n))}function ut(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ut=function(){return!!t})()}function ct(t){return ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ct(t)}function ht(t,e){return ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ht(t,e)}function pt(t,e,n){return(e=ft(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ft(t){var e=function(t,e){if("object"!=it(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=it(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==it(e)?e:e+""}Object.values||rt().shim();var dt=["build-overviews","orthophoto-no-tiled","orthophoto-compression","orthophoto-png","orthophoto-kmz","pc-copc","pc-las","pc-ply","pc-csv","pc-ept","cog","gltf"],mt=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),pt(e=lt(this,n,[t]),"toggleSearchControl",(function(){e.setState({showSearch:!e.state.showSearch})})),e.options={},e.state={name:t.preset.name,search:"",showSearch:!1},e.getFormData=e.getFormData.bind(e),e.onShow=e.onShow.bind(e),e.setOptionRef=e.setOptionRef.bind(e),e.getOptions=e.getOptions.bind(e),e.isCustomPreset=e.isCustomPreset.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ht(t,e)}(n,e),o=n,(r=[{key:"setOptionRef",value:function(t){var e=this;return function(n){n&&(e.options[t]=n)}}},{key:"getOptions",value:function(){return Object.values(this.options).map((function(t){return{name:t.props.name,value:t.getValue()}})).filter((function(t){return void 0!==t.value}))}},{key:"getFormData",value:function(){return{id:this.props.preset.id,name:this.state.name,options:this.getOptions()}}},{key:"isCustomPreset",value:function(){return-1===this.props.preset.id}},{key:"onShow",value:function(){this.isCustomPreset()||this.nameInput.focus()}},{key:"handleChange",value:function(t){var e=this;return function(n){var o={};o[t]=n.target.value,e.setState(o)}}},{key:"componentDidUpdate",value:function(t,e){this.state.showSearch&&this.searchControl.focus()}},{key:"render",value:function(){var e=this,n=nt.getAvailableOptions(this.props.preset.options,this.props.availableOptions);return t.createElement("div",{className:"edit-preset-dialog"},t.createElement(D,at({},this.props,{getFormData:this.getFormData,reset:function(){},show:!0,onShow:this.onShow,saveIcon:"far fa-edit",title:(0,s._)("Edit Task Options"),saveAction:this.props.saveAction,deleteWarning:!1,deleteAction:-1===this.props.preset.id||this.props.preset.system?void 0:this.props.deleteAction}),this.isCustomPreset()?"":[t.createElement("div",{className:"row preset-name",key:"preset"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Name")),t.createElement("div",{className:"col-sm-10",style:{marginRight:"40px"}},t.createElement("input",{type:"text",className:"form-control",ref:function(t){e.nameInput=t},value:this.state.name,onChange:this.handleChange("name")}))),t.createElement("hr",{key:"hr"})],t.createElement("button",{type:"submit",className:"btn btn-default search-toggle btn-sm",title:(0,s._)("Search"),onClick:this.toggleSearchControl},t.createElement("i",{className:"fa fa-filter"})),this.state.showSearch?t.createElement("div",{className:"row search-controls"},t.createElement("div",{className:"col-sm-12"},t.createElement("input",{type:"text",className:"form-control",value:this.state.search,ref:function(t){e.searchControl=t},onChange:this.handleChange("search")}))):"",t.createElement("div",{className:"row"},t.createElement("div",{className:"col-sm-12"},n.filter((function(t){return-1===dt.indexOf(t.name.toLowerCase())})).filter((function(t){return!e.state.showSearch||""===e.state.search||-1!==t.name.toLowerCase().indexOf(e.state.search.toLowerCase())})).map((function(n){return t.createElement(J,at({},n,{key:n.name,ref:e.setOptionRef(n.name)}))}))))))}}])&&st(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);pt(mt,"defaultProps",{}),pt(mt,"propTypes",{preset:g().object.isRequired,availableOptions:g().array.isRequired,saveAction:g().func.isRequired,deleteAction:g().func.isRequired,onHide:g().func});const yt=mt;function gt(t){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gt(t)}function vt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,bt(o.key),o)}}function bt(t){var e=function(t,e){if("object"!=gt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=gt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gt(e)?e:e+""}var _t=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getItem",value:function(t){try{return localStorage.getItem(t)}catch(e){console.warn("Failed to call getItem "+t,e)}}},{key:"setItem",value:function(t,e){try{localStorage.setItem(t,e)}catch(e){console.warn("Failed to call setItem "+t,e)}}}],null&&vt(t.prototype,null),e&&vt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const wt=_t,Et=function(t){return Array.isArray(t)?t.filter((function(t){return!t.startsWith(".")})):[]};function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function St(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function xt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Lt(o.key),o)}}function Pt(t,e,n){return e=Ot(e),function(t,e){if(e&&("object"===kt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Tt()?Reflect.construct(e,n||[],Ot(t).constructor):e.apply(t,n))}function Tt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Tt=function(){return!!t})()}function Ot(t){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ot(t)}function Ct(t,e){return Ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ct(t,e)}function jt(t,e,n){return(e=Lt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lt(t){var e=function(t,e){if("object"!=kt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=kt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kt(e)?e:e+""}var At=function(e){function n(t){var e,o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),jt(e=Pt(this,n,[t]),"handleKeyDown",(function(t){"Tab"===t.key||"Enter"===t.key||","===t.key||" "===t.key?(t.preventDefault(),t.stopPropagation(),e.addTag()):"Backspace"===t.key&&""===e.inputText.innerText&&e.removeTag(e.state.userTags.length-1)})),jt(e,"focus",(function(){e.inputText.focus()})),jt(e,"stop",(function(t){t.stopPropagation()})),jt(e,"handleRemoveTag",(function(t){return function(n){n.stopPropagation(),e.removeTag(t)}})),jt(e,"removeTag",(function(t){e.setState(i()(e.state,{userTags:{$splice:[[t,1]]}}))})),jt(e,"addTag",(function(){var t=e.inputText.innerText;""!==t&&(t.startsWith(".")||(t=t.toLowerCase(),-1===e.state.userTags.indexOf(t)&&e.setState(i()(e.state,{userTags:{$push:[t]}}))),e.inputText.innerText="")})),jt(e,"handleDragStart",(function(t){return function(n){e.disableDropzones(),n.stopPropagation(),n.dataTransfer.setData("application/tag",t),n.dataTransfer.dropEffect="move"}})),jt(e,"handleDrop",(function(t){t.preventDefault();var n=t.dataTransfer.getData("application/tag"),o=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i,a,s=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=i.call(n)).done)&&(s.push(o.value),s.length!==e);l=!0);}catch(t){u=!0,r=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return St(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?St(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.findClosestTag(t.clientX,t.clientY),2),r=o[0],i=o[1],a=e.state.userTags;if(r){var s=a.indexOf(n),l=a.indexOf(r);if(-1!==s&&-1!==l){if(s===l)return;var u="right"===i?l+1:l;a.splice(u,0,n);for(var c=0;c<a.length;c++)if(a[c]===n&&c!==u){a.splice(c,1);break}e.setState({userTags:a})}}})),jt(e,"handleDragOver",(function(t){t.preventDefault(),t.dataTransfer.dropEffect="move"})),jt(e,"handleDragEnter",(function(t){t.preventDefault()})),jt(e,"handleDragEnd",(function(){e.restoreDropzones()})),jt(e,"findClosestTag",(function(t,n){var o=null,r=1/0,i=1/0,a=null,s=e.state.userTags;if(e.domTags.forEach((function(t,e){var o=t.getBoundingClientRect(),r=o.y+o.height/2,s=n-r,l=s*s;l<i&&(i=l,a=r)})),!a)return[null,""];e.domTags.forEach((function(e,n){var i=e.getBoundingClientRect(),l=i.y+i.height/2;if(Math.abs(l-a)<.001){var u=i.x+i.width,c=t-u,h=c*c;h<r&&(o=s[n],r=h)}}));var l="right";if(o){var u=e.domTags[e.state.userTags.indexOf(o)].getBoundingClientRect(),c=u.x+u.width/2;t<c&&(l="left")}return[o,l]})),e.state={userTags:Et(t.tags),systemTags:(o=t.tags,Array.isArray(o)?o.filter((function(t){return t.startsWith(".")})):[])},e.dzList=[],e.domTags=[],e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ct(t,e)}(n,e),o=n,(r=[{key:"componentDidUpdate",value:function(){this.props.onUpdate(function(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);throw Error("Invalid parameters")}(this.state.userTags,this.state.systemTags))}},{key:"componentWillUnmount",value:function(){this.restoreDropzones()}},{key:"disableDropzones",value:function(){if(!this.disabledDz){for(var t=this.domNode.parentElement;t;)t.dropzone&&(t.dropzone.removeListeners(),this.dzList.push(t.dropzone)),t=t.parentElement;this.disabledDz=!0}}},{key:"restoreDropzones",value:function(){this.disabledDz&&(this.dzList.forEach((function(t){t.restoreListeners()})),this.dzList=[],this.disabledDz=!1)}},{key:"render",value:function(){var e=this;return t.createElement("div",{ref:function(t){return e.domNode=t},spellCheck:"false",autoComplete:"off",onClick:this.focus,onDrop:this.handleDrop,onDragOver:this.handleDragOver,onDragEnter:this.handleDragEnter,className:"form-control tags-field"},this.state.userTags.map((function(n,o){return t.createElement("div",{draggable:"true",className:"tag-badge",key:o,ref:function(t){return e.domTags[o]=t},onClick:e.stop,onDragStart:e.handleDragStart(n),onDragEnd:e.handleDragEnd},n," ",t.createElement("a",{href:"javascript:void(0)",onClick:e.handleRemoveTag(o)},""),"")})),t.createElement("div",{className:"inputText",contentEditable:"true",ref:function(t){return e.inputText=t},onKeyDown:this.handleKeyDown,onBlur:this.addTag}))}}])&&xt(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);jt(At,"defaultProps",{tags:[],onUpdate:function(){}}),jt(At,"propTypes",{tags:g().arrayOf(g().string),onUpdate:g().func});const Nt=At;var It;function Rt(t){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rt(t)}function Mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function zt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,qt(o.key),o)}}function Ft(t,e,n){return e=Dt(e),function(t,e){if(e&&("object"===Rt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Bt()?Reflect.construct(e,n||[],Dt(t).constructor):e.apply(t,n))}function Bt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Bt=function(){return!!t})()}function Dt(t){return Dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dt(t)}function Ut(t,e){return Ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ut(t,e)}function Zt(t,e,n){return(e=qt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qt(t){var e=function(t,e){if("object"!=Rt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Rt(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Rt(e)?e:e+""}var $t=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Zt(e=Ft(this,n,[t]),"loadSuggestedName",(function(){"function"==typeof e.props.suggestedTaskName&&(e.setState({loadingTaskName:!0}),e.props.suggestedTaskName().then((function(t){e.state.loadingTaskName&&e.setState({loadingTaskName:!1,name:t})})).catch((function(t){e.setState({loadingTaskName:!1})})))})),Zt(e,"toggleTagsField",(function(){e.state.showTagsField||setTimeout((function(){e.tagsField&&e.tagsField.focus()}),0),e.setState({showTagsField:!e.state.showTagsField})})),e.state={error:"",presetError:"",presetActionPerforming:!1,namePlaceholder:"string"==typeof t.suggestedTaskName?t.suggestedTaskName:null!==t.task?t.task.name||"":"Task of "+(new Date).toISOString(),name:"string"==typeof t.suggestedTaskName?t.suggestedTaskName:null!==t.task&&t.task.name||"",loadedProcessingNodes:!1,loadedPresets:!1,selectedNode:null,processingNodes:[],selectedPreset:null,presets:[],tags:null!==t.task?j.A.clone(t.task.tags):[],editingPreset:!1,loadingTaskName:!1,showTagsField:null!==t.task&&!!t.task.tags.length},e.handleNameChange=e.handleNameChange.bind(e),e.handleSelectNode=e.handleSelectNode.bind(e),e.firstEnabledNode=e.firstEnabledNode.bind(e),e.loadProcessingNodes=e.loadProcessingNodes.bind(e),e.retryLoad=e.retryLoad.bind(e),e.selectNodeByKey=e.selectNodeByKey.bind(e),e.getTaskInfo=e.getTaskInfo.bind(e),e.notifyFormLoaded=e.notifyFormLoaded.bind(e),e.loadPresets=e.loadPresets.bind(e),e.handleSelectPreset=e.handleSelectPreset.bind(e),e.selectPresetById=e.selectPresetById.bind(e),e.handleEditPreset=e.handleEditPreset.bind(e),e.handleCancelEditPreset=e.handleCancelEditPreset.bind(e),e.handlePresetSave=e.handlePresetSave.bind(e),e.handleDuplicateSavePreset=e.handleDuplicateSavePreset.bind(e),e.handleDeletePreset=e.handleDeletePreset.bind(e),e.findFirstPresetMatching=e.findFirstPresetMatching.bind(e),e.getAvailableOptionsOnly=e.getAvailableOptionsOnly.bind(e),e.getAvailableOptionsOnlyText=e.getAvailableOptionsOnlyText.bind(e),e.saveLastPresetToStorage=e.saveLastPresetToStorage.bind(e),e.formReady=e.formReady.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ut(t,e)}(n,e),r=n,i=[{key:"formReady",value:function(){return this.state.loadedProcessingNodes&&this.state.selectedNode&&this.state.loadedPresets&&this.state.selectedPreset}},{key:"checkFilesCount",value:function(t){return!this.state.selectedNode||0===t||null===this.state.selectedNode.max_images||this.state.selectedNode.max_images>=t}},{key:"selectedNodeMaxImages",value:function(){return this.state.selectedNode?this.state.selectedNode.max_images:null}},{key:"notifyFormLoaded",value:function(){this.props.onFormLoaded&&this.formReady()&&this.props.onFormLoaded()}},{key:"firstEnabledNode",value:function(){for(var t=0;t<this.state.processingNodes.length;t++)if(this.state.processingNodes[t].enabled)return this.state.processingNodes[t];return null}},{key:"loadProcessingNodes",value:function(){var t=this,e=function(){t.setState({error:(0,s._)("Could not load list of processing nodes. Are you connected to the internet?")})};this.nodesRequest=o().getJSON("/api/processingnodes/?has_available_options=True",(function(n){if(Array.isArray(n)){var o=function(e){var n=e?(0,s._)("We tried to reach:")+"<ul>"+e.map((function(t){return j.A.html(It||(e=['<li><a href="','">',"</a></li>"],n||(n=e.slice(0)),It=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))),t.url,t.label);var e,n})).join("")+"</ul>":"";t.setState({error:(0,s._)("There are no usable processing nodes.")+n+(0,s._)("Make sure that at least one processing node is reachable and that you have granted the current user sufficient permissions to view the processing node (by going to Administration -- Processing Nodes -- Select Node -- Object Permissions -- Add User/Group and check CAN VIEW PROCESSING NODE). If you are bringing a node back online, it will take about 30 seconds for WebODM to recognize it.")})};if(0===n.length)return void o();var r=n.map((function(t){return{id:t.id,key:t.id,label:"".concat(t.label," (queue: ").concat(t.queue_count,")"),options:t.available_options,queue_count:t.queue_count,max_images:t.max_images,enabled:t.online,url:"http://".concat(t.hostname,":").concat(t.port)}})),i=Math.min.apply(Math,function(t){if(Array.isArray(t))return Mt(t)}(u=r.filter((function(t){return t.enabled})).map((function(t){return t.queue_count})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(u)||function(t,e){if(t){if("string"==typeof t)return Mt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Mt(t,e):void 0}}(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r.filter((function(t){return t.enabled&&t.queue_count===i}));if(0===a.length)return void o(r);var l=a[~~(Math.random()*a.length)];t.setState({processingNodes:r,loadedProcessingNodes:!0}),t.props.task&&t.props.task.processing_node?t.props.task.auto_processing_node?t.selectNodeByKey(l.key):t.selectNodeByKey(t.props.task.processing_node):t.props.selectedNode?t.selectNodeByKey(t.props.selectedNode):t.selectNodeByKey(l.key),t.notifyFormLoaded()}else console.error("Got invalid json response for processing nodes",n),e();var u})).fail((function(t,n,o){e()}))}},{key:"retryLoad",value:function(){this.setState({error:""}),this.loadProcessingNodes(),this.loadPresets()}},{key:"findFirstPresetMatching",value:function(t,e){for(var n,o=function(){var n=t[r];if(e.length===n.options.length){var o={};e.forEach((function(t){o[t.name]=t.value}));for(var i=0,a=0;a<n.options.length&&o[n.options[a].name]===n.options[a].value;a++)i++;if(i===e.length)return{v:n}}},r=0;r<t.length;r++)if(n=o())return n.v;return null}},{key:"loadPresets",value:function(){var t=this,e=function(){t.setState({error:(0,s._)("Could not load list of presets. Are you connected to the internet?")})};this.presetsRequest=o().getJSON("/api/presets/?ordering=-system,-created_at",(function(n){if(Array.isArray(n)){var o={id:-1,name:"("+(0,s._)("Custom")+")",options:[],system:!0};n.unshift(o),(0,s._)("Default");var r=n[0],i=n.find((function(t){return"Default"===t.name}));if(i&&(r=i),t.props.task&&Array.isArray(t.props.task.options)&&t.props.task.options.length>0){var a=t.findFirstPresetMatching(n,t.props.task.options);null!==a?r=a:(o.options=j.A.clone(t.props.task.options),r=o)}else{var l=wt.getItem("last_preset_id");if(null!==l){var u=n.find((function(t){return t.id==l}));u&&(r=u)}}t.setState({loadedPresets:!0,presets:n,selectedPreset:r}),t.notifyFormLoaded()}else console.error("Got invalid json response for presets",json),e()})).fail((function(t,n,o){e()}))}},{key:"handleSelectPreset",value:function(t){this.selectPresetById(t.target.value)}},{key:"selectPresetById",value:function(t){var e=this.state.presets.find((function(e){return e.id===parseInt(t)}));e&&this.setState({selectedPreset:e})}},{key:"componentDidMount",value:function(){this.loadProcessingNodes(),this.loadPresets(),this.loadSuggestedName()}},{key:"componentDidUpdate",value:function(t,e){var n=this;if(this.formReady()){var o=!1;["name","selectedNode","selectedPreset"].forEach((function(t){e[t]!==n.state[t]&&(o=!0)})),o&&this.props.onFormChanged()}}},{key:"componentWillUnmount",value:function(){this.nodesRequest&&this.nodesRequest.abort(),this.presetsRequest&&this.presetsRequest.abort()}},{key:"handleNameChange",value:function(t){this.setState({name:t.target.value,loadingTaskName:!1})}},{key:"selectNodeByKey",value:function(t){var e=this.state.processingNodes.find((function(e){return e.key==t}));if(e)this.setState({selectedNode:e});else{console.log("Node ".concat(t," does not exist, selecting first enabled"));var n=this.firstEnabledNode();n&&this.selectNodeByKey(n.key)}}},{key:"handleSelectNode",value:function(t){this.selectNodeByKey(t.target.value)}},{key:"getAvailableOptionsOnly",value:function(t,e){var n={};return e.forEach((function(t){return n[t.name]=!0})),t.filter((function(t){return n[t.name]}))}},{key:"getAvailableOptionsOnlyText",value:function(t,e){var n=this.getAvailableOptionsOnly(t,e).map((function(t){return"".concat(t.name,":").concat(t.value)})).join(", ");return n||(n=(0,s._)("Default")),n}},{key:"saveLastPresetToStorage",value:function(){this.state.selectedPreset&&wt.setItem("last_preset_id",this.state.selectedPreset.id)}},{key:"getTaskInfo",value:function(){var t=this.state,e=t.name,n=t.selectedNode,o=t.selectedPreset,r=t.tags;return{name:""!==e?e:this.state.namePlaceholder,selectedNode:n,options:this.getAvailableOptionsOnly(o.options,n.options),tags:r}}},{key:"handleEditPreset",value:function(){var t=this.state,e=t.selectedPreset,n=t.presets;if(e.system){var o=n.find((function(t){return-1===t.id}));o||(o={id:-1,name:"("+(0,s._)("Custom")+")",options:[],system:!0},n.unshift(o),this.setState({presets:n})),o.options=j.A.clone(e.options),this.setState({selectedPreset:o})}this.setState({editingPreset:!0})}},{key:"handleCancelEditPreset",value:function(){this.setState({editingPreset:!1})}},{key:"handlePresetSave",value:function(t){var e=this,n=function(){var n=e.state.presets.find((function(e){return e.id===t.id}));n.name=t.name,n.options=t.options,e.setState({selectedPreset:n})};return-1===t.id?(n(),o().Deferred().resolve()):o().ajax({url:"/api/presets/".concat(t.id,"/"),contentType:"application/json",data:JSON.stringify({name:t.name,options:t.options}),dataType:"json",type:"PATCH"}).done(n)}},{key:"handleDuplicateSavePreset",value:function(){var t=this,e=this.state,n=e.selectedPreset,r=e.presets;this.setState({presetActionPerforming:!0});var i=-1===n.id,a=i?(0,s._)("My Preset"):(0,s.interpolate)((0,s._)("Copy of %(preset)s"),{preset:n.name});o().ajax({url:"/api/presets/",contentType:"application/json",data:JSON.stringify({name:a,options:n.options}),dataType:"json",type:"POST"}).done((function(e){i&&r.splice(r.indexOf(n),1),r.push(e),t.setState({presets:r,selectedPreset:e}),t.handleEditPreset()})).fail((function(){t.setState({presetError:(0,s._)("Could not duplicate the preset. Please try to refresh the page.")})})).always((function(){t.setState({presetActionPerforming:!1})}))}},{key:"handleDeletePreset",value:function(){var t=this,e=this.state,n=e.selectedPreset,r=e.presets;if(!n.system)return window.confirm((0,s.interpolate)((0,s._)('Are you sure you want to delete "%(preset)s"?'),{preset:n.name}))?(this.setState({presetActionPerforming:!0}),o().ajax({url:"/api/presets/".concat(n.id,"/"),contentType:"application/json",type:"DELETE"}).done((function(){r.splice(r.indexOf(n),1),t.setState({presets:r,selectedPreset:r[0],editingPreset:!1})})).fail((function(){t.setState({presetError:(0,s._)("Could not delete the preset. Please try to refresh the page.")})})).always((function(){t.setState({presetActionPerforming:!1})}))):o().Deferred().resolve();this.setState({presetError:(0,s._)("System presets can only be removed by a staff member from the Administration panel.")})}},{key:"render",value:function(){var e=this;if(this.state.error)return t.createElement("div",{className:"edit-task-panel"},t.createElement("div",{className:"alert alert-warning"},t.createElement("div",{dangerouslySetInnerHTML:{__html:this.state.error}}),t.createElement("button",{className:"btn btn-sm btn-primary",onClick:this.retryLoad},t.createElement("i",{className:"fa fa-rotate-left"})," ",(0,s._)("Retry"))));var n="";if(this.formReady()){var o=t.createElement("div",null,t.createElement("select",{title:this.getAvailableOptionsOnlyText(this.state.selectedPreset.options,this.state.selectedNode.options),className:"form-control",value:this.state.selectedPreset.id,onChange:this.handleSelectPreset},this.state.presets.map((function(e){return t.createElement("option",{value:e.id,key:e.id,className:e.system?"system-preset":""},"Default"===e.name?(0,s._)(e.name):e.name)}))),this.state.presetActionPerforming?t.createElement("i",{className:"preset-performing-action-icon fa fa-cog fa-spin fa-fw"}):t.createElement("div",{className:"btn-group presets-dropdown"},t.createElement("button",{type:"button",className:"btn btn-sm btn-default",title:(0,s._)("Edit Task Options"),onClick:this.handleEditPreset},t.createElement("i",{className:"fa fa-sliders-h"})," ",(0,s._)("Edit")),t.createElement("button",{type:"button",className:"btn btn-default btn-sm dropdown-toggle","data-toggle":"dropdown"},t.createElement("span",{className:"caret"})),t.createElement("ul",{className:"dropdown-menu"},t.createElement("li",null,t.createElement("a",{href:"javascript:void(0);",onClick:this.handleEditPreset},t.createElement("i",{className:"fa fa-sliders-h"})," ",(0,s._)("Edit"))),t.createElement("li",{className:"divider"}),-1!==this.state.selectedPreset.id?t.createElement("li",null,t.createElement("a",{href:"javascript:void(0);",onClick:this.handleDuplicateSavePreset},t.createElement("i",{className:"fa fa-copy"})," ",(0,s._)("Duplicate"))):t.createElement("li",null,t.createElement("a",{href:"javascript:void(0);",onClick:this.handleDuplicateSavePreset},t.createElement("i",{className:"fa fa-save"})," ",(0,s._)("Save"))),t.createElement("li",{className:this.state.selectedPreset.system?"disabled":""},t.createElement("a",{href:"javascript:void(0);",onClick:this.handleDeletePreset},t.createElement("i",{className:"fa fa-trash"})," ",(0,s._)("Delete"))))),t.createElement(C,{className:"preset-error",bind:[this,"presetError"]})),r="";this.state.showTagsField&&(r=t.createElement("div",{className:"form-group"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Tags")),t.createElement("div",{className:"col-sm-10"},t.createElement(Nt,{onUpdate:function(t){return e.state.tags=t},tags:this.state.tags,ref:function(t){return e.tagsField=t}})))),n=t.createElement("div",null,r,t.createElement("div",{className:"form-group"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Processing Node")),t.createElement("div",{className:"col-sm-10"},t.createElement("select",{className:"form-control",value:this.state.selectedNode.key,onChange:this.handleSelectNode},this.state.processingNodes.map((function(e){return t.createElement("option",{value:e.key,key:e.key,disabled:!e.enabled},e.label)}))))),t.createElement("div",{className:"form-group form-inline"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Options")),t.createElement("div",{className:"col-sm-10"},this.props.inReview?t.createElement("div",{className:"review-options"},this.getAvailableOptionsOnlyText(this.state.selectedPreset.options,this.state.selectedNode.options)):o)),this.state.editingPreset?t.createElement(yt,{preset:this.state.selectedPreset,availableOptions:this.state.selectedNode.options,onHide:this.handleCancelEditPreset,saveAction:this.handlePresetSave,deleteAction:this.handleDeletePreset,ref:function(t){t&&(e.editPresetDialog=t)}}):"")}else n=t.createElement("div",{className:"form-group"},t.createElement("div",{className:"col-sm-offset-2 col-sm-10"},(0,s._)("Loading processing nodes and presets...")," ",t.createElement("i",{className:"fa fa-sync fa-spin fa-fw"})));return t.createElement("div",{className:"edit-task-form"},t.createElement("div",{className:"form-group"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Name")),t.createElement("div",{className:"col-sm-10 name-fields"},this.state.loadingTaskName?t.createElement("i",{className:"fa fa-circle-notch fa-spin fa-fw name-loading"}):"",t.createElement("input",{type:"text",onChange:this.handleNameChange,className:"form-control",placeholder:this.state.namePlaceholder,value:this.state.name}),t.createElement("button",{type:"button",title:(0,s._)("Add tags"),onClick:this.toggleTagsField,className:"btn btn-sm btn-secondary toggle-tags"},t.createElement("i",{className:"fa fa-tag"})))),n)}}],i&&zt(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(t.Component);Zt($t,"defaultProps",{selectedNode:null,task:null,onFormChanged:function(){},inReview:!1}),Zt($t,"propTypes",{selectedNode:g().oneOfType([g().string,g().number]),onFormLoaded:g().func,onFormChanged:g().func,inReview:g().bool,task:g().object,suggestedTaskName:g().oneOfType([g().string,g().func])});const Wt=$t;function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function Vt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Xt(o.key),o)}}function Gt(t,e,n){return e=Kt(e),function(t,e){if(e&&("object"===Ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Yt()?Reflect.construct(e,n||[],Kt(t).constructor):e.apply(t,n))}function Yt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Yt=function(){return!!t})()}function Kt(t){return Kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Kt(t)}function Qt(t,e){return Qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Qt(t,e)}function Jt(t,e,n){return(e=Xt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xt(t){var e=function(t,e){if("object"!=Ht(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Ht(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ht(e)?e:e+""}var te=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=Gt(this,n,[t])).state={editTaskFormLoaded:!1,saving:!1,error:""},e.handleSave=e.handleSave.bind(e),e.handleCancel=e.handleCancel.bind(e),e.handleFormTaskLoaded=e.handleFormTaskLoaded.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qt(t,e)}(n,e),r=n,(i=[{key:"handleFormTaskLoaded",value:function(){this.setState({editTaskFormLoaded:!0})}},{key:"handleSave",value:function(){var t=this;this.setState({saving:!0});var e=this.taskForm.getTaskInfo();e.processing_node=e.selectedNode.id,e.auto_processing_node="auto"==e.selectedNode.key,delete e.selectedNode,o().ajax({url:"/api/projects/".concat(this.props.task.project,"/tasks/").concat(this.props.task.id,"/"),contentType:"application/json",data:JSON.stringify(e),dataType:"json",type:"PATCH"}).done((function(e){t.setState({saving:!1}),t.props.onSave(e)})).fail((function(){t.setState({saving:!1,error:(0,s._)("Could not update task information. Plese try again.")})}))}},{key:"handleCancel",value:function(){this.props.onCancel()}},{key:"render",value:function(){var e=this;return t.createElement("div",{className:"edit-task-panel"},t.createElement(C,{bind:[this,"error"]}),t.createElement("div",{className:"form-horizontal"},t.createElement(Wt,{ref:function(t){t&&(e.taskForm=t)},onFormLoaded:this.handleFormTaskLoaded,task:this.props.task}),t.createElement("div",{className:"actions"},t.createElement("button",{type:"button",className:"btn btn-sm btn-default",onClick:this.handleCancel,disabled:this.state.saving},(0,s._)("Cancel")),t.createElement("button",{type:"button",className:"btn btn-sm btn-primary save",onClick:this.handleSave,disabled:this.state.saving||!this.state.editTaskFormLoaded},this.state.saving?t.createElement("span",null,t.createElement("i",{className:"fa fa-circle-notch fa-spin"})," ",(0,s._)("Saving...")):t.createElement("span",null,t.createElement("i",{className:"fa fa-edit"})," ",(0,s._)("Save"))))))}}])&&Vt(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(t.Component);Jt(te,"defaultProps",{}),Jt(te,"propTypes",{task:g().object.isRequired,onSave:g().func.isRequired,onCancel:g().func.isRequired});const ee=te;function ne(t,e,n){return e=re(e),function(t,e){if(e&&("object"===ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,oe()?Reflect.construct(e,n||[],re(t).constructor):e.apply(t,n))}function oe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(oe=function(){return!!t})()}function re(t){return re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},re(t)}function ie(t,e){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ie(t,e)}function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function se(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function le(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,ce(o.key),o)}}function ue(t,e,n){return e&&le(t.prototype,e),n&&le(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ce(t){var e=function(t,e){if("object"!=ae(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=ae(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ae(e)?e:e+""}var he=function(){return ue((function t(e,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};se(this,t),this.label=e,this.asset=n,this.icon=o,this.exportFormats=r,this.exportParams=i}),[{key:"downloadUrl",value:function(t,e){return"/api/projects/".concat(t,"/tasks/").concat(e,"/download/").concat(this.asset)}},{key:"exportId",value:function(){return this.asset.replace(/\..+$/,"")}},{key:"separator",get:function(){return!1}}])}(),pe=function(t){function e(){return se(this,e),ne(this,e,["-"])}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ie(t,e)}(e,t),ue(e,[{key:"downloadUrl",value:function(){return"#"}},{key:"separator",get:function(){return!0}}])}(he),fe=["gtiff","gtiff-rgb","jpg","png","kmz"],de={hillshade:6,color_map:"viridis"},me={all:function(){return[new he((0,s._)("Orthophoto"),"orthophoto.tif","far fa-image",fe),new he((0,s._)("Orthophoto (MBTiles)"),"orthophoto.mbtiles","far fa-image"),new he((0,s._)("Orthophoto (Tiles)"),"orthophoto_tiles.zip","fa fa-table"),new he((0,s._)("Terrain Model"),"dtm.tif","fa fa-chart-area",fe,de),new he((0,s._)("Terrain Model (Tiles)"),"dtm_tiles.zip","fa fa-table"),new he((0,s._)("Surface Model"),"dsm.tif","fa fa-chart-area",fe,de),new he((0,s._)("Surface Model (Tiles)"),"dsm_tiles.zip","fa fa-table"),new he((0,s._)("Point Cloud"),"georeferenced_model.laz","fa fa-cube",["laz","las","ply","csv"]),new he((0,s._)("Point Cloud (3D Tiles)"),"3d_tiles_pointcloud.zip","fa fa-cube"),new he((0,s._)("Textured Model"),"textured_model.zip","fab fa-connectdevelop"),new he((0,s._)("Textured Model (3D Tiles)"),"3d_tiles_model.zip","fab fa-connectdevelop"),new he((0,s._)("Textured Model (glTF)"),"textured_model.glb","fab fa-connectdevelop"),new he((0,s._)("Camera Parameters"),"cameras.json","fa fa-camera"),new he((0,s._)("Camera Shots"),"shots.geojson","fa fa-camera"),new he((0,s._)("Ground Control Points"),"ground_control_points.geojson","far fa-dot-circle"),new he((0,s._)("Quality Report"),"report.pdf","far fa-file-pdf"),new pe,new he((0,s._)("All Assets"),"all.zip","far fa-file-archive")]},excludeSeparators:function(){return me.all().filter((function(t){return!t.separator}))},only:function(t){return me.all().filter((function(e){return-1!==t.indexOf(e.asset)}))}};const ye=me;function ge(t){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(t)}function ve(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Se(o.key),o)}}function be(t,e,n){return e=we(e),function(t,e){if(e&&("object"===ge(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_e()?Reflect.construct(e,n||[],we(t).constructor):e.apply(t,n))}function _e(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_e=function(){return!!t})()}function we(t){return we=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},we(t)}function Ee(t,e){return Ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ee(t,e)}function ke(t,e,n){return(e=Se(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Se(t){var e=function(t,e){if("object"!=ge(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=ge(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ge(e)?e:e+""}var xe=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),ke(e=be(this,n,[t]),"getEpsg",(function(){return"custom"!==e.state.epsg?e.state.epsg:e.state.customEpsg})),ke(e,"handleSelectFormat",(function(t){e.setState({format:t.target.value})})),ke(e,"handleSelectEpsg",(function(t){e.setState({epsg:t.target.value})})),ke(e,"handleChangeCustomEpsg",(function(t){e.setState({customEpsg:t.target.value})})),ke(e,"getExportParams",(function(t){var n={};return(n="function"==typeof e.props.exportParams?j.A.clone(e.props.exportParams()):j.A.clone(e.props.exportParams)).format=t,e.getEpsg()&&(n.epsg=e.getEpsg()),n})),ke(e,"handleExport",(function(t){return t||(t=e.state.format),function(n){var r=e.props.task;e.setState({exporting:!0,error:""});var i=e.getExportParams(t);"custom"===e.state.epsg&&wt.setItem("last_export_custom_epsg",i.epsg),e.exportReq=$.ajax({type:"POST",url:"/api/projects/".concat(r.project,"/tasks/").concat(r.id,"/").concat(e.props.asset,"/export"),data:i}).done((function(t){if(t.celery_task_id)!function(t,e){var n=0,r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/api/workers/check/")+t;!function t(){o().ajax({type:"GET",url:r}).done((function(n){n.error?e(n.error):n.ready?e():setTimeout((function(){return t()}),2e3)})).fail((function(o){console.warn(o),n++<10?setTimeout((function(){return t()}),2e3):e(JSON.stringify(o))}))}()}(t.celery_task_id,(function(o){o?(e.setState({exporting:!1,error:o}),void 0!==n&&n(new Error(o))):(e.setState({exporting:!1}),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";window.location.href="/api/workers/get/".concat(t,"?filename=").concat(e)}(t.celery_task_id,t.filename),void 0!==n&&n())}));else if(t.url)e.setState({exporting:!1}),window.location.href="".concat(t.url,"?filename=").concat(t.filename),void 0!==n&&n();else if(t.error)e.setState({exporting:!1,error:t.error}),void 0!==n&&n(new Error(t.error));else{var r=interpolate((0,s._)("Invalid JSON response: %(error)s"),{error:JSON.stringify(t)});e.setState({exporting:!1,error:r}),void 0!==n&&n(new Error(r))}})).fail((function(t){t=(t.responseJSON||{})[0]||JSON.stringify(t),e.setState({exporting:!1,error:t}),void 0!==n&&n(new Error(t))}))}})),e.efInfo={"gtiff-rgb":{label:"GeoTIFF (RGB)",icon:"fas fa-palette"},gtiff:{label:"GeoTIFF (Raw)",icon:"far fa-image"},jpg:{label:"JPEG (RGB)",icon:"fas fa-palette"},png:{label:"PNG (RGB)",icon:"fas fa-palette"},kmz:{label:"KMZ (RGB)",icon:"fas fa-globe"},laz:{label:"LAZ",icon:"fa fa-cube"},las:{label:"LAS",icon:"fa fa-cube"},ply:{label:"PLY",icon:"fa fa-cube"},csv:{label:"CSV",icon:"fa fa-file-text"}},e.state={error:"",format:t.exportFormats[0],epsg:e.props.task.epsg||null,customEpsg:wt.getItem("last_export_custom_epsg")||"4326",exporting:!1},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ee(t,e)}(n,e),r=n,(i=[{key:"componentWillUnmount",value:function(){this.exportReq&&this.exportReq.abort()}},{key:"render",value:function(){var e,n=this,o=this.state,r=o.epsg,i=o.customEpsg,a=o.exporting,l=o.format,u=this.props.exportFormats,c=this.props.task.epsg,h="custom"===r&&!i||a,p=c?t.createElement("div",null,t.createElement("div",{className:"row form-group form-inline"},t.createElement("label",{className:"col-sm-3 control-label"},(0,s._)("Projection:")),t.createElement("div",{className:"col-sm-9 "},t.createElement("select",{className:"form-control",value:r,onChange:this.handleSelectEpsg},c?t.createElement("option",{value:c},"UTM (EPSG:",c,")"):"",t.createElement("option",{value:"4326"},(0,s._)("Lat/Lon")," (EPSG:4326)"),t.createElement("option",{value:"3857"},(0,s._)("Web Mercator")," (EPSG:3857)"),t.createElement("option",{value:"custom"},(0,s._)("Custom")," EPSG")))),"custom"===r?t.createElement("div",{className:"row form-group form-inline"},t.createElement("label",{className:"col-sm-3 control-label"},"EPSG:"),t.createElement("div",{className:"col-sm-9 "},t.createElement("input",{type:"number",className:"form-control custom-interval",value:i,onChange:this.handleChangeCustomEpsg}))):""):"";return e=this.props.selectorOnly?t.createElement("div",{className:"row form-group form-inline"},t.createElement("label",{className:"col-sm-3 control-label"},(0,s._)("Format:")),t.createElement("div",{className:"col-sm-9 "},t.createElement("select",{className:"form-control",value:l,onChange:this.handleSelectFormat},u.map((function(e){return t.createElement("option",{key:e,value:e},n.efInfo[e].label)}))))):t.createElement("div",{className:"row form-group form-inline"},t.createElement("label",{className:"col-sm-3 control-label"},(0,s._)("Export:")),t.createElement("div",{className:"col-sm-9"},t.createElement("div",{className:"btn-group "+(this.props.dropUp?"dropup":"")},t.createElement("button",{onClick:this.handleExport(u[0]),disabled:h,type:"button",className:"btn btn-sm btn-primary btn-export"},a?t.createElement("i",{className:"fa fa-spin fa-circle-notch"}):t.createElement("i",{className:this.efInfo[u[0]].icon+" fa-fw"})," ",a?(0,s._)("Exporting..."):this.efInfo[u[0]].label),t.createElement("button",{disabled:h,type:"button",className:"btn btn-sm dropdown-toggle btn-primary","data-toggle":"dropdown"},t.createElement("span",{className:"caret"})),t.createElement("ul",{className:"dropdown-menu pull-right"},u.map((function(e){return t.createElement("li",{key:e},t.createElement("a",{href:"javascript:void(0);",onClick:n.handleExport(e)},t.createElement("i",{className:n.efInfo[e].icon+" fa-fw"})," ",n.efInfo[e].label))})))))),t.createElement("div",{className:"export-asset-panel"},this.props.selectorOnly?"":t.createElement(C,{bind:[this,"error"]}),p,e)}}])&&ve(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(t.Component);function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Te(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Ne(o.key),o)}}function Oe(t,e,n){return e=je(e),function(t,e){if(e&&("object"===Pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ce()?Reflect.construct(e,n||[],je(t).constructor):e.apply(t,n))}function Ce(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ce=function(){return!!t})()}function je(t){return je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},je(t)}function Le(t,e){return Le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Le(t,e)}function Ae(t,e,n){return(e=Ne(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ne(t){var e=function(t,e){if("object"!=Pe(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Pe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pe(e)?e:e+""}ke(xe,"defaultProps",{exportFormats:["gtiff-rgb","gtiff","jpg","png","kmz"],asset:"",exportParams:{},task:null,dropUp:!1,selectorOnly:!1}),ke(xe,"propTypes",{exportFormats:g().arrayOf(g().string),asset:g().string.isRequired,exportParams:g().oneOfType([g().func,g().object]),task:g().object.isRequired,dropUp:g().bool,selectorOnly:g().bool});var Ie=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Ae(e=Oe(this,n,[t]),"handleSave",(function(t){e.exportAssetPanel.handleExport()(t)})),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Le(t,e)}(n,e),o=n,(r=[{key:"render",value:function(){var e=this;return t.createElement("div",{className:"export-asset-dialog"},t.createElement(D,{getFormData:function(){},reset:function(){},show:!0,saveIcon:"glyphicon glyphicon-download",title:this.props.assetLabel,savingLabel:(0,s._)("Downloading"),saveLabel:(0,s._)("Download"),saveAction:function(){},handleSaveFunction:this.handleSave,onHide:this.props.onHide},t.createElement(xe,{asset:this.props.asset,task:this.props.task,ref:function(t){e.exportAssetPanel=t},selectorOnly:!0,exportFormats:this.props.exportFormats,exportParams:this.props.exportParams})))}}])&&Te(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);Ae(Ie,"defaultProps",{}),Ae(Ie,"propTypes",{onHide:g().func.isRequired,asset:g().string.isRequired,task:g().object.isRequired,exportFormats:g().arrayOf(g().string),exportParams:g().object,assetLabel:g().string});const Re=Ie;function Me(t){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Me(t)}function ze(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,qe(o.key),o)}}function Fe(t,e,n){return e=De(e),function(t,e){if(e&&("object"===Me(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Be()?Reflect.construct(e,n||[],De(t).constructor):e.apply(t,n))}function Be(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Be=function(){return!!t})()}function De(t){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},De(t)}function Ue(t,e){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ue(t,e)}function Ze(t,e,n){return(e=qe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qe(t){var e=function(t,e){if("object"!=Me(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Me(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Me(e)?e:e+""}var $e=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Ze(e=Fe(this,n),"onHide",(function(){e.setState({exportDialogProps:null}),e.props.onModalClose&&e.props.onModalClose()})),e.state={exportDialogProps:null},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ue(t,e)}(n,e),o=n,(r=[{key:"render",value:function(){var e=this,n=ye.only(this.props.task.available_assets);return t.createElement("div",{className:"asset-download-buttons "+(this.props.showLabel?"btn-group":"")+" "+("up"===this.props.direction?"dropup":"")},this.state.exportDialogProps?t.createElement(Re,{task:this.props.task,asset:this.state.exportDialogProps.asset,exportFormats:this.state.exportDialogProps.exportFormats,exportParams:this.state.exportDialogProps.exportParams,onHide:this.onHide,assetLabel:this.state.exportDialogProps.assetLabel}):"",t.createElement("button",{type:"button",className:"btn btn-sm "+this.props.buttonClass,disabled:this.props.disabled,"data-toggle":"dropdown"},t.createElement("i",{className:"glyphicon glyphicon-download"}),this.props.showLabel?" "+(0,s._)("Download Assets"):""),this.props.showLabel?t.createElement("button",{type:"button",className:"btn btn-sm dropdown-toggle "+this.props.buttonClass,"data-toggle":"dropdown",disabled:this.props.disabled},t.createElement("span",{className:"caret"})):"",t.createElement("ul",{className:"dropdown-menu"},n.map((function(n,o){if(n.separator)return t.createElement("li",{key:o,className:"divider"});var r=void 0;return n.exportFormats&&(r=function(t){t.preventDefault(),e.setState({exportDialogProps:{asset:n.exportId(),exportFormats:n.exportFormats,exportParams:n.exportParams,assetLabel:n.label}}),e.props.onModalOpen&&e.props.onModalOpen()}),t.createElement("li",{key:o},t.createElement("a",{href:n.downloadUrl(e.props.task.project,e.props.task.id),onClick:r},t.createElement("i",{className:n.icon+" fa-fw"})," ",n.label))}))))}}])&&ze(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);Ze($e,"defaultProps",{disabled:!1,direction:"down",buttonClass:"btn-primary",task:null,showLabel:!0}),Ze($e,"propTypes",{disabled:g().bool,task:g().object.isRequired,direction:g().string,buttonClass:g().string,showLabel:g().bool,onModalOpen:g().func,onModalClose:g().func});const We=$e;function He(t){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},He(t)}function Ve(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Ge(o.key),o)}}function Ge(t){var e=function(t,e){if("object"!=He(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=He(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==He(e)?e:e+""}var Ye=",",Ke=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.history=e},(e=[{key:"changeQS",value:function(t,e){this.history.replace(this.history.location.pathname+j.A.replaceSearchQueryParam(this.history.location,t,e)+this.history.location.hash)}},{key:"isValueInQSList",value:function(t,e){var n=j.A.queryParams(this.history.location);return!!n[t]&&n[t].split(Ye).find((function(t){return t==e}))}},{key:"addToQSList",value:function(t,e){var n=j.A.queryParams(this.history.location);n[t]?this.isValueInQSList(t,e)||this.changeQS(t,n[t]+Ye+e):this.changeQS(t,e)}},{key:"removeFromQSList",value:function(t,e){var n=j.A.queryParams(this.history.location);if(n[t]){var o=n[t].split(Ye);this.changeQS(t,o.filter((function(t){return t!=e})).join(Ye))}}},{key:"toggleQSListItem",value:function(t,e,n){n?this.addToQSList(t,e):this.removeFromQSList(t,e)}}])&&Ve(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const Qe=Ke;var Je=n(2881);const Xe=SystemJS;var tn=n.n(Xe);function en(t){return en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},en(t)}function nn(t){return function(t){if(Array.isArray(t))return on(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return on(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?on(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function on(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function rn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,an(o.key),o)}}function an(t){var e=function(t,e){if("object"!=en(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=en(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==en(e)?e:e+""}var sn=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.events=e},e=[{key:"create",value:function(t){var e=this,n=function(n,o){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=function(n){setTimeout((function(){e.events.emit("".concat(t.namespace,"::").concat(o,"::Response"),n)}),0)};n[o]=function(n,r){Array.isArray(n)?e.events.addListener("".concat(t.namespace,"::").concat(o),(function(t){Promise.all(n.map((function(t){return tn().import(t)}))).then((function(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];o=o.map((function(t){return t.map((function(t){return t.default?t.default:t}))}));var s={result:r.apply(void 0,nn((e=Array.from([t])).concat.apply(e,nn(o)))),placeholder:t._placeholder};i(s)}))})):e.events.addListener("".concat(t.namespace,"::").concat(o),(function(t){var e={result:n(t),placeholder:t._placeholder};i(e)}))},n["trigger"+o[0].toUpperCase()+o.slice(1)]=function(n,i){n||(n={}),n._placeholder={},r(n,i),i&&e.events.addListener("".concat(t.namespace,"::").concat(o,"::Response"),(function(t){var o=e.events._currentSubscription;setTimeout((function(){o.remove()}),0),t.placeholder===n._placeholder&&i(t.result)})),e.events.emit("".concat(t.namespace,"::").concat(o),n)}},o={};return t.endpoints.forEach((function(t){Array.isArray(t)||(t=[t]),n.apply(void 0,[o].concat(nn(t)))})),t.helpers&&(o=Object.assign(o,t.helpers)),o}}],e&&rn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),ln=(n(3481),j.A.assert),un=function(t){ln(void 0!==t.map),ln(void 0!==t.tiles)};const cn={namespace:"Map",endpoints:[["willAddControls",un],["didAddControls",function(t){ln(void 0!==t.controls),un(t)}],["addActionButton",un]]},hn={namespace:"Dashboard",endpoints:["addTaskActionButton","addNewTaskPanelItem","addNewTaskButton"]},pn={namespace:"App",endpoints:["ready"]},fn={namespace:"SharePopup",endpoints:["addLinkControl"]};if(!window.PluginsAPI){var dn=new Je.EventEmitter,mn=new sn(dn);tn().config({baseURL:"/plugins",map:{css:"/static/app/js/vendor/css.js","globals-loader":"/static/app/js/vendor/globals-loader.js"},meta:{"*.css":{loader:"css"},jQuery:{loader:"globals-loader",exports:"$"},leaflet:{loader:"globals-loader",exports:"L"},ReactDOM:{loader:"globals-loader",exports:"ReactDOM"},React:{loader:"globals-loader",exports:"React"},SystemJS:{loader:"globals-loader",exports:"SystemJS"}}}),window.PluginsAPI={Map:mn.create(cn),Dashboard:mn.create(hn),App:mn.create(pn),SharePopup:mn.create(fn),SystemJS:tn(),events:dn}}const yn=window.PluginsAPI;function gn(t){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gn(t)}function vn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Sn(o.key),o)}}function bn(t,e,n){return e=wn(e),function(t,e){if(e&&("object"===gn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_n()?Reflect.construct(e,n||[],wn(t).constructor):e.apply(t,n))}function _n(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_n=function(){return!!t})()}function wn(t){return wn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wn(t)}function En(t,e){return En=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},En(t,e)}function kn(t,e,n){return(e=Sn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sn(t){var e=function(t,e){if("object"!=gn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=gn(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==gn(e)?e:e+""}var xn=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=bn(this,n,[t])).state={buttons:[]},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&En(t,e)}(n,e),o=n,(r=[{key:"componentDidMount",value:function(){var t=this;yn.Dashboard.triggerAddTaskActionButton({task:this.props.task},(function(e){e&&t.setState(i()(t.state,{buttons:{$push:[e]}}))}))}},{key:"render",value:function(){return this.state.buttons.length>0?t.createElement("div",{className:"row plugin-action-buttons "+(this.props.disabled?"disabled":"")},this.state.buttons.map((function(e,n){return t.createElement("div",{key:n},e)}))):""}}])&&vn(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);kn(xn,"defaultProps",{task:null,disabled:!1}),kn(xn,"propTypes",{task:g().object.isRequired,disabled:g().bool});const Pn=xn;function Tn(t){return Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tn(t)}function On(){return On=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},On.apply(this,arguments)}function Cn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Rn(o.key),o)}}function jn(t,e,n){return e=An(e),function(t,e){if(e&&("object"===Tn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ln()?Reflect.construct(e,n||[],An(t).constructor):e.apply(t,n))}function Ln(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ln=function(){return!!t})()}function An(t){return An=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},An(t)}function Nn(t,e){return Nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Nn(t,e)}function In(t,e,n){return(e=Rn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rn(t){var e=function(t,e){if("object"!=Tn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Tn(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Tn(e)?e:e+""}var Mn=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),In(e=jn(this,n,[t]),"handleProjectChange",(function(t){e.setState({projectId:t.target.value})})),e.state={projectId:t.task.project,projects:[],loading:!0},e.getFormData=e.getFormData.bind(e),e.onShow=e.onShow.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Nn(t,e)}(n,e),r=n,(i=[{key:"getFormData",value:function(){return{project:this.state.projectId}}},{key:"onShow",value:function(){var t=this;this.setState({loading:!0,projects:[]}),this.serverRequest=o().getJSON("/api/projects/?ordering=-created_at",(function(e){t.setState({projects:e.filter((function(t){return-1!==t.permissions.indexOf("add")}))})})).fail((function(e,n,o){t.dialog.setState({error:interpolate((0,s._)("Could not load projects list: %(error)s"),{error:n})})})).always((function(){t.setState({loading:!1}),t.serverRequest=null}))}},{key:"show",value:function(){this.dialog.show()}},{key:"hide",value:function(){this.dialog.hide()}},{key:"componentWillUnmount",value:function(){this.serverRquest&&this.serverRquest.abort()}},{key:"render",value:function(){var e=this;return t.createElement(D,On({},this.props,{getFormData:this.getFormData,onShow:this.onShow,ref:function(t){e.dialog=t}}),t.createElement("div",{style:{minHeight:"50px"}},this.state.loading?t.createElement("i",{className:"fa fa-circle-notch fa-spin fa-fw name-loading"}):t.createElement("div",{className:"form-group"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Project")),t.createElement("div",{className:"col-sm-10"},t.createElement("select",{className:"form-control",value:this.state.projectId,onChange:this.handleProjectChange},this.state.projects.map((function(e){return t.createElement("option",{value:e.id,key:e.id},e.name)})))))))}}])&&Cn(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(t.Component);In(Mn,"defaultProps",{title:(0,s._)("Move Task"),saveLabel:(0,s._)("Save Changes"),savingLabel:(0,s._)("Moving..."),saveIcon:"far fa-edit",show:!0}),In(Mn,"propTypes",{task:g().object.isRequired,saveAction:g().func.isRequired,title:g().string,saveLabel:g().string,savingLabel:g().string,saveIcon:g().string,show:g().bool});const zn=Mn;var Fn={};const Bn=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"div",o=t+"|"+e;if(Fn[o])return Fn[o];var r=document.createElement(n);return r.style.display="none",r.className=t,document.body.appendChild(r),Fn[o]=getComputedStyle(r)[e],document.body.removeChild(r),Fn[o]};function Dn(t){return Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dn(t)}function Un(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Vn(o.key),o)}}function Zn(t,e,n){return e=$n(e),function(t,e){if(e&&("object"===Dn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,qn()?Reflect.construct(e,n||[],$n(t).constructor):e.apply(t,n))}function qn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(qn=function(){return!!t})()}function $n(t){return $n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$n(t)}function Wn(t,e){return Wn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wn(t,e)}function Hn(t,e,n){return(e=Vn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vn(t){var e=function(t,e){if("object"!=Dn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Dn(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dn(e)?e:e+""}var Gn=function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Zn(this,n,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wn(t,e)}(n,e),o=n,(r=[{key:"render",value:function(){var e=this;if(!this.props.children)return t.createElement("span",null);var n="";if("string"==typeof this.props.children)n=t.createElement("span",{dangerouslySetInnerHTML:{__html:(0,s.interpolate)(this.props.children,this.props.params)}});else{n=[];var o=0;this.props.children.forEach((function(r){"string"==typeof r?n.push(t.createElement("span",{key:o,dangerouslySetInnerHTML:{__html:(0,s.interpolate)(r,e.props.params)}})):n.push(t.createElement("span",{key:o},r)),o++}))}return n}}])&&Un(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);Hn(Gn,"propTypes",{params:g().object}),Hn(Gn,"defaultProps",{params:{}});const Yn=Gn;function Kn(t){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kn(t)}function Qn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Jn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,ro(o.key),o)}}function Xn(t,e,n){return e=eo(e),function(t,e){if(e&&("object"===Kn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,to()?Reflect.construct(e,n||[],eo(t).constructor):e.apply(t,n))}function to(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(to=function(){return!!t})()}function eo(t){return eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},eo(t)}function no(t,e){return no=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},no(t,e)}function oo(t,e,n){return(e=ro(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ro(t){var e=function(t,e){if("object"!=Kn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Kn(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Kn(e)?e:e+""}var io=function(e){function n(t){var e;for(var o in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),oo(e=Xn(this,n),"handleMoveTask",(function(){e.setState({showMoveDialog:!0})})),oo(e,"handleDuplicateTask",(function(){e.setState({actionLoading:!0}),e.genActionApiCall("duplicate",{success:function(t){t.task&&e.props.onDuplicate&&e.props.onDuplicate(t.task)},always:function(){e.setState({actionLoading:!1})}})()})),oo(e,"moveTaskAction",(function(t){return t.project!==e.state.task.project&&$.ajax({url:"/api/projects/".concat(e.state.task.project,"/tasks/").concat(e.state.task.id,"/"),contentType:"application/json",data:JSON.stringify(t),dataType:"json",type:"PATCH"}).done(e.props.onMove)})),oo(e,"handleTagClick",(function(t){return function(){e.props.onTagClicked&&e.props.onTagClicked(t)}})),e.historyNav=new Qe(t.history),e.state={expanded:e.historyNav.isValueInQSList("project_task_expanded",t.data.id),task:{},time:t.data.processing_time,actionError:"",actionButtonsDisabled:!1,editing:!1,memoryError:!1,friendlyTaskError:"",pluginActionButtons:[],view:"basic",showMoveDialog:!1,actionLoading:!1},t.data)e.state.task[o]=t.data[o];return e.toggleExpanded=e.toggleExpanded.bind(e),e.consoleOutputUrl=e.consoleOutputUrl.bind(e),e.stopEditing=e.stopEditing.bind(e),e.startEditing=e.startEditing.bind(e),e.checkForCommonErrors=e.checkForCommonErrors.bind(e),e.handleEditTaskSave=e.handleEditTaskSave.bind(e),e.setView=e.setView.bind(e),e.backgroundSuccessColor=Bn("theme-background-success","backgroundColor"),e.backgroundFailedColor=Bn("theme-background-failed","backgroundColor"),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&no(t,e)}(n,e),o=n,r=[{key:"shouldRefresh",value:function(){return null!==this.state.task.pending_action||-1===[h.COMPLETED,h.FAILED,h.CANCELED].indexOf(this.state.task.status)&&(-1!==[h.QUEUED,h.RUNNING,null].indexOf(this.state.task.status)&&this.state.task.processing_node||!this.state.task.uuid&&this.state.task.processing_node&&!this.state.task.last_error)}},{key:"loadTimer",value:function(t){var e=this;this.processingTimeInterval||(this.setState({time:t}),this.processingTimeInterval=setInterval((function(){e.setState({time:e.state.time+=1e3})}),1e3))}},{key:"setView",value:function(t){var e=this;return function(){e.setState({view:t})}}},{key:"unloadTimer",value:function(){this.processingTimeInterval&&(clearInterval(this.processingTimeInterval),this.processingTimeInterval=null),this.state.task.processing_time&&this.setState({time:this.state.task.processing_time})}},{key:"componentDidMount",value:function(){var t=this;this.shouldRefresh()&&(this.refreshTimeout=setTimeout((function(){return t.refresh()}),this.props.refreshInterval||3e3)),this.state.task.status===h.RUNNING&&this.loadTimer(this.state.task.processing_time)}},{key:"refresh",value:function(){var t=this;this.refreshRequest=$.getJSON("/api/projects/".concat(this.state.task.project,"/tasks/").concat(this.state.task.id,"/"),(function(e){if(e.id){var n=t.state.task.status;t.setState({task:e,actionButtonsDisabled:!1}),n!==t.state.task.status&&(t.state.task.status===h.RUNNING?(t.console&&t.console.clear(),t.basicView&&t.basicView.reset(),t.loadTimer(t.state.task.processing_time)):(t.setState({time:t.state.task.processing_time}),t.unloadTimer()),t.state.task.status!==h.FAILED&&t.setState({memoryError:!1,friendlyTaskError:""}))}else console.warn("Cannot refresh task: "+e);t.setAutoRefresh()})).fail((function(e,n,o){"Not Found"===o?t.props.onDelete&&t.props.onDelete(t.state.task.id):t.setAutoRefresh()}))}},{key:"setAutoRefresh",value:function(){var t=this;this.shouldRefresh()&&(this.refreshTimeout=setTimeout((function(){return t.refresh()}),this.props.refreshInterval||3e3))}},{key:"componentWillUnmount",value:function(){this.unloadTimer(),this.refreshRequest&&this.refreshRequest.abort(),this.refreshTimeout&&clearTimeout(this.refreshTimeout)}},{key:"toggleExpanded",value:function(){var t=!this.state.expanded;this.historyNav.toggleQSListItem("project_task_expanded",this.props.data.id,t),this.setState({expanded:t})}},{key:"consoleOutputUrl",value:function(t){return"/api/projects/".concat(this.state.task.project,"/tasks/").concat(this.state.task.id,"/output/?line=").concat(t)}},{key:"hoursMinutesSecs",value:function(t){if(0===t||-1===t)return"-- : -- : --";var e=36e5,n=Math.floor(t/e),o=Math.floor((t-n*e)/6e4),r=Math.round((t-n*e-6e4*o)/1e3),i=function(t){return t<10?"0"+t:t};return 60===r&&(o++,r=0),60===o&&(n++,o=0),[i(n),i(o),i(r)].join(":")}},{key:"genActionApiCall",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(){var o=function(){e.setState({actionButtonsDisabled:!0});var o="/api/projects/".concat(e.state.task.project,"/tasks/").concat(e.state.task.id,"/").concat(t,"/");$.post(o,{uuid:e.state.task.uuid}).done((function(t){t.success?(e.refresh(),void 0!==n.success&&n.success(t)):e.setState({actionError:t.error||n.defaultError||(0,s._)("Cannot complete operation."),actionButtonsDisabled:!1,expanded:!0})})).fail((function(){e.setState({actionError:n.defaultError||(0,s._)("Cannot complete operation."),actionButtonsDisabled:!1})})).always((function(){void 0!==n.always&&n.always()}))};n.confirm?window.confirm(n.confirm)&&o():o()}}},{key:"optionsToList",value:function(t){return Array.isArray(t)?0===t.length?"Default":t.map((function(t){return"".concat(t.name,": ").concat(t.value)})).join(", "):""}},{key:"startEditing",value:function(){this.setState({expanded:!0,editing:!0})}},{key:"stopEditing",value:function(){this.setState({editing:!1})}},{key:"checkForCommonErrors",value:function(t){var e,n=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Qn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;-1!==o.indexOf("Killed")||-1!==o.indexOf("MemoryError")||-1!==o.indexOf("std::bad_alloc")||-1!==o.indexOf("Child returned 137")||-1!==o.indexOf("loky.process_executor.TerminatedWorkerError:")||-1!==o.indexOf("Failed to allocate memory")?this.setState({memoryError:!0}):-1!==o.indexOf("SVD did not converge")||-1!==o.indexOf("0 partial reconstructions in total")?this.setState({friendlyTaskError:(0,s.interpolate)((0,s._)("It looks like there might be one of the following problems: %(problems)s You can read more about best practices for capturing good images %(link)s."),{problems:"<ul>\n          <li>".concat((0,s._)("Not enough images"),"</li>\n          <li>").concat((0,s._)("Not enough overlap between images"),"</li>\n          <li>").concat((0,s._)("Images might be too blurry (common with phone cameras)"),"</li>\n          <li>").concat((0,s._)("The min-num-features task option is set too low, try increasing it by 25%"),"</li>\n        </ul>"),link:"<a href='https://docs.webodm.net/references/create-successful-maps' target='_blank'>".concat((0,s._)("here"),"</a>")})}):-1!==o.indexOf("Illegal instruction")||-1!==o.indexOf("Child returned 132")?this.setState({friendlyTaskError:(0,s.interpolate)((0,s._)("It looks like this computer might be too old. WebODM requires a computer with a 64-bit CPU supporting MMX, SSE, SSE2, SSE3 and SSSE3 instruction set support or higher. You can still run WebODM if you compile your own docker images. See %(link)s for more information."),{link:"<a href='https://github.com/OpenDroneMap/WebODM#common-troubleshooting'>".concat((0,s._)("this page"),"</a>")})}):-1!==o.indexOf("Child returned 127")&&this.setState({friendlyTaskError:(0,s._)("The processing node is missing a program necessary to complete the task. This might indicate a corrupted installation. If you built OpenDroneMap, please check that all programs built without errors.")})}}catch(t){n.e(t)}finally{n.f()}}},{key:"isMacOS",value:function(){return"MacIntel"===window.navigator.platform}},{key:"handleEditTaskSave",value:function(t){this.setState({task:t,editing:!1}),this.props.onEdited&&this.props.onEdited(t),this.setAutoRefresh()}},{key:"getRestartSubmenuItems",value:function(){var t=this.state.task,e={};for(var n in[{action:"dataset",label:(0,s._)("Load Dataset"),icon:"fa fa-database"},{action:"opensfm",label:(0,s._)("Structure From Motion"),icon:"fa fa-camera"},{action:"openmvs",label:(0,s._)("Multi View Stereo"),icon:"fa fa-braille"},{action:"odm_filterpoints",label:(0,s._)("Point Filtering"),icon:"fa fa-filter"},{action:"odm_meshing",label:(0,s._)("Meshing"),icon:"fa fa-cube"},{action:"mvs_texturing",label:(0,s._)("Texturing"),icon:"fab fa-connectdevelop"},{action:"odm_georeferencing",label:(0,s._)("Georeferencing"),icon:"fa fa-globe"},{action:"odm_dem",label:(0,s._)("DEM"),icon:"fa fa-chart-area"},{action:"odm_orthophoto",label:(0,s._)("Orthophoto"),icon:"far fa-image"},{action:"odm_report",label:(0,s._)("Report"),icon:"far fa-file-alt"},{action:"odm_postprocess",label:(0,s._)("Postprocess"),icon:"fa fa-cog"}].forEach((function(t){return e[t.action]=t})),e)e[n].label=(0,s.interpolate)((0,s._)("From %(stage)s"),{stage:e[n].label}),e[n].onClick=this.genRestartAction(n);var o=t.can_rerun_from.map((function(t){return e[t]})).filter((function(t){return void 0!==t}));return o.length>0&&-1!==[h.CANCELED,h.FAILED].indexOf(t.status)&&o.unshift({label:(0,s._)("Resume Processing"),icon:"fa fa-bolt",onClick:this.genRestartAction(t.can_rerun_from[t.can_rerun_from.length-1])}),o}},{key:"genRestartAction",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.state.task,o=this.genActionApiCall("restart",{success:function(){t.setState({time:-1})},defaultError:(0,s._)("Cannot restart task.")});return function(){(function(e){if(t.setState({actionButtonsDisabled:!0}),null===e)n.options=n.options.filter((function(t){return"rerun-from"!==t.name}));else{var o=null;(o=n.options.find((function(t){return"rerun-from"===t.name})))?o.value=e:n.options.push({name:"rerun-from",value:e})}var r={options:n.options};return null===e&&(r.uuid=""),$.ajax({url:"/api/projects/".concat(n.project,"/tasks/").concat(n.id,"/"),contentType:"application/json",data:JSON.stringify(r),dataType:"json",type:"PATCH"}).done((function(e){t.setState({task:e})})).fail((function(){t.setState({actionError:(0,s.interpolate)((0,s._)("Cannot restart task from (stage)s."),{stage:e||"the start"}),actionButtonsDisabled:!1})}))})(e).then(o)}}},{key:"render",value:function(){var e=this,n=this.state.task,o=null!==n.name?n.name:(0,s.interpolate)((0,s._)("Task #%(number)s"),{number:n.id}),r=""!==n.import_url,i=h.description(n.status);""===i&&(i=(0,s._)("Sending images to processing node")),n.processing_node||r||(i=(0,s._)("Waiting for a node...")),null!==n.pending_action&&(i=m.description(n.pending_action));var l=this.state.actionButtonsDisabled||-1!==[m.CANCEL,m.REMOVE,m.RESTART].indexOf(n.pending_action),u=this.props.hasPermission("change")&&-1!==[h.FAILED,h.COMPLETED,h.CANCELED].indexOf(n.status),c=this.state.actionLoading,p="";if(this.state.expanded){var f=!1,d=this.state.memoryError&&n.status==h.FAILED,y=""!==this.state.friendlyTaskError&&n.status==h.FAILED,g="Process exited with code 1"===n.last_error&&!d&&!y&&n.status==h.FAILED,v=this.isMacOS()?"http://stackoverflow.com/a/39720010":"https://docs.docker.com/docker-for-windows/#advanced",b=[],_=function(t,e,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};b.push({className:e,icon:n,label:t,onClick:o,options:r})};if(n.status===h.COMPLETED&&(-1!==n.available_assets.indexOf("orthophoto.tif")||-1!==n.available_assets.indexOf("dsm.tif")?_(" "+(0,s._)("View Map"),"btn-primary","fa fa-globe",(function(){location.href="/map/project/".concat(n.project,"/task/").concat(n.id,"/")})):f=-1===n.available_assets.indexOf("orthophoto.tif"),_(" "+(0,s._)("View 3D Model"),"btn-primary","fa fa-cube",(function(){location.href="/3d/project/".concat(n.project,"/task/").concat(n.id,"/")}))),!u&&n.processing_node||_((0,s._)("Edit"),"btn-primary pull-right edit-button","glyphicon glyphicon-pencil",(function(){e.startEditing()}),{className:"inline"}),-1!==[h.QUEUED,h.RUNNING,null].indexOf(n.status)&&(n.processing_node||r)&&this.props.hasPermission("change")&&_((0,s._)("Cancel"),"btn-primary","glyphicon glyphicon-remove-circle",this.genActionApiCall("cancel",{defaultError:(0,s._)("Cannot cancel task.")})),-1!==[h.FAILED,h.COMPLETED,h.CANCELED].indexOf(n.status)&&n.processing_node&&this.props.hasPermission("change")&&!r){var w=n.can_rerun_from.length>1?n.can_rerun_from[1]:null;_((0,s._)("Restart"),"btn-primary","glyphicon glyphicon-repeat",this.genRestartAction(w),{subItems:this.getRestartSubmenuItems()})}this.props.hasPermission("delete")&&_((0,s._)("Delete"),"btn-danger","fa fa-trash fa-fw",this.genActionApiCall("remove",{confirm:(0,s._)("All information related to this task, including images, maps and models will be deleted. Continue?"),defaultError:(0,s._)("Cannot delete task.")})),b=t.createElement("div",{className:"action-buttons"},n.status===h.COMPLETED?t.createElement(We,{task:this.state.task,disabled:l}):"",b.map((function(e){var n=e.options.subItems||[],o=e.options.className||"",r=t.createElement("button",{type:"button",className:"btn btn-sm "+e.className,onClick:e.onClick,disabled:l},t.createElement("i",{className:e.icon}),e.label);return n.length>0&&(r=t.createElement("button",{type:"button",className:"btn btn-sm "+e.className,"data-toggle":"dropdown",disabled:l},t.createElement("i",{className:e.icon}),e.label)),t.createElement("div",{key:e.label,className:"inline-block "+(n.length>0?"btn-group":"")+" "+o},r,n.length>0&&[t.createElement("button",{key:"dropdown-button",disabled:l,type:"button",className:"btn btn-sm dropdown-toggle "+e.className,"data-toggle":"dropdown"},t.createElement("span",{className:"caret"})),t.createElement("ul",{key:"dropdown-menu",className:"dropdown-menu"},n.map((function(e){return t.createElement("li",{key:e.label},t.createElement("a",{href:"javascript:void(0);",onClick:e.onClick},t.createElement("i",{className:e.icon+" fa-fw "}),e.label))})))])})));var E=n.statistics;p=t.createElement("div",{className:"expanded-panel"},t.createElement("div",{className:"row"},t.createElement("div",{className:"col-md-12 no-padding"},t.createElement("table",{className:"table table-condensed info-table"},t.createElement("tbody",null,t.createElement("tr",null,t.createElement("td",null,t.createElement("strong",null,(0,s._)("Created on:"))),t.createElement("td",null,new Date(n.created_at).toLocaleString())),t.createElement("tr",null,t.createElement("td",null,t.createElement("strong",null,(0,s._)("Processing Node:"))),t.createElement("td",null,n.processing_node_name||"-"," (",n.auto_processing_node?(0,s._)("auto"):(0,s._)("manual"),")")),Array.isArray(n.options)&&t.createElement("tr",null,t.createElement("td",null,t.createElement("strong",null,(0,s._)("Options:"))),t.createElement("td",null,this.optionsToList(n.options))),E&&E.gsd&&t.createElement("tr",null,t.createElement("td",null,t.createElement("strong",null,(0,s._)("Average GSD:"))),t.createElement("td",null,parseFloat(E.gsd.toFixed(2)).toLocaleString()," cm")),E&&E.area&&t.createElement("tr",null,t.createElement("td",null,t.createElement("strong",null,(0,s._)("Area:"))),t.createElement("td",null,parseFloat(E.area.toFixed(2)).toLocaleString()," m")),E&&E.pointcloud&&E.pointcloud.points&&t.createElement("tr",null,t.createElement("td",null,t.createElement("strong",null,(0,s._)("Reconstructed Points:"))),t.createElement("td",null,E.pointcloud.points.toLocaleString())),n.size>0&&t.createElement("tr",null,t.createElement("td",null,t.createElement("strong",null,(0,s._)("Disk Usage:"))),t.createElement("td",null,j.A.bytesToSize(1024*n.size*1024))),t.createElement("tr",null,t.createElement("td",null,t.createElement("strong",null,(0,s._)("Task Output:"))),t.createElement("td",null,t.createElement("div",{className:"btn-group btn-toggle"},t.createElement("button",{onClick:this.setView("console"),className:"btn btn-xs "+("basic"===this.state.view?"btn-default":"btn-primary")},(0,s._)("On")),t.createElement("button",{onClick:this.setView("basic"),className:"btn btn-xs "+("console"===this.state.view?"btn-default":"btn-primary")},(0,s._)("Off"))))))),"console"===this.state.view?t.createElement(a.A,{className:"floatfix",source:this.consoleOutputUrl,refreshInterval:this.shouldRefresh()?3e3:void 0,autoscroll:!0,height:200,ref:function(t){return e.console=t},onAddLines:this.checkForCommonErrors,showConsoleButtons:!0,maximumLines:500}):"",f?t.createElement("div",{className:"task-warning"},t.createElement("i",{className:"fa fa-warning"})," ",t.createElement("span",null,(0,s._)("An orthophoto could not be generated. To generate one, make sure GPS information is embedded in the EXIF tags of your images, or use a Ground Control Points (GCP) file."))):"",d?t.createElement("div",{className:"task-warning"},t.createElement("i",{className:"fa fa-support"})," ",t.createElement(Yn,{params:{memlink:'<a href="'.concat(v,"\" target='_blank'>").concat((0,s._)("enough RAM allocated"),"</a>"),cloudlink:"<a href='https://webodm.net' target='_blank'>".concat((0,s._)("cloud processing node"),"</a>")}},(0,s._)("It looks like your processing node ran out of memory. If you are using docker, make sure that your docker environment has %(memlink)s. Alternatively, make sure you have enough physical RAM, reduce the number of images, make your images smaller, or reduce the max-concurrency parameter from the task's options. You can also try to use a %(cloudlink)s."))):"",y?t.createElement("div",{className:"task-warning"},t.createElement("i",{className:"fa fa-support"})," ",t.createElement("span",{dangerouslySetInnerHTML:{__html:this.state.friendlyTaskError}})):"",g?t.createElement("div",{className:"task-warning"},t.createElement("i",{className:"fa fa-info-circle"})," ",t.createElement("div",{className:"inline"},t.createElement(Yn,{params:{link:'<a href="'.concat(window.__taskOptionsDocsLink,'" target="_blank">').concat(window.__taskOptionsDocsLink.replace("https://",""),"</a>")}},(0,s._)('"Process exited with code 1" means that part of the processing failed. Sometimes it\'s a problem with the dataset, sometimes it can be solved by tweaking the Task Options. Check the documentation at %(link)s')))):"")),t.createElement("div",{className:"row clearfix"},t.createElement(C,{bind:[this,"actionError"]}),b),t.createElement(Pn,{task:n,disabled:l})),this.state.editing&&(p=t.createElement("div",{className:"task-list-item"},t.createElement("div",{className:"row no-padding"},t.createElement(ee,{task:this.state.task,onSave:this.handleEditTaskSave,onCancel:this.stopEditing}))))}var k=h.icon(n.status),S=function(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"neutral",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i="rgba(255, 255, 255, 0.0)";return"done"===o?i=e.backgroundSuccessColor:"error"===o&&(i=e.backgroundFailedColor),t.createElement("div",{className:"status-label theme-border-primary "+o,style:{background:"linear-gradient(90deg, ".concat(i," ").concat(r,"%, rgba(255, 255, 255, 0) ").concat(r,"%)")},title:n},t.createElement("i",{className:k})," ",n)},x="",P=!1;if(n.last_error)x=S(n.last_error,"error");else if(n.processing_node||r||!this.props.hasPermission("change"))if(n.partial&&!n.pending_action)k="fa fa-hourglass-3",x=S((0,s._)("Waiting for image upload..."));else{var T=100,O="done";n.pending_action===m.RESIZE?T=100*n.resize_progress:null===n.status?T=100*n.upload_progress:n.status===h.RUNNING?T=100*n.running_progress:n.status===h.FAILED?O="error":n.status!==h.COMPLETED&&(O="neutral"),x=S(i,O,T)}else x=S((0,s._)("Set a processing node")),k="fa fa-hourglass-3",P=!0;var L=[],A=function(e,n,o){L.push(t.createElement("li",{key:e},t.createElement("a",{href:"javascript:void(0)",onClick:o},t.createElement("i",{className:n}),e)))};-1!==[h.QUEUED,h.RUNNING,null].indexOf(n.status)&&(n.processing_node||r)&&this.props.hasPermission("change")&&A((0,s._)("Cancel"),"glyphicon glyphicon-remove-circle",this.genActionApiCall("cancel",{defaultError:(0,s._)("Cannot cancel task.")})),(u||!n.processing_node&&this.props.hasPermission("change"))&&L.push(t.createElement("li",{key:"edit"},t.createElement("a",{href:"javascript:void(0)",onClick:this.startEditing},t.createElement("i",{className:"glyphicon glyphicon-pencil"}),(0,s._)("Edit")))),u&&L.push(t.createElement("li",{key:"move"},t.createElement("a",{href:"javascript:void(0)",onClick:this.handleMoveTask},t.createElement("i",{className:"fa fa-arrows-alt"}),(0,s._)("Move"))),t.createElement("li",{key:"duplicate"},t.createElement("a",{href:"javascript:void(0)",onClick:this.handleDuplicateTask},t.createElement("i",{className:"fa fa-copy"}),(0,s._)("Duplicate")))),this.props.hasPermission("delete")&&(L.push(t.createElement("li",{key:"sep",role:"separator",className:"divider"})),A((0,s._)("Delete"),"fa fa-trash",this.genActionApiCall("remove",{confirm:(0,s._)("All information related to this task, including images, maps and models will be deleted. Continue?"),defaultError:(0,s._)("Cannot delete task.")})));var N="fa-ellipsis-h";c&&(N="fa-circle-notch fa-spin fa-fw");var I=Et(n.tags);return t.createElement("div",{className:"task-list-item"},this.state.showMoveDialog?t.createElement(zn,{task:n,ref:function(t){e.moveTaskDialog=t},onHide:function(){return e.setState({showMoveDialog:!1})},saveAction:this.moveTaskAction}):"",t.createElement("div",{className:"row"},t.createElement("div",{className:"col-sm-5 col-xs-12 name"},t.createElement("i",{onClick:this.toggleExpanded,className:"clickable far "+(this.state.expanded?"fa-minus-square":" fa-plus-square")})," ",t.createElement("a",{href:"javascript:void(0);",onClick:this.toggleExpanded,className:"name-link"},o),I.length>0?I.map((function(n,o){return t.createElement("div",{key:o,className:"tag-badge small-badge",onClick:e.handleTagClick(n)},n)})):""),t.createElement("div",{className:"col-sm-1 col-xs-5 details"},t.createElement("i",{className:"far fa-image"})," ",n.images_count),t.createElement("div",{className:"col-sm-2 col-xs-5 details"},t.createElement("i",{className:"far fa-clock"})," ",this.hoursMinutesSecs(this.state.time)),t.createElement("div",{className:"col-xs-2 text-right visible-xs-block"},L.length>0?t.createElement("div",{className:"btn-group"},t.createElement("button",{disabled:l||c,className:"btn task-actions btn-secondary btn-xs dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},t.createElement("i",{className:"fa "+N})),t.createElement("ul",{className:"dropdown-menu dropdown-menu-right"},L)):""),t.createElement("div",{className:"col-sm-3 col-xs-12"},P?t.createElement("a",{href:"javascript:void(0);",onClick:this.startEditing},x):x),t.createElement("div",{className:"col-sm-1 text-right hidden-xs"},L.length>0?t.createElement("div",{className:"btn-group"},t.createElement("button",{disabled:l||c,className:"btn task-actions btn-secondary btn-xs dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},t.createElement("i",{className:"fa "+N})),t.createElement("ul",{className:"dropdown-menu dropdown-menu-right"},L)):"")),p)}}],r&&Jn(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);oo(io,"propTypes",{history:g().object.isRequired,data:g().object.isRequired,refreshInterval:g().number,onDelete:g().func,onMove:g().func,onDuplicate:g().func,hasPermission:g().func,onEdited:g().func,onTagClicked:g().func});const ao=io;function so(t){return so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},so(t)}function lo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,mo(o.key),o)}}function uo(t,e,n){return e=ho(e),function(t,e){if(e&&("object"===so(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,co()?Reflect.construct(e,n||[],ho(t).constructor):e.apply(t,n))}function co(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(co=function(){return!!t})()}function ho(t){return ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ho(t)}function po(t,e){return po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},po(t,e)}function fo(t,e,n){return(e=mo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mo(t){var e=function(t,e){if("object"!=so(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=so(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==so(e)?e:e+""}var yo=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),fo(e=uo(this,n,[t]),"moveTask",(function(t){e.refresh(),e.props.onTaskMoved&&e.props.onTaskMoved(t)})),fo(e,"notifyTagsChanged",(function(){var t=e.state.tasks,n=[];t&&t.forEach((function(t){t.tags&&t.tags.forEach((function(t){-1===n.indexOf(t)&&n.push(t)}))})),n.sort(),e.props.onTagsChanged&&e.props.onTagsChanged(n)})),fo(e,"taskEdited",(function(t){for(var n=e.state.tasks,o=0;o<n.length;o++)if(n[o].id===t.id){n[o]=t;break}e.setState({tasks:n}),setTimeout((function(){return e.notifyTagsChanged()}),0)})),fo(e,"arrayContainsAll",(function(t,e){for(var n=!1,o=0;o<e.length;o++)if(-1===t.indexOf(e[o])){n=!0;break}return!n})),e.historyNav=new Qe(t.history),e.state={tasks:[],error:"",loading:!0,filterText:"",filterTags:[]},e.refresh=e.refresh.bind(e),e.retry=e.retry.bind(e),e.deleteTask=e.deleteTask.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&po(t,e)}(n,e),r=n,(i=[{key:"componentDidMount",value:function(){this.loadTaskList()}},{key:"refresh",value:function(){this.loadTaskList()}},{key:"retry",value:function(){this.setState({error:"",loading:!0}),this.refresh()}},{key:"applyFilter",value:function(t,e){this.setState({filterText:t,filterTags:e})}},{key:"loadTaskList",value:function(){var t=this;this.setState({loading:!0}),this.taskListRequest=o().getJSON(this.props.source,(function(e){1===e.length&&t.historyNav.addToQSList("project_task_expanded",e[0].id),t.setState({tasks:e}),setTimeout((function(){return t.notifyTagsChanged()}),0)})).fail((function(e,n,o){t.setState({error:(0,s.interpolate)((0,s._)("Could not load task list: %(error)s"),{error:n})})})).always((function(){t.setState({loading:!1})}))}},{key:"componentWillUnmount",value:function(){this.taskListRequest.abort()}},{key:"deleteTask",value:function(t){this.setState({tasks:this.state.tasks.filter((function(e){return e.id!==t}))}),this.props.onDelete&&this.props.onDelete(t)}},{key:"render",value:function(){var e=this,n="";return this.state.loading?n=t.createElement("span",null,(0,s._)("Loading...")," ",t.createElement("i",{className:"fa fa-sync fa-spin fa-fw"})):this.state.error?n=t.createElement("span",null,(0,s.interpolate)((0,s._)("Error: %(error)s"),{error:this.state.error})," ",t.createElement("a",{href:"javascript:void(0);",onClick:this.retry},(0,s._)("Try again"))):0===this.state.tasks.length&&(n=t.createElement("span",null)),t.createElement("div",{className:"task-list"},this.state.tasks.filter((function(t){return-1!==(null!==t.name?t.name:(0,s.interpolate)((0,s._)("Task #%(number)s"),{number:t.id})).toLocaleLowerCase().indexOf(e.state.filterText.toLocaleLowerCase())&&e.arrayContainsAll(t.tags,e.state.filterTags)})).map((function(n){return t.createElement(ao,{data:n,key:n.id,refreshInterval:3e3,onDelete:e.deleteTask,onMove:e.moveTask,onDuplicate:e.refresh,onEdited:e.taskEdited,onTagClicked:e.props.onTagClicked,hasPermission:e.props.hasPermission,history:e.props.history})})),n)}}])&&lo(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(t.Component);fo(yo,"propTypes",{history:g().object.isRequired,source:g().string.isRequired,onDelete:g().func,onTaskMoved:g().func,hasPermission:g().func.isRequired,onTagsChanged:g().func,onTagClicked:g().func});const go=yo;var vo=[{k:"NO",v:0,human:(0,s._)("No")},{k:"YES",v:1,human:(0,s._)("Yes")}],bo={all:function(){return vo.map((function(t){return t.v}))},fromString:function(t){var e=parseInt(t);return!isNaN(e)&&e>=0&&e<=1?e:0},toHuman:function(t){for(var e in vo)if(vo[e].v===t)return vo[e].human;throw new Error("Invalid value: "+t)}};vo.forEach((function(t){bo[t.k]=t.v}));const _o=bo;function wo(t){return wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wo(t)}function Eo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Oo(o.key),o)}}function ko(t,e,n){return e=xo(e),function(t,e){if(e&&("object"===wo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,So()?Reflect.construct(e,n||[],xo(t).constructor):e.apply(t,n))}function So(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(So=function(){return!!t})()}function xo(t){return xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},xo(t)}function Po(t,e){return Po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Po(t,e)}function To(t,e,n){return(e=Oo(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oo(t){var e=function(t,e){if("object"!=wo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=wo(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wo(e)?e:e+""}var Co=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),To(e=ko(this,n,[t]),"cancel",(function(t){e.state.inReview?e.setState({inReview:!1}):e.props.onCancel&&window.confirm((0,s._)("Are you sure you want to cancel?"))&&e.props.onCancel()})),e.state={editTaskFormLoaded:!1,resizeMode:null===wt.getItem("resize_mode")?_o.YES:_o.fromString(wt.getItem("resize_mode")),resizeSize:parseInt(wt.getItem("resize_size"))||2048,items:[],taskInfo:{},inReview:!1,loading:!1},e.save=e.save.bind(e),e.handleFormTaskLoaded=e.handleFormTaskLoaded.bind(e),e.getTaskInfo=e.getTaskInfo.bind(e),e.setResizeMode=e.setResizeMode.bind(e),e.handleResizeSizeChange=e.handleResizeSizeChange.bind(e),e.handleFormChanged=e.handleFormChanged.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Po(t,e)}(n,e),o=n,(r=[{key:"componentDidMount",value:function(){var t=this;yn.Dashboard.triggerAddNewTaskPanelItem({},(function(e){e&&t.setState(i()(t.state,{items:{$push:[e]}}))}))}},{key:"save",value:function(t){if(this.state.inReview){this.setState({inReview:!1,loading:!0}),t.preventDefault(),this.taskForm.saveLastPresetToStorage(),wt.setItem("resize_size",this.state.resizeSize),wt.setItem("resize_mode",this.state.resizeMode);var e=this.getTaskInfo();"auto"!=e.selectedNode.key?wt.setItem("last_processing_node",e.selectedNode.id):wt.setItem("last_processing_node",""),this.props.onSave&&this.props.onSave(e)}else this.setState({inReview:!0})}},{key:"getTaskInfo",value:function(){return Object.assign(this.taskForm.getTaskInfo(),{resizeSize:this.state.resizeSize,resizeMode:this.state.resizeMode})}},{key:"setResizeMode",value:function(t){var e=this;return function(n){e.setState({resizeMode:t}),setTimeout((function(){e.handleFormChanged()}),0)}}},{key:"handleResizeSizeChange",value:function(t){var e=this,n=parseInt(t.target.value.replace(/[^\d]*/g,""));isNaN(n)&&(n=""),this.setState({resizeSize:n}),setTimeout((function(){e.handleFormChanged()}),0)}},{key:"handleFormTaskLoaded",value:function(){this.setState({editTaskFormLoaded:!0})}},{key:"handleFormChanged",value:function(){this.setState({taskInfo:this.getTaskInfo()})}},{key:"render",value:function(){var e=this,n=!0;return this.taskForm&&!this.taskForm.checkFilesCount(this.props.filesCount)&&(n=!1),t.createElement("div",{className:"new-task-panel theme-background-highlight"},t.createElement("div",{className:"form-horizontal"},t.createElement("div",{className:this.state.inReview?"disabled":""},t.createElement("p",null,(0,s.interpolate)((0,s._)("%(count)s files selected. Please check these additional options:"),{count:this.props.filesCount})),n?"":t.createElement("div",{className:"alert alert-warning"},(0,s.interpolate)((0,s._)("Number of files selected exceeds the maximum of %(count)s allowed on this processing node."),{count:this.taskForm.selectedNodeMaxImages()}),t.createElement("button",{onClick:this.props.onCancel,type:"button",className:"btn btn-xs btn-primary redo"},t.createElement("span",null,t.createElement("i",{className:"glyphicon glyphicon-remove-circle"})," ",(0,s._)("Cancel")))),t.createElement(Wt,{selectedNode:wt.getItem("last_processing_node")||"auto",onFormLoaded:this.handleFormTaskLoaded,onFormChanged:this.handleFormChanged,inReview:this.state.inReview,suggestedTaskName:this.props.suggestedTaskName,ref:function(t){t&&(e.taskForm=t)}}),this.state.editTaskFormLoaded&&this.props.showResize?t.createElement("div",null,t.createElement("div",{className:"form-group"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Resize Images")),t.createElement("div",{className:"col-sm-10"},t.createElement("div",{className:"btn-group"},t.createElement("button",{type:"button",className:"btn btn-default dropdown-toggle","data-toggle":"dropdown"},_o.toHuman(this.state.resizeMode)," ",t.createElement("span",{className:"caret"})),t.createElement("ul",{className:"dropdown-menu"},_o.all().map((function(n){return t.createElement("li",{key:n},t.createElement("a",{href:"javascript:void(0);",onClick:e.setResizeMode(n)},t.createElement("i",{style:{opacity:e.state.resizeMode===n?1:0},className:"fa fa-check"})," ",_o.toHuman(n)))})))),t.createElement("div",{className:"resize-control "+(this.state.resizeMode===_o.NO?"hide":"")},t.createElement("input",{type:"number",step:"100",className:"form-control",onChange:this.handleResizeSizeChange,value:this.state.resizeSize}),t.createElement("span",null,(0,s._)("px"))))),this.state.items.map((function(n,o){return t.createElement("div",{key:o,className:"form-group"},t.createElement(n,{taskInfo:e.state.taskInfo,getFiles:e.props.getFiles,filesCount:e.props.filesCount}))}))):""),this.state.editTaskFormLoaded?t.createElement("div",{className:"form-group"},t.createElement("div",{className:"col-sm-offset-2 col-sm-10 text-right"},void 0!==this.props.onCancel&&t.createElement("button",{type:"submit",className:"btn btn-danger",onClick:this.cancel,style:{marginRight:4}},t.createElement("i",{className:"glyphicon glyphicon-remove-circle"})," ",(0,s._)("Cancel")),this.state.loading?t.createElement("button",{type:"submit",className:"btn btn-primary",disabled:!0},t.createElement("i",{className:"fa fa-circle-notch fa-spin fa-fw"}),(0,s._)("Loading")):t.createElement("button",{type:"submit",className:"btn btn-primary",onClick:this.save,disabled:this.props.filesCount<1||!n},t.createElement("i",{className:"glyphicon glyphicon-saved"})," ",this.state.inReview?(0,s._)("Start Processing"):(0,s._)("Review")))):""))}}])&&Eo(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);To(Co,"defaultProps",{filesCount:0,showResize:!1}),To(Co,"propTypes",{onSave:g().func.isRequired,onCancel:g().func,filesCount:g().number,showResize:g().bool,getFiles:g().func,suggestedTaskName:g().oneOfType([g().string,g().func])});const jo=Co;var Lo=n(42),Ao=n.n(Lo),No="X-CSRFToken",Io=function(t){var e=null;if(document.cookie&&""!==document.cookie)for(var n=document.cookie.split(";"),o=0;o<n.length;o++){var r=jQuery.trim(n[o]);if(r.substring(0,10)===t+"="){e=decodeURIComponent(r.substring(10));break}}return e}("csrftoken");o().ajaxSetup({beforeSend:function(t,e){var n;n=e.type,/^(GET|HEAD|OPTIONS|TRACE)$/.test(n)||this.crossDomain||t.setRequestHeader(No,Io)}});const Ro={header:No,token:Io};function Mo(t){return Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mo(t)}function zo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Zo(o.key),o)}}function Fo(t,e,n){return e=Do(e),function(t,e){if(e&&("object"===Mo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Bo()?Reflect.construct(e,n||[],Do(t).constructor):e.apply(t,n))}function Bo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Bo=function(){return!!t})()}function Do(t){return Do=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Do(t)}function Uo(t,e){return Uo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Uo(t,e)}function Zo(t){var e=function(t,e){if("object"!=Mo(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Mo(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Mo(e)?e:e+""}var qo,$o,Wo,Ho=function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Fo(this,n,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Uo(t,e)}(n,e),o=n,(r=[{key:"render",value:function(){var e=(void 0!==this.props.progress?this.props.progress:0).toFixed(2),n=void 0!==this.props.totalBytesSent&&void 0!==this.props.totalBytes?" "+(0,s.interpolate)((0,s._)("remaining to upload: %(bytes)s"),{bytes:j.A.bytesToSize(this.props.totalBytes-this.props.totalBytesSent)}):"",o=e<100?"active":"",r=o?(0,s.interpolate)((0,s._)("%(count)s files %(remaining)s"),{count:this.props.totalCount,remaining:n}):(0,s.interpolate)((0,s._)("%(count)s files uploaded successfully"),{count:this.props.totalCount});return t.createElement("div",{className:"upload-progress-bar"},t.createElement("div",{className:"progress"},t.createElement("div",{className:"progress-bar progress-bar-success progress-bar-striped "+o,style:{width:e+"%"}},e,"%")),t.createElement("div",{className:"text-left small upload-label"},r))}}])&&zo(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);qo=Ho,$o="propTypes",Wo={progress:g().number,totalBytesSent:g().number,totalBytes:g().number,totalCount:g().number},($o=Zo($o))in qo?Object.defineProperty(qo,$o,{value:Wo,enumerable:!0,configurable:!0,writable:!0}):qo[$o]=Wo;const Vo=Ho;function Go(t){return Go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Go(t)}function Yo(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,er(o.key),o)}}function Ko(t,e,n){return e=Jo(e),function(t,e){if(e&&("object"===Go(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qo()?Reflect.construct(e,n||[],Jo(t).constructor):e.apply(t,n))}function Qo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Qo=function(){return!!t})()}function Jo(t){return Jo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jo(t)}function Xo(t,e){return Xo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xo(t,e)}function tr(t,e,n){return(e=er(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function er(t){var e=function(t,e){if("object"!=Go(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Go(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Go(e)?e:e+""}var nr=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),tr(e=Ko(this,n,[t]),"defaultTaskName",(function(){return"Task of ".concat((new Date).toISOString())})),tr(e,"cancel",(function(t){e.cancelUpload(),e.props.onCancel()})),tr(e,"cancelUpload",(function(t){e.setState({uploading:!1}),setTimeout((function(){e.dz.removeAllFiles(!0)}),0)})),tr(e,"handleImportFromUrl",(function(){e.setState({typeUrl:!e.state.typeUrl})})),tr(e,"handleCancelImportFromURL",(function(){e.setState({typeUrl:!1})})),tr(e,"handleChangeImportUrl",(function(t){e.setState({importUrl:t.target.value})})),tr(e,"handleConfirmImportUrl",(function(){e.setState({importingFromUrl:!0}),$.post("/api/projects/".concat(e.props.projectId,"/tasks/import"),{url:e.state.importUrl,name:e.defaultTaskName()}).done((function(t){e.setState({importingFromUrl:!1}),t.id?e.props.onImported():e.setState({error:t.error||(0,s.interpolate)((0,s._)("Invalid JSON response: %(error)s"),{error:JSON.stringify(t)})})})).fail((function(){e.setState({importingFromUrl:!1,error:(0,s._)("Cannot import from URL. Check your internet connection.")})}))})),tr(e,"setRef",(function(t){return function(n){null!=n&&(e[t]=n)}})),e.state={error:"",typeUrl:!1,uploading:!1,importingFromUrl:!1,progress:0,bytesSent:0,importUrl:""},e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xo(t,e)}(n,e),o=n,(r=[{key:"componentDidMount",value:function(){var t=this;Ao().autoDiscover=!1,this.dropzone&&(this.dz=new(Ao())(this.dropzone,tr(tr({paramName:"file",url:"/api/projects/".concat(this.props.projectId,"/tasks/import"),parallelUploads:1,maxFilesize:2147483647,uploadMultiple:!1,acceptedFiles:"application/zip,application/octet-stream,application/x-zip-compressed,multipart/x-zip",autoProcessQueue:!0,createImageThumbnails:!1,previewTemplate:'<div style="display:none"></div>',clickable:this.uploadButton,chunkSize:2147483647,timeout:2147483647,chunking:!0},"chunkSize",16e6),"headers",tr({},Ro.header,Ro.token))),this.dz.on("error",(function(e){t.state.uploading&&t.setState({error:(0,s._)("Cannot upload file. Check your internet connection and try again.")})})).on("sending",(function(){t.setState({typeUrl:!1,uploading:!0,totalCount:1})})).on("reset",(function(){t.setState({uploading:!1,progress:0,totalBytes:0,totalBytesSent:0})})).on("uploadprogress",(function(e,n,o){100!=n&&t.setState({progress:n,totalBytes:e.size,totalBytesSent:o})})).on("sending",(function(e,n,o){o.has&&o.has("name")||o.append("name",t.defaultTaskName())})).on("complete",(function(e){if("success"===e.status){t.setState({uploading:!1});try{var n=JSON.parse(e.xhr.response);if(!n.id)throw new Error("Expected id field, but none given (".concat(n,")"));t.props.onImported()}catch(e){t.setState({error:(0,s.interpolate)((0,s._)("Invalid response from server: %(error)s"),{error:e.message})})}}else t.state.uploading&&t.setState({uploading:!1,error:(0,s._)("An error occured while uploading the file. Please try again.")})})))}},{key:"render",value:function(){return t.createElement("div",{ref:this.setRef("dropzone"),className:"import-task-panel theme-background-highlight"},t.createElement("div",{className:"form-horizontal"},t.createElement(C,{bind:[this,"error"]}),t.createElement("button",{type:"button",className:"close theme-color-primary",title:"Close",onClick:this.cancel},t.createElement("span",{"aria-hidden":"true"},"")),t.createElement("h4",null,(0,s._)("Import Existing Assets")),t.createElement("p",null,t.createElement(Yn,{params:{arrow:'<i class="glyphicon glyphicon-arrow-right"></i>'}},(0,s._)("You can import .zip files that have been exported from existing tasks via Download Assets %(arrow)s All Assets."))),t.createElement("button",{disabled:this.state.uploading,type:"button",className:"btn btn-primary",ref:this.setRef("uploadButton")},t.createElement("i",{className:"glyphicon glyphicon-upload"}),(0,s._)("Upload a File")),t.createElement("button",{disabled:this.state.uploading,type:"button",className:"btn btn-primary",onClick:this.handleImportFromUrl,ref:this.setRef("importFromUrlButton")},t.createElement("i",{className:"glyphicon glyphicon-cloud-download"}),(0,s._)("Import From URL")),this.state.typeUrl?t.createElement("div",{className:"form-inline"},t.createElement("div",{className:"form-group"},t.createElement("input",{disabled:this.state.importingFromUrl,onChange:this.handleChangeImportUrl,size:"45",type:"text",className:"form-control",placeholder:"http://",value:this.state.importUrl}),t.createElement("button",{onClick:this.handleConfirmImportUrl,disabled:this.state.importUrl.length<4||this.state.importingFromUrl,className:"btn-import btn btn-primary"},t.createElement("i",{className:"glyphicon glyphicon-cloud-download"})," ",(0,s._)("Import")))):"",this.state.uploading?t.createElement("div",null,t.createElement(Vo,this.state),t.createElement("button",{type:"button",className:"btn btn-danger btn-sm",onClick:this.cancelUpload},t.createElement("i",{className:"glyphicon glyphicon-remove-circle"}),(0,s._)("Cancel Upload"))):""))}}])&&Yo(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);tr(nr,"defaultProps",{}),tr(nr,"propTypes",{onImported:g().func.isRequired,onCancel:g().func,projectId:g().number.isRequired});const or=nr;function rr(t){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rr(t)}function ir(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,hr(o.key),o)}}function ar(t,e,n){return e=lr(e),function(t,e){if(e&&("object"===rr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,sr()?Reflect.construct(e,n||[],lr(t).constructor):e.apply(t,n))}function sr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(sr=function(){return!!t})()}function lr(t){return lr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lr(t)}function ur(t,e){return ur=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ur(t,e)}function cr(t,e,n){return(e=hr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hr(t){var e=function(t,e){if("object"!=rr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=rr(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rr(e)?e:e+""}var pr=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),cr(e=ar(this,n,[t]),"loadPermissions",(function(){e.setState({loading:!0,permissions:[]}),e.permsRequest=o().getJSON("/api/projects/".concat(e.props.projectId,"/permissions/"),(function(t){var n={};t.forEach((function(t){return n[t.username]=!0})),e.setState({validUsernames:n,permissions:t})})).fail((function(){e.setState({error:(0,s._)("Cannot load permissions.")})})).always((function(){e.setState({loading:!1})}))})),cr(e,"getPermissions",(function(){return e.state.permissions.forEach((function(t){return delete t.autocomplete})),e.state.permissions})),cr(e,"autocomplete",(function(t){if(e.validateReq&&(e.validateReq.abort(),e.validateReq=null),e.validateTimeout&&(clearTimeout(e.validateTimeout),e.validateTimeout=null),""===t.username)return delete t.autocomplete,void e.setState({permissions:e.state.permissions});e.setState({validatingUser:!0}),e.validateTimeout=setTimeout((function(){e.validateReq=o().getJSON("/api/users/?limit=30&search=".concat(encodeURIComponent(t.username))).done((function(n){n.forEach((function(t){e.state.validUsernames[t.username]=!0})),e.state.permissions.forEach((function(t){return delete t.autocomplete})),e.textFocused&&(t.autocomplete=n),e.setState({validUsernames:e.state.validUsernames,permissions:e.state.permissions})})).fail((function(t){"abort"!==t.statusText&&e.setState({validationUnavailable:!0})})).always((function(){e.setState({validatingUser:!1})}))}),300)})),cr(e,"handleChangePermissionRole",(function(t){return function(n){t.permissions=e.extendedPermissions(n.target.value),e.setState({permissions:e.state.permissions})}})),cr(e,"handleChangePermissionUser",(function(t){return function(n){t.username=n.target.value,e.autocomplete(t),e.setState({permissions:e.state.permissions})}})),cr(e,"simplifiedPermission",(function(t){return-1!==t.indexOf("change")?"rw":-1!==t.indexOf("view")?"r":""})),cr(e,"extendedPermissions",(function(t){return"rw"==t?["add","change","delete","view"]:"r"==t?["view"]:[]})),cr(e,"permissionLabel",(function(t){return"rw"===t?(0,s._)("Read/Write"):"r"===t?(0,s._)("Read"):""===t?(0,s._)("No Access"):void 0})),cr(e,"allPermissions",(function(){return["rw","r"].map((function(t){return{key:t,label:e.permissionLabel(t)}}))})),cr(e,"getColorFor",(function(t){return e.state.validationUnavailable||e.state.validatingUser||e.state.validUsernames[t]?"":e.backgroundFailedColor})),cr(e,"addNewPermission",(function(){e.setState(i()(e.state,{permissions:{$push:[{username:"",permissions:["view"]}]}})),setTimeout((function(){e.lastTextbox&&e.lastTextbox.focus()}),0)})),cr(e,"handleDeletePermission",(function(t){return function(){e.setState(i()(e.state,{permissions:function(e){return e.filter((function(e){return e!==t}))}}))}})),cr(e,"acOnMouseEnter",(function(t){t.target.style.backgroundColor=e.highlightColor})),cr(e,"acOnMouseLeave",(function(t){t.target.style.backgroundColor=""})),cr(e,"acOnClick",(function(t,n){return function(o){t.username=n.username,delete t.autocomplete,e.setState({permissions:e.state.permissions})}})),cr(e,"onFocus",(function(t){e.textFocused=!0})),cr(e,"onBlur",(function(t){return function(n){delete t.autocomplete,e.setState({permissions:e.state.permissions}),e.textFocused=!1}})),e.state={error:"",loading:!1,permissions:[],validUsernames:{},validatingUser:!1,validationUnavailable:!1},e.backgroundFailedColor=Bn("btn-danger","backgroundColor"),e.autocompleteBorderColor=Bn("btn-default","backgroundColor"),e.backgroundColor=Bn("theme-secondary","backgroundColor"),e.highlightColor=Bn("theme-background-highlight","backgroundColor"),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ur(t,e)}(n,e),r=n,(a=[{key:"componentDidMount",value:function(){this.props.lazyLoad||this.loadPermissions()}},{key:"componentWillUnmount",value:function(){this.permsRequest&&this.permsRequest.abort(),this.validateReq&&this.validateReq.abort(),this.validateTimeout&&clearTimeout(this.validateTimeout)}},{key:"render",value:function(){var e=this,n=this.state.permissions.map((function(n,o){return t.createElement("form",{autoComplete:"off",key:o},t.createElement("div",{className:"permission"},t.createElement("div",{className:"username-container"},t.createElement("i",{className:"fa fa-user user-indicator"}),t.createElement("input",{style:{color:e.getColorFor(n.username)},onChange:e.handleChangePermissionUser(n),type:"text",autoComplete:"off",onFocus:e.onFocus,onBlur:e.onBlur(n),disabled:n.owner,value:n.username,className:"form-control username",placeholder:(0,s._)("Username"),ref:function(t){return e.lastTextbox=t}}),n.autocomplete&&n.autocomplete.length>0?t.createElement("div",{className:"autocomplete",style:{borderColor:e.autocompleteBorderColor,backgroundColor:e.backgroundColor}},n.autocomplete.map((function(o){return t.createElement("div",{key:o.username,onMouseDown:e.acOnClick(n,o),className:"ac-entry",onMouseEnter:e.acOnMouseEnter,onMouseLeave:e.acOnMouseLeave,style:{borderColor:e.autocompleteBorderColor}},t.createElement("div",{className:"ac-user"},o.username),t.createElement("div",{className:"ac-email"},o.email))}))):""),t.createElement("div",{className:"remove"},n.owner?"":t.createElement("a",{onClick:e.handleDeletePermission(n)},t.createElement("i",{className:"fa fa-times"}))),t.createElement("div",{className:"role-container"},t.createElement("select",{disabled:n.owner,className:"form-control",value:e.simplifiedPermission(n.permissions),onChange:e.handleChangePermissionRole(n)},e.allPermissions().map((function(e){return t.createElement("option",{key:e.key,value:e.key},e.label)}))))))}));return t.createElement("div",{className:"edit-permissions-panel"},t.createElement("div",{className:"form-group"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Permissions")),t.createElement("div",{className:"col-sm-10"},t.createElement(C,{bind:[this,"error"]}),this.state.loading?t.createElement("i",{className:"fa fa-circle-notch fa-spin fa-fw perms-loading"}):[n,t.createElement("div",{key:"add-new"},t.createElement("button",{onClick:this.addNewPermission,className:"btn btn-default btn-sm add-new"},t.createElement("i",{className:"fa fa-user-plus"})))])))}}])&&ir(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a}(t.Component);cr(pr,"defaultProps",{projectId:-1,lazyLoad:!0}),cr(pr,"propTypes",{projectId:g().number.isRequired,lazyLoad:g().bool});const fr=pr;function dr(t){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dr(t)}function mr(){return mr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},mr.apply(this,arguments)}function yr(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Er(o.key),o)}}function gr(t,e,n){return e=br(e),function(t,e){if(e&&("object"===dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,vr()?Reflect.construct(e,n||[],br(t).constructor):e.apply(t,n))}function vr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(vr=function(){return!!t})()}function br(t){return br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},br(t)}function _r(t,e){return _r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_r(t,e)}function wr(t,e,n){return(e=Er(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Er(t){var e=function(t,e){if("object"!=dr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=dr(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==dr(e)?e:e+""}var kr=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),wr(e=gr(this,n,[t]),"handleDuplicate",(function(){e.setState({duplicating:!0}),e.duplicateRequest=$.post("/api/projects/".concat(e.props.projectId,"/duplicate/")).done((function(t){t.success?(e.hide(),e.props.onDuplicated(t.project)):e.setState({error:t.error||(0,s._)("Cannot complete operation.")})})).fail((function(){e.setState({error:(0,s._)("Cannot complete operation.")})})).always((function(){e.setState({duplicating:!1}),e.duplicateRequest=null}))})),wr(e,"toggleTagsField",(function(){e.state.showTagsField||setTimeout((function(){e.tagsField&&e.tagsField.focus()}),0),e.setState({showTagsField:!e.state.showTagsField})})),e.state={name:t.projectName,descr:null!==t.projectDescr?t.projectDescr:"",duplicating:!1,tags:t.projectTags,error:"",showTagsField:!!t.projectTags.length},e.reset=e.reset.bind(e),e.getFormData=e.getFormData.bind(e),e.onShow=e.onShow.bind(e),e.handleChange=e.handleChange.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_r(t,e)}(n,e),o=n,(r=[{key:"reset",value:function(){this.setState({name:this.props.projectName,descr:this.props.projectDescr,duplicating:!1,tags:this.props.projectTags,showTagsField:!!this.props.projectTags.length,error:""})}},{key:"getFormData",value:function(){var t={name:this.state.name,descr:this.state.descr,tags:this.state.tags};return this.editPermissionsPanel&&(t.permissions=this.editPermissionsPanel.getPermissions()),t}},{key:"onShow",value:function(){this.editPermissionsPanel&&this.editPermissionsPanel.loadPermissions(),this.nameInput.focus()}},{key:"show",value:function(){this.dialog.show()}},{key:"hide",value:function(){this.dialog.hide(),this.duplicateRequest&&(this.duplicateRequest.abort(),this.duplicateRequest=null)}},{key:"handleChange",value:function(t){var e=this;return function(n){var o={};o[t]=n.target.value,e.setState(o)}}},{key:"render",value:function(){var e=this,n="";return this.state.showTagsField&&(n=t.createElement("div",{className:"form-group"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Tags")),t.createElement("div",{className:"col-sm-10"},t.createElement(Nt,{onUpdate:function(t){return e.state.tags=t},tags:this.state.tags,ref:function(t){return e.tagsField=t}})))),t.createElement(D,mr({},this.props,{getFormData:this.getFormData,reset:this.reset,onShow:this.onShow,leftButtons:this.props.showDuplicate?[t.createElement("button",{key:"duplicate",disabled:this.duplicating,onClick:this.handleDuplicate,className:"btn btn-default"},t.createElement("i",{className:"fa "+(this.state.duplicating?"fa-circle-notch fa-spin fa-fw":"fa-copy")})," Duplicate")]:void 0,ref:function(t){e.dialog=t}}),t.createElement(C,{bind:[this,"error"]}),t.createElement("div",{className:"form-group edit-project-dialog"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Name")),t.createElement("div",{className:"col-sm-10 name-fields"},t.createElement("input",{type:"text",className:"form-control",ref:function(t){e.nameInput=t},value:this.state.name,onChange:this.handleChange("name"),onKeyPress:function(t){return e.dialog.handleEnter(t)}}),t.createElement("button",{type:"button",title:(0,s._)("Add tags"),onClick:this.toggleTagsField,className:"btn btn-sm btn-secondary toggle-tags"},t.createElement("i",{className:"fa fa-tag"})))),n,t.createElement("div",{className:"form-group"},t.createElement("label",{className:"col-sm-2 control-label"},(0,s._)("Description (optional)")),t.createElement("div",{className:"col-sm-10"},t.createElement("textarea",{className:"form-control",rows:"3",value:this.state.descr,onChange:this.handleChange("descr")}))),this.props.showPermissions?t.createElement(fr,{projectId:this.props.projectId,lazyLoad:!0,ref:function(t){e.editPermissionsPanel=t}}):"")}}])&&yr(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);wr(kr,"defaultProps",{projectName:"",projectDescr:"",projectId:-1,projectTags:[],title:(0,s._)("New Project"),saveLabel:(0,s._)("Create Project"),savingLabel:(0,s._)("Creating project..."),saveIcon:"glyphicon glyphicon-plus",deleteWarning:"",show:!1,showDuplicate:!1,showPermissions:!1,onDuplicated:function(){}}),wr(kr,"propTypes",{projectName:g().string,projectDescr:g().string,projectId:g().number,projectTags:g().array,saveAction:g().func.isRequired,onShow:g().func,deleteAction:g().func,title:g().string,saveLabel:g().string,savingLabel:g().string,saveIcon:g().string,deleteWarning:g().string,show:g().bool,showDuplicate:g().bool,showPermissions:g().bool,onDuplicated:g().func});const Sr=kr;function xr(t){return xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xr(t)}function Pr(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Ar(o.key),o)}}function Tr(t,e,n){return e=Cr(e),function(t,e){if(e&&("object"===xr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Or()?Reflect.construct(e,n||[],Cr(t).constructor):e.apply(t,n))}function Or(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Or=function(){return!!t})()}function Cr(t){return Cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Cr(t)}function jr(t,e){return jr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jr(t,e)}function Lr(t,e,n){return(e=Ar(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ar(t){var e=function(t,e){if("object"!=xr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=xr(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xr(e)?e:e+""}var Nr=function(e){function n(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),Lr(e=Tr(this,n,[t]),"handleClick",(function(t,n){return function(){e.state.items.forEach((function(e){e.selected=e.key===t&&n})),e.setState({items:e.state.items}),e.props.onChange("desc"===n?"-"+t:t)}})),e.state={items:t.items},t.selected){var o=t.selected.replace("-","");e.state.items.forEach((function(e){e.key===o&&(e.selected="-"===t.selected[0]?"desc":"asc")}))}return e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jr(t,e)}(n,e),o=n,(r=[{key:"render",value:function(){var e=this;return t.createElement("ul",{className:"dropdown-menu dropdown-menu-right sort-items"},t.createElement("li",{className:"sort-order-label"},(0,s._)("Descending")),this.state.items.map((function(n){return t.createElement("li",{key:n.key},t.createElement("a",{onClick:e.handleClick(n.key,"desc"),className:"sort-item"},n.label," ","desc"===n.selected?t.createElement("i",{className:"fa fa-check"}):""))})),t.createElement("li",{className:"sort-order-label"},(0,s._)("Ascending")),this.state.items.map((function(n){return t.createElement("li",{key:n.key},t.createElement("a",{onClick:e.handleClick(n.key,"asc"),className:"sort-item"},n.label," ","asc"===n.selected?t.createElement("i",{className:"fa fa-check"}):""))})))}}])&&Pr(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);Lr(Nr,"defaultProps",{items:[],onChange:function(){},selected:null}),Lr(Nr,"propTypes",{items:g().arrayOf(g().object),onChange:g().func,selected:g().string});const Ir=Nr;var Rr=n(3705),Mr=n.n(Rr);function zr(t){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zr(t)}function Fr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Br(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Wr(o.key),o)}}function Dr(t,e,n){return e=Zr(e),function(t,e){if(e&&("object"===zr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ur()?Reflect.construct(e,n||[],Zr(t).constructor):e.apply(t,n))}function Ur(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ur=function(){return!!t})()}function Zr(t){return Zr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zr(t)}function qr(t,e){return qr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qr(t,e)}function $r(t,e,n){return(e=Wr(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wr(t){var e=function(t,e){if("object"!=zr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=zr(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zr(e)?e:e+""}var Hr=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),$r(e=Dr(this,n,[t]),"newTaskAdded",(function(){e.setState({importing:!1}),e.state.showTaskList?e.taskList.refresh():e.setState({showTaskList:!0}),e.resetUploadState(),e.refresh()})),$r(e,"handleTaskCanceled",(function(){e.dz.removeAllFiles(!0),e.resetUploadState()})),$r(e,"handleUpload",(function(){e.state.upload.editing||e.handleTaskCanceled()})),$r(e,"handleHideProject",(function(t,n){return function(){window.confirm(t)&&(e.setState({error:"",refreshing:!0}),n().fail((function(t){e.setState({error:t.message||(t.responseJSON||{}).detail||t.responseText||(0,s._)("Could not delete item")})})).always((function(){e.setState({refreshing:!1})})))}})),$r(e,"handleImportTask",(function(){e.setState({importing:!0})})),$r(e,"handleCancelImportTask",(function(){e.setState({importing:!1})})),$r(e,"handleTaskTitleHint",(function(){return new Promise((function(t,n){if(e.state.upload.files.length>0){for(var r=null,i=0;i<e.state.upload.files.length;i++)if(0===e.state.upload.files[i].type.indexOf("image")){r=e.state.upload.files[i];break}if(!r)return void n();Mr().parse(r,{ifd0:!1,exif:[36867],gps:[1,2,3,4],interop:!1,ifd1:!1}).then((function(e){if(e.latitude&&e.longitude){var i=e[36867],a=i.split(" ");if(2==a.length){var s=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i,a,s=[],l=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=i.call(n)).done)&&(s.push(o.value),s.length!==e);l=!0);}catch(t){u=!0,r=t}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Fr(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(a,2),l=s[0],u=s[1];l=l.replace(/:/g,"-");var c=Date.parse("".concat(l," ").concat(u));isNaN(c)||(i=new Date(c).toLocaleDateString())}i||(i=r.lastModifiedDate.toLocaleDateString()),o().ajax({url:"https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=".concat(e.latitude,"&lon=").concat(e.longitude),contentType:"application/json",type:"GET"}).done((function(e){e.name?t("".concat(e.name," - ").concat(i)):e.address&&e.address.road?t("".concat(e.address.road," - ").concat(i)):n(new Error("Invalid json"))})).fail(n)}else n()})).catch(n)}}))})),$r(e,"sortChanged",(function(t){e.taskList&&(e.setState({sortKey:t}),setTimeout((function(){e.taskList.refresh()}),0))})),$r(e,"handleTagClick",(function(t){return function(e){var n=new CustomEvent("onProjectListTagClicked",{detail:t});document.dispatchEvent(n)}})),$r(e,"tagsChanged",(function(t){e.setState({filterTags:t,selectedTags:[]})})),$r(e,"handleFilterTextChange",(function(t){e.setState({filterText:t.target.value})})),$r(e,"toggleTag",(function(t){return function(){-1===e.state.selectedTags.indexOf(t)?e.setState(i()(e.state,{selectedTags:{$push:[t]}})):e.setState({selectedTags:e.state.selectedTags.filter((function(e){return e!==t}))})}})),$r(e,"selectTag",(function(t){-1===e.state.selectedTags.indexOf(t)&&e.setState(i()(e.state,{selectedTags:{$push:[t]}}))})),$r(e,"clearFilter",(function(){e.setState({filterText:"",selectedTags:[]})})),$r(e,"onOpenFilter",(function(){0===e.state.filterTags.length&&setTimeout((function(){e.filterTextInput.focus()}),0)})),e.historyNav=new Qe(t.history),e.state={showTaskList:e.historyNav.isValueInQSList("project_task_open",t.data.id),upload:e.getDefaultUploadState(),error:"",data:t.data,refreshing:!1,importing:!1,buttons:[],sortKey:"-created_at",filterTags:[],selectedTags:[],filterText:""},e.sortItems=[{key:"created_at",label:(0,s._)("Created on")},{key:"name",label:(0,s._)("Name")},{key:"tags",label:(0,s._)("Tags")}],e.toggleTaskList=e.toggleTaskList.bind(e),e.closeUploadError=e.closeUploadError.bind(e),e.cancelUpload=e.cancelUpload.bind(e),e.handleCancel=e.handleCancel.bind(e),e.handleTaskSaved=e.handleTaskSaved.bind(e),e.viewMap=e.viewMap.bind(e),e.handleDelete=e.handleDelete.bind(e),e.handleEditProject=e.handleEditProject.bind(e),e.updateProject=e.updateProject.bind(e),e.taskDeleted=e.taskDeleted.bind(e),e.taskMoved=e.taskMoved.bind(e),e.hasPermission=e.hasPermission.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qr(t,e)}(n,e),r=n,(a=[{key:"refresh",value:function(){var t=this;this.setState({refreshing:!0}),this.refreshRequest=o().getJSON("/api/projects/".concat(this.state.data.id,"/")).done((function(e){t.setState({data:e})})).fail((function(e,n,o){t.setState({error:o.message})})).always((function(){t.setState({refreshing:!1})}))}},{key:"componentWillUnmount",value:function(){this.deleteProjectRequest&&this.deleteProjectRequest.abort(),this.refreshRequest&&this.refreshRequest.abort()}},{key:"componentDidUpdate",value:function(t,e){e.filterText===this.state.filterText&&e.selectedTags.length===this.state.selectedTags.length||this.taskList&&this.taskList.applyFilter(this.state.filterText,this.state.selectedTags)}},{key:"getDefaultUploadState",value:function(){return{uploading:!1,editing:!1,error:"",progress:0,files:[],totalCount:0,uploadedCount:0,totalBytes:0,totalBytesSent:0,lastUpdated:0}}},{key:"resetUploadState",value:function(){this.setUploadState(this.getDefaultUploadState())}},{key:"setUploadState",value:function(t){this.setState(i()(this.state,{upload:{$merge:t}}))}},{key:"hasPermission",value:function(t){return-1!==this.state.data.permissions.indexOf(t)}},{key:"componentDidMount",value:function(){var t=this;Ao().autoDiscover=!1,this.hasPermission("add")&&(this.dz=new(Ao())(this.dropzone,{paramName:"images",url:"TO_BE_CHANGED",parallelUploads:6,uploadMultiple:!1,acceptedFiles:"image/*,text/*,.las,.laz,video/*,.srt",autoProcessQueue:!1,createImageThumbnails:!1,clickable:this.uploadButton,maxFilesize:131072,chunkSize:2147483647,timeout:2147483647,headers:$r({},Ro.header,Ro.token)}),this.dz.on("addedfiles",(function(e){for(var n=0,o=0;o<e.length;o++)n+=e[o].size,e[o].deltaBytesSent=0,e[o].trackedBytesSent=0,e[o].retries=0;t.setUploadState({editing:!0,totalCount:t.state.upload.totalCount+e.length,files:e,totalBytes:t.state.upload.totalBytes+n})})).on("uploadprogress",(function(e,n,o){var r=(new Date).getTime();if(o>e.size&&(o=e.size),100===n||r-t.state.upload.lastUpdated>500){var i=o-e.deltaBytesSent;e.trackedBytesSent+=i;var a=t.state.upload.totalBytesSent+i,s=a/t.state.upload.totalBytes*100;t.setUploadState({progress:s,totalBytesSent:a,lastUpdated:r}),e.deltaBytesSent=o}})).on("complete",(function(e){var n=function(){if(!(e.retries<10))throw new Error((0,s.interpolate)((0,s._)("Cannot upload %(filename)s, exceeded max retries (%(max_retries)s)"),{filename:e.name,max_retries:10}));var n=t.state.upload.totalBytesSent-e.trackedBytesSent,o=n/t.state.upload.totalBytes*100;t.setUploadState({progress:o,totalBytesSent:n}),e.status=Ao().QUEUED,e.deltaBytesSent=0,e.trackedBytesSent=0,e.retries++,setTimeout((function(){t.dz.processQueue()}),5e3*e.retries)};try{if("error"===e.status){if(e.size/1024>t.dz.options.maxFilesize)throw t.setUploadState({totalCount:t.state.upload.totalCount-1,totalBytes:t.state.upload.totalBytes-e.size}),new Error((0,s.interpolate)((0,s._)("Cannot upload %(filename)s, File too Large! Default MaxFileSize is %(maxFileSize)s MB!"),{filename:e.name,maxFileSize:t.dz.options.maxFilesize}));n()}else if(JSON.parse(e.xhr.response).success){var o=t.state.upload.totalBytesSent+e.size;e.trackedBytesSent&&(o-=e.trackedBytesSent);var r=o/t.state.upload.totalBytes*100;t.setUploadState({progress:r,totalBytesSent:o,uploadedCount:t.state.upload.uploadedCount+1}),t.dz.processQueue()}else n()}catch(e){t.manuallyCanceled?t.setUploadState({uploading:!1}):t.setUploadState({error:"".concat(e.message),uploading:!1}),t.dz.files.length&&t.dz.cancelUpload()}})).on("queuecomplete",(function(){var e=t.state.upload.totalCount-t.state.upload.uploadedCount;0===e&&t.state.upload.uploadedCount>0?(t.setUploadState({uploading:!1}),o().ajax({url:"/api/projects/".concat(t.state.data.id,"/tasks/").concat(t.dz._taskInfo.id,"/commit/"),contentType:"application/json",dataType:"json",type:"POST"}).done((function(e){e&&e.id?t.newTaskAdded():t.setUploadState({error:(0,s.interpolate)((0,s._)("Cannot create new task. Invalid response from server: %(error)s"),{error:JSON.stringify(e)})})})).fail((function(){t.setUploadState({error:(0,s._)("Cannot create new task. Please try again later.")})}))):0===t.dz.getQueuedFiles()&&t.setUploadState({totalCount:t.state.upload.totalCount-e,uploading:!1,error:(0,s.interpolate)((0,s._)("%(count)s files cannot be uploaded. As a reminder, only images (.jpg, .tif, .png) and GCP files (.txt) can be uploaded. Try again."),{count:e})})})).on("reset",(function(){t.resetUploadState()})).on("dragenter",(function(){t.state.upload.editing||t.resetUploadState()}))),PluginsAPI.Dashboard.triggerAddNewTaskButton({projectId:this.state.data.id,onNewTaskAdded:this.newTaskAdded},(function(e){e&&t.setState(i()(t.state,{buttons:{$push:[e]}}))}))}},{key:"setRef",value:function(t){var e=this;return function(n){null!=n&&(e[t]=n)}}},{key:"toggleTaskList",value:function(){var t=!this.state.showTaskList;this.historyNav.toggleQSListItem("project_task_open",this.state.data.id,t),this.setState({showTaskList:t})}},{key:"closeUploadError",value:function(){this.setUploadState({error:""})}},{key:"cancelUpload",value:function(){this.dz.removeAllFiles(!0)}},{key:"handleCancel",value:function(){var t=this;this.manuallyCanceled=!0,this.cancelUpload(),this.dz._taskInfo&&void 0!==this.dz._taskInfo.id&&o().ajax({url:"/api/projects/".concat(this.state.data.id,"/tasks/").concat(this.dz._taskInfo.id,"/remove/"),contentType:"application/json",dataType:"json",type:"POST"}),setTimeout((function(){t.manuallyCanceled=!1}),500)}},{key:"taskDeleted",value:function(){this.refresh()}},{key:"taskMoved",value:function(t){this.refresh(),this.props.onTaskMoved&&this.props.onTaskMoved(t)}},{key:"handleDelete",value:function(){var t=this;return o().ajax({url:"/api/projects/".concat(this.state.data.id,"/"),type:"DELETE"}).done((function(){t.props.onDelete&&t.props.onDelete(t.state.data.id)}))}},{key:"handleTaskSaved",value:function(t){var e=this;this.dz._taskInfo=t,this.setUploadState({uploading:!0,editing:!1});var n={name:t.name,options:t.options,processing_node:t.selectedNode.id,auto_processing_node:"auto"==t.selectedNode.key,partial:!0};t.resizeMode===_o.YES&&(n.resize_to=t.resizeSize),o().ajax({url:"/api/projects/".concat(this.state.data.id,"/tasks/"),contentType:"application/json",data:JSON.stringify(n),dataType:"json",type:"POST"}).done((function(t){t&&t.id?(e.dz._taskInfo.id=t.id,e.dz.options.url="/api/projects/".concat(e.state.data.id,"/tasks/").concat(t.id,"/upload/"),e.dz.processQueue()):(e.setState({error:(0,s.interpolate)((0,s._)("Cannot create new task. Invalid response from server: %(error)s"),{error:JSON.stringify(t)})}),e.handleTaskCanceled())})).fail((function(){e.setState({error:(0,s._)("Cannot create new task. Please try again later.")}),e.handleTaskCanceled()}))}},{key:"handleEditProject",value:function(){this.editProjectDialog.show()}},{key:"updateProject",value:function(t){var e=this;return o().ajax({url:"/api/projects/".concat(this.state.data.id,"/edit/"),contentType:"application/json",data:JSON.stringify({name:t.name,description:t.descr,tags:t.tags,permissions:t.permissions}),dataType:"json",type:"POST"}).done((function(){e.refresh()}))}},{key:"viewMap",value:function(){location.href="/map/project/".concat(this.state.data.id,"/")}},{key:"render",value:function(){var e=this,n=this.state,o=n.refreshing,r=n.data,i=n.filterTags,a=r.tasks.length,l=this.hasPermission("change"),u=Et(r.tags),c=(0,s._)("All tasks, images and models associated with this project will be permanently deleted. Are you sure you want to continue?");return r.owned||(c=(0,s._)("This project was shared with you. It will not be deleted, but simply hidden from your dashboard. Continue?")),t.createElement("li",{className:"project-list-item list-group-item "+(o?"refreshing":""),href:"javascript:void(0);",ref:this.setRef("dropzone")},l?t.createElement(Sr,{ref:function(t){e.editProjectDialog=t},title:(0,s._)("Edit Project"),saveLabel:(0,s._)("Save Changes"),savingLabel:(0,s._)("Saving changes..."),saveIcon:"far fa-edit",showDuplicate:!0,onDuplicated:this.props.onProjectDuplicated,projectName:r.name,projectDescr:r.description,projectId:r.id,projectTags:r.tags,deleteWarning:c,saveAction:this.updateProject,showPermissions:this.hasPermission("change"),deleteAction:this.hasPermission("delete")?this.handleDelete:void 0}):"",t.createElement("div",{className:"row no-margin"},t.createElement(C,{bind:[this,"error"]}),t.createElement("div",{className:"btn-group project-buttons"},this.hasPermission("add")?t.createElement("div",{className:"asset-download-buttons btn-group "+(this.state.upload.uploading?"hide":"")},t.createElement("button",{type:"button",className:"btn btn-primary btn-sm",onClick:this.handleUpload,ref:this.setRef("uploadButton")},t.createElement("i",{className:"glyphicon glyphicon-upload"}),(0,s._)("Select Images and GCP")),t.createElement("button",{type:"button",className:"btn btn-default btn-sm",onClick:this.handleImportTask},t.createElement("i",{className:"glyphicon glyphicon-import"})," ",(0,s._)("Import")),this.state.buttons.map((function(e,n){return t.createElement(t.Fragment,{key:n},e)}))):"",t.createElement("button",{disabled:""!==this.state.upload.error,type:"button",className:"btn btn-danger btn-sm "+(this.state.upload.uploading?"":"hide"),onClick:this.handleCancel},t.createElement("i",{className:"glyphicon glyphicon-remove-circle"}),"Cancel Upload")),t.createElement("div",{className:"project-name"},r.name,u.length>0?u.map((function(n,o){return t.createElement("div",{key:o,className:"tag-badge small-badge",onClick:e.handleTagClick(n)},n)})):""),t.createElement("div",{className:"project-description"},r.description),t.createElement("div",{className:"row project-links"},a>0?t.createElement("span",null,t.createElement("i",{className:"fa fa-tasks"}),t.createElement("a",{href:"javascript:void(0);",onClick:this.toggleTaskList},(0,s.interpolate)((0,s._)("%(count)s Tasks"),{count:a})," ",t.createElement("i",{className:"fa fa-caret-"+(this.state.showTaskList?"down":"right")}))):"",this.state.showTaskList&&a>1?t.createElement("div",{className:"task-filters"},t.createElement("div",{className:"btn-group"},this.state.selectedTags.length||""!==this.state.filterText?t.createElement("a",{className:"quick-clear-filter",href:"javascript:void(0)",onClick:this.clearFilter},""):"",t.createElement("i",{className:"fa fa-filter"}),t.createElement("a",{href:"javascript:void(0);",onClick:this.onOpenFilter,className:"dropdown-toggle","data-toggle-outside":!0,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},(0,s._)("Filter")),t.createElement("ul",{className:"dropdown-menu dropdown-menu-right filter-dropdown"},t.createElement("li",{className:"filter-text-container"},t.createElement("input",{type:"text",className:"form-control filter-text theme-border-secondary-07",value:this.state.filterText,ref:function(t){e.filterTextInput=t},placeholder:"",spellCheck:"false",autoComplete:"false",onChange:this.handleFilterTextChange})),i.map((function(n){return t.createElement("li",{key:n,className:"tag-selection"},t.createElement("input",{type:"checkbox",className:"filter-checkbox",id:"filter-tag-"+r.id+"-"+n,checked:-1!==e.state.selectedTags.indexOf(n),onChange:e.toggleTag(n)})," ",t.createElement("label",{className:"filter-checkbox-label",htmlFor:"filter-tag-"+r.id+"-"+n},n))})),t.createElement("li",{className:"clear-container"},t.createElement("input",{type:"button",onClick:this.clearFilter,className:"btn btn-default btn-xs",value:(0,s._)("Clear")})))),t.createElement("div",{className:"btn-group"},t.createElement("i",{className:"fa fa-sort-alpha-down"}),t.createElement("a",{href:"javascript:void(0);",className:"dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},(0,s._)("Sort")),t.createElement(Ir,{selected:"-created_at",items:this.sortItems,onChange:this.sortChanged}))):"",a>0?[t.createElement("i",{key:"edit-icon",className:"fa fa-globe"}),t.createElement("a",{key:"edit-text",href:"javascript:void(0);",onClick:this.viewMap},(0,s._)("View Map"))]:"",l?[t.createElement("i",{key:"edit-icon",className:"far fa-edit"}),t.createElement("a",{key:"edit-text",href:"javascript:void(0);",onClick:this.handleEditProject}," ",(0,s._)("Edit"))]:"",l||r.owned?"":[t.createElement("i",{key:"edit-icon",className:"far fa-eye-slash"}),t.createElement("a",{key:"edit-text",href:"javascript:void(0);",onClick:this.handleHideProject(c,this.handleDelete)}," ",(0,s._)("Delete"))])),t.createElement("i",{className:"drag-drop-icon fa fa-inbox"}),t.createElement("div",{className:"row"},this.state.upload.uploading?t.createElement(Vo,this.state.upload):"",""!==this.state.upload.error?t.createElement("div",{className:"alert alert-warning alert-dismissible"},t.createElement("button",{type:"button",className:"close",title:(0,s._)("Close"),onClick:this.closeUploadError},t.createElement("span",{"aria-hidden":"true"},"")),this.state.upload.error):"",this.state.upload.editing?t.createElement(jo,{onSave:this.handleTaskSaved,onCancel:this.handleTaskCanceled,suggestedTaskName:this.handleTaskTitleHint,filesCount:this.state.upload.totalCount,showResize:!0,getFiles:function(){return e.state.upload.files}}):"",this.state.importing?t.createElement(or,{onImported:this.newTaskAdded,onCancel:this.handleCancelImportTask,projectId:this.state.data.id}):"",this.state.showTaskList?t.createElement(go,{ref:this.setRef("taskList"),source:"/api/projects/".concat(r.id,"/tasks/?ordering=").concat(this.state.sortKey),onDelete:this.taskDeleted,onTaskMoved:this.taskMoved,hasPermission:this.hasPermission,onTagsChanged:this.tagsChanged,onTagClicked:this.selectTag,history:this.props.history}):""))}}])&&Br(r.prototype,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,a}(t.Component);$r(Hr,"propTypes",{history:g().object.isRequired,data:g().object.isRequired,onDelete:g().func,onTaskMoved:g().func,onProjectDuplicated:g().func});const Vr=Hr;function Gr(t){return Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gr(t)}function Yr(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,ei(o.key),o)}}function Kr(t,e,n){return e=Jr(e),function(t,e){if(e&&("object"===Gr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Qr()?Reflect.construct(e,n||[],Jr(t).constructor):e.apply(t,n))}function Qr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Qr=function(){return!!t})()}function Jr(t){return Jr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jr(t)}function Xr(t,e){return Xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xr(t,e)}function ti(t,e,n){return(e=ei(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ei(t){var e=function(t,e){if("object"!=Gr(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Gr(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gr(e)?e:e+""}var ni=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=Kr(this,e,[t])).historyNav=new Qe(t.history),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xr(t,e)}(e,t),n=e,(o=[{key:"updatePagination",value:function(t,e){var n=this.props.currentPage,o=this.totalPages(t,e);n>o&&(n=o),this.setState({pagination:{switchingPages:!1,itemsPerPage:t,totalItems:e}})}},{key:"totalPages",value:function(t,e){var n=Math.ceil(e/t);return n<1&&(n=1),n}},{key:"setPaginationState",value:function(t,e){this.setState(i()(this.state,{pagination:{$merge:t}}),e)}},{key:"handlePageItemsNumChange",value:function(t,e){var n=this.props.currentPage,o=this.totalPages(this.state.pagination.itemsPerPage,this.state.pagination.totalItems),r=this.totalPages(this.state.pagination.itemsPerPage,this.state.pagination.totalItems+t);n>r&&(n=r),this.historyNav.changeQS("page",n),this.setPaginationState({totalItems:this.state.pagination.totalItems+t},(function(){o!==r&&e(r)}))}},{key:"render",value:function(){throw new Error("Override me")}}])&&Yr(n.prototype,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,o}(t.Component);ti(ni,"defaultProps",{currentPage:1}),ti(ni,"propTypes",{history:g().object.isRequired,currentPage:g().number});const oi=ni;var ri=n(311),ii=n.n(ri);function ai(){return ai=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},ai.apply(this,arguments)}function si(t){return"/"===t.charAt(0)}function li(t,e){for(var n=e,o=n+1,r=t.length;o<r;n+=1,o+=1)t[n]=t[o];t.pop()}const ui=function(t,e){void 0===e&&(e="");var n,o=t&&t.split("/")||[],r=e&&e.split("/")||[],i=t&&si(t),a=e&&si(e),s=i||a;if(t&&si(t)?r=o:o.length&&(r.pop(),r=r.concat(o)),!r.length)return"/";if(r.length){var l=r[r.length-1];n="."===l||".."===l||""===l}else n=!1;for(var u=0,c=r.length;c>=0;c--){var h=r[c];"."===h?li(r,c):".."===h?(li(r,c),u++):u&&(li(r,c),u--)}if(!s)for(;u--;u)r.unshift("..");!s||""===r[0]||r[0]&&si(r[0])||r.unshift("");var p=r.join("/");return n&&"/"!==p.substr(-1)&&(p+="/"),p};var ci="Invariant failed";function hi(t,e,n,o){var r;"string"==typeof t?(r=function(t){var e=t||"/",n="",o="",r=e.indexOf("#");-1!==r&&(o=e.substr(r),e=e.substr(0,r));var i=e.indexOf("?");return-1!==i&&(n=e.substr(i),e=e.substr(0,i)),{pathname:e,search:"?"===n?"":n,hash:"#"===o?"":o}}(t),r.state=e):(void 0===(r=ai({},t)).pathname&&(r.pathname=""),r.search?"?"!==r.search.charAt(0)&&(r.search="?"+r.search):r.search="",r.hash?"#"!==r.hash.charAt(0)&&(r.hash="#"+r.hash):r.hash="",void 0!==e&&void 0===r.state&&(r.state=e));try{r.pathname=decodeURI(r.pathname)}catch(t){throw t instanceof URIError?new URIError('Pathname "'+r.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):t}return n&&(r.key=n),o?r.pathname?"/"!==r.pathname.charAt(0)&&(r.pathname=ui(r.pathname,o.pathname)):r.pathname=o.pathname:r.pathname||(r.pathname="/"),r}var pi=!("undefined"==typeof window||!window.document||!window.document.createElement);function fi(t,e){e(window.confirm(t))}var di="popstate",mi="hashchange";function yi(){try{return window.history.state||{}}catch(t){return{}}}function gi(t){void 0===t&&(t={}),pi||function(t,e){throw new Error(ci)}();var e,n,o=window.history,r=(-1===(e=window.navigator.userAgent).indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history,i=!(-1===window.navigator.userAgent.indexOf("Trident")),a=t,s=a.forceRefresh,l=void 0!==s&&s,u=a.getUserConfirmation,c=void 0===u?fi:u,h=a.keyLength,p=void 0===h?6:h,f=t.basename?function(t){return"/"===t.charAt(t.length-1)?t.slice(0,-1):t}("/"===(n=t.basename).charAt(0)?n:"/"+n):"";function d(t){var e=t||{},n=e.key,o=e.state,r=window.location,i=r.pathname+r.search+r.hash;return f&&(i=function(t,e){return function(t,e){return 0===t.toLowerCase().indexOf(e.toLowerCase())&&-1!=="/?#".indexOf(t.charAt(e.length))}(t,e)?t.substr(e.length):t}(i,f)),hi(i,o,n)}function m(){return Math.random().toString(36).substr(2,p)}var y,g,v=(y=null,g=[],{setPrompt:function(t){return y=t,function(){y===t&&(y=null)}},confirmTransitionTo:function(t,e,n,o){if(null!=y){var r="function"==typeof y?y(t,e):y;"string"==typeof r?"function"==typeof n?n(r,o):o(!0):o(!1!==r)}else o(!0)},appendListener:function(t){var e=!0;function n(){e&&t.apply(void 0,arguments)}return g.push(n),function(){e=!1,g=g.filter((function(t){return t!==n}))}},notifyListeners:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];g.forEach((function(t){return t.apply(void 0,e)}))}});function b(t){ai(L,t),L.length=o.length,v.notifyListeners(L.location,L.action)}function _(t){(function(t){return void 0===t.state&&-1===navigator.userAgent.indexOf("CriOS")})(t)||k(d(t.state))}function w(){k(d(yi()))}var E=!1;function k(t){E?(E=!1,b()):v.confirmTransitionTo(t,"POP",c,(function(e){e?b({action:"POP",location:t}):function(t){var e=L.location,n=x.indexOf(e.key);-1===n&&(n=0);var o=x.indexOf(t.key);-1===o&&(o=0);var r=n-o;r&&(E=!0,T(r))}(t)}))}var S=d(yi()),x=[S.key];function P(t){return f+function(t){var e=t.pathname,n=t.search,o=t.hash,r=e||"/";return n&&"?"!==n&&(r+="?"===n.charAt(0)?n:"?"+n),o&&"#"!==o&&(r+="#"===o.charAt(0)?o:"#"+o),r}(t)}function T(t){o.go(t)}var O=0;function C(t){1===(O+=t)&&1===t?(window.addEventListener(di,_),i&&window.addEventListener(mi,w)):0===O&&(window.removeEventListener(di,_),i&&window.removeEventListener(mi,w))}var j=!1,L={length:o.length,action:"POP",location:S,createHref:P,push:function(t,e){var n="PUSH",i=hi(t,e,m(),L.location);v.confirmTransitionTo(i,n,c,(function(t){if(t){var e=P(i),a=i.key,s=i.state;if(r)if(o.pushState({key:a,state:s},null,e),l)window.location.href=e;else{var u=x.indexOf(L.location.key),c=x.slice(0,u+1);c.push(i.key),x=c,b({action:n,location:i})}else window.location.href=e}}))},replace:function(t,e){var n="REPLACE",i=hi(t,e,m(),L.location);v.confirmTransitionTo(i,n,c,(function(t){if(t){var e=P(i),a=i.key,s=i.state;if(r)if(o.replaceState({key:a,state:s},null,e),l)window.location.replace(e);else{var u=x.indexOf(L.location.key);-1!==u&&(x[u]=i.key),b({action:n,location:i})}else window.location.replace(e)}}))},go:T,goBack:function(){T(-1)},goForward:function(){T(1)},block:function(t){void 0===t&&(t=!1);var e=v.setPrompt(t);return j||(C(1),j=!0),function(){return j&&(j=!1,C(-1)),e()}},listen:function(t){var e=v.appendListener(t);return C(1),function(){C(-1),e()}}};return L}var vi=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function bi(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var _i=function(e){function n(){var t,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=o=bi(this,e.call.apply(e,[this].concat(i))),o.handleClick=function(t){if(o.props.onClick&&o.props.onClick(t),!t.defaultPrevented&&0===t.button&&!o.props.target&&!function(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}(t)){t.preventDefault();var e=o.context.router.history,n=o.props,r=n.replace,i=n.to;r?e.replace(i):e.push(i)}},bi(o,t)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),n.prototype.render=function(){var e=this.props,n=(e.replace,e.to),o=e.innerRef,r=function(t,e){var n={};for(var o in t)e.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}(e,["replace","to","innerRef"]);ii()(this.context.router,"You should not use <Link> outside a <Router>"),ii()(void 0!==n,'You must specify the "to" property');var i=this.context.router.history,a="string"==typeof n?hi(n,null,null,i.location):n,s=i.createHref(a);return t.createElement("a",vi({},r,{onClick:this.handleClick,href:s,ref:o}))},n}(t.Component);_i.propTypes={onClick:g().func,target:g().string,replace:g().bool,to:g().oneOfType([g().string,g().object]).isRequired,innerRef:g().oneOfType([g().string,g().func])},_i.defaultProps={replace:!1},_i.contextTypes={router:g().shape({history:g().shape({push:g().func.isRequired,replace:g().func.isRequired,createHref:g().func.isRequired}).isRequired}).isRequired};const wi=_i;var Ei=n(4146),ki=n.n(Ei),Si=n(9771),xi=n.n(Si),Pi=n(5302),Ti=n.n(Pi),Oi={},Ci=0;var ji=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function Li(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var Ai=function(e){return 0===t.Children.count(e)},Ni=function(e){function n(){var t,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=o=Li(this,e.call.apply(e,[this].concat(i))),o.state={match:o.computeMatch(o.props,o.context.router)},Li(o,t)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),n.prototype.getChildContext=function(){return{router:ji({},this.context.router,{route:{location:this.props.location||this.context.router.route.location,match:this.state.match}})}},n.prototype.computeMatch=function(t,e){var n=t.computedMatch,o=t.location,r=t.path,i=t.strict,a=t.exact,s=t.sensitive;if(n)return n;ii()(e,"You should not use <Route> or withRouter() outside a <Router>");var l=e.route;return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];"string"==typeof e&&(e={path:e});var o=e,r=o.path,i=o.exact,a=void 0!==i&&i,s=o.strict,l=void 0!==s&&s,u=o.sensitive;if(null==r)return n;var c=function(t,e){var n=""+e.end+e.strict+e.sensitive,o=Oi[n]||(Oi[n]={});if(o[t])return o[t];var r=[],i={re:Ti()(t,r,e),keys:r};return Ci<1e4&&(o[t]=i,Ci++),i}(r,{end:a,strict:l,sensitive:void 0!==u&&u}),h=c.re,p=c.keys,f=h.exec(t);if(!f)return null;var d=f[0],m=f.slice(1),y=t===d;return a&&!y?null:{path:r,url:"/"===r&&""===d?"/":d,isExact:y,params:p.reduce((function(t,e,n){return t[e.name]=m[n],t}),{})}}((o||l.location).pathname,{path:r,strict:i,exact:a,sensitive:s},l.match)},n.prototype.componentWillMount=function(){xi()(!(this.props.component&&this.props.render),"You should not use <Route component> and <Route render> in the same route; <Route render> will be ignored"),xi()(!(this.props.component&&this.props.children&&!Ai(this.props.children)),"You should not use <Route component> and <Route children> in the same route; <Route children> will be ignored"),xi()(!(this.props.render&&this.props.children&&!Ai(this.props.children)),"You should not use <Route render> and <Route children> in the same route; <Route children> will be ignored")},n.prototype.componentWillReceiveProps=function(t,e){xi()(!(t.location&&!this.props.location),'<Route> elements should not change from uncontrolled to controlled (or vice versa). You initially used no "location" prop and then provided one on a subsequent render.'),xi()(!(!t.location&&this.props.location),'<Route> elements should not change from controlled to uncontrolled (or vice versa). You provided a "location" prop initially but omitted it on a subsequent render.'),this.setState({match:this.computeMatch(t,e.router)})},n.prototype.render=function(){var e=this.state.match,n=this.props,o=n.children,r=n.component,i=n.render,a=this.context.router,s=a.history,l=a.route,u=a.staticContext,c={match:e,location:this.props.location||l.location,history:s,staticContext:u};return r?e?t.createElement(r,c):null:i?e?i(c):null:"function"==typeof o?o(c):o&&!Ai(o)?t.Children.only(o):null},n}(t.Component);Ni.propTypes={computedMatch:g().object,path:g().string,exact:g().bool,strict:g().bool,sensitive:g().bool,component:g().func,render:g().func,children:g().oneOfType([g().func,g().node]),location:g().object},Ni.contextTypes={router:g().shape({history:g().object.isRequired,route:g().object.isRequired,staticContext:g().object})},Ni.childContextTypes={router:g().object.isRequired};const Ii=Ni;var Ri=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};const Mi=function(e){var n=function(n){var o=n.wrappedComponentRef,r=function(t,e){var n={};for(var o in t)e.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}(n,["wrappedComponentRef"]);return t.createElement(Ii,{children:function(n){return t.createElement(e,Ri({},r,n,{ref:o}))}})};return n.displayName="withRouter("+(e.displayName||e.name)+")",n.WrappedComponent=e,n.propTypes={wrappedComponentRef:g().func},ki()(n,e)};function zi(t){return zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zi(t)}function Fi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Bi(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,Wi(o.key),o)}}function Di(t,e,n){return e=Zi(e),function(t,e){if(e&&("object"===zi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Ui()?Reflect.construct(e,n||[],Zi(t).constructor):e.apply(t,n))}function Ui(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Ui=function(){return!!t})()}function Zi(t){return Zi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zi(t)}function qi(t,e){return qi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qi(t,e)}function $i(t,e,n){return(e=Wi(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wi(t){var e=function(t,e){if("object"!=zi(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=zi(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zi(e)?e:e+""}var Hi=function(t){return window.decodeURI(t.replace(/:/g,"#"))},Vi=function(e){function n(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),$i(e=Di(this,n,[t]),"closeSearch",(function(){e.searchContainer.classList.remove("open")})),$i(e,"toggleSearch",(function(t){t.stopPropagation(),setTimeout((function(){e.searchInput.focus()}),50)})),$i(e,"handleSearchChange",(function(t){e.setState({searchText:t.target.value})})),$i(e,"handleSearchKeyDown",(function(t){"Enter"===t.key&&e.search()})),$i(e,"search",(function(){e.props.history.push({search:e.getQueryForPage(1)}),e.closeSearch()})),$i(e,"clearSearch",(function(){e.setState({searchText:""}),setTimeout((function(){e.search()}),0)})),$i(e,"sortChanged",(function(t){e.setState({sortKey:t}),setTimeout((function(){e.props.history.push({search:e.getQueryForPage(e.props.currentPage)})}),0)})),$i(e,"getQueryForPage",(function(t){return j.A.toSearchQuery({page:t,ordering:e.state.sortKey,search:e.state.searchText.replace(/#/g,":")})})),$i(e,"addTagAndSearch",(function(t){var n=t.detail;if(void 0!==n){var o=e.state.searchText;o+=""===o?"#"+n:" #"+n,e.setState({searchText:o}),setTimeout((function(){e.search()}),0)}}));var o=j.A.queryParams(t.location);return e.state={searchText:Hi(o.search||""),sortKey:o.ordering||"-created_at"},e.sortItems=[{key:"created_at",label:(0,s._)("Created on")},{key:"name",label:(0,s._)("Name")},{key:"tags",label:(0,s._)("Tags")},{key:"owner",label:(0,s._)("Owner")}],e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qi(t,e)}(n,e),o=n,(r=[{key:"componentDidMount",value:function(){document.addEventListener("onProjectListTagClicked",this.addTagAndSearch)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("onProjectListTagClicked",this.addTagAndSearch)}},{key:"render",value:function(){var e,n=this,o=this.props,r=o.itemsPerPage,i=o.totalItems,a=o.currentPage,l=this.state.searchText,u=null,c=null,h=t.createElement("ul",{className:"pagination pagination-sm toolbar "+(0!=i||l?" ":"hidden ")+(i/r<=1?"no-margin":"")},t.createElement("li",{className:"btn-group",ref:function(t){n.searchContainer=t}},t.createElement("a",{href:"javascript:void(0);",className:"dropdown-toggle","data-toggle-outside":!0,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",onClick:this.toggleSearch,title:(0,s._)("Search")},t.createElement("i",{className:"fa fa-search"})),t.createElement("ul",{className:"dropdown-menu dropdown-menu-right search-popup"},t.createElement("li",null,t.createElement("input",{type:"text",ref:function(t){n.searchInput=t},className:"form-control search theme-border-secondary-07",placeholder:(0,s._)("Search names or #tags"),spellCheck:"false",autoComplete:"false",value:l,onKeyDown:this.handleSearchKeyDown,onChange:this.handleSearchChange}),t.createElement("button",{onClick:this.search,className:"btn btn-sm btn-default"},t.createElement("i",{className:"fa fa-search"}))))),t.createElement("li",{className:"btn-group"},t.createElement("a",{href:"javascript:void(0);",className:"dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},t.createElement("i",{className:"fa fa-sort-alpha-down",title:(0,s._)("Sort")})),t.createElement(Ir,{selected:this.state.sortKey,items:this.sortItems,onChange:this.sortChanged})));if(this.props.currentSearch){var p=Hi(this.props.currentSearch);c=t.createElement("span",{className:"clear-search"},(0,s._)("Search results for:")," ",t.createElement("span",{className:"query"},p)," ",t.createElement("a",{href:"javascript:void(0);",onClick:this.clearSearch},""))}if(r&&r&&i>r){var f=Math.ceil(i/r),d=Math.max(1,a-Math.floor(3.5)),m=d+Math.min(f,7);m>f&&(d-=m-f-1,m-=m-f-1);var y=(e=Array(m-d).keys(),function(t){if(Array.isArray(t))return Fi(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return Fi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fi(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(t){return t+d-1}));u=t.createElement("ul",{className:"pagination pagination-sm"},t.createElement("li",{className:1===a?"disabled":""},t.createElement(wi,{to:{search:this.getQueryForPage(1)}},t.createElement("span",null,""))),y.map((function(e){return t.createElement("li",{key:e+1,className:a===e+1?"active":""},t.createElement(wi,{to:{search:n.getQueryForPage(e+1)}},e+1))})),t.createElement("li",{className:a===f?"disabled":""},t.createElement(wi,{to:{search:this.getQueryForPage(f)}},t.createElement("span",null,""))))}return[t.createElement("div",{key:"0",className:"text-right paginator"},c,h,u),this.props.children,t.createElement("div",{key:"2",className:"text-right paginator"},u)]}}])&&Bi(o.prototype,r),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,r}(t.Component);const Gi=Mi(Vi);function Yi(t){return Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yi(t)}function Ki(){return Ki=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Ki.apply(this,arguments)}function Qi(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,oa(o.key),o)}}function Ji(t,e,n){return e=ta(e),function(t,e){if(e&&("object"===Yi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Xi()?Reflect.construct(e,n||[],ta(t).constructor):e.apply(t,n))}function Xi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Xi=function(){return!!t})()}function ta(t){return ta=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ta(t)}function ea(t,e){return ea=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ea(t,e)}function na(t,e,n){return(e=oa(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oa(t){var e=function(t,e){if("object"!=Yi(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=Yi(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Yi(e)?e:e+""}var ra=function(e){function n(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),na(e=Ji(this,n,[t]),"handleTaskMoved",(function(t){e["projectListItem_"+t.project]&&e["projectListItem_"+t.project].newTaskAdded()})),na(e,"handleProjectDuplicated",(function(){e.refresh()})),e.state={loading:!0,refreshing:!1,error:"",projects:[]},e.PROJECTS_PER_PAGE=10,e.handleDelete=e.handleDelete.bind(e),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ea(t,e)}(n,e),r=n,(i=[{key:"componentDidMount",value:function(){this.refresh()}},{key:"getParametersHash",value:function(t){if(!t)return"";if(-1===t.indexOf("?"))return"";var e=t.substr(t.indexOf("?")),n=j.A.queryParams({search:e});return delete n.project_task_open,delete n.project_task_expanded,JSON.stringify(n)}},{key:"componentDidUpdate",value:function(t){this.getParametersHash(t.source)!==this.getParametersHash(this.props.source)&&this.refresh()}},{key:"refresh",value:function(){var t=this;this.setState({refreshing:!0}),this.serverRequest=o().getJSON(this.props.source,(function(e){e.results?(t.setState({projects:e.results,loading:!1}),t.updatePagination(t.PROJECTS_PER_PAGE,e.count)):t.setState({error:(0,s.interpolate)((0,s._)("Invalid JSON response: %(error)s"),{error:JSON.stringify(e)}),loading:!1})})).fail((function(e,n,o){t.setState({error:(0,s.interpolate)((0,s._)("Could not load projects list: %(error)s"),{error:n}),loading:!1})})).always((function(){t.setState({refreshing:!1})}))}},{key:"onPageChanged",value:function(t){this.refresh()}},{key:"componentWillUnmount",value:function(){this.serverRequest.abort()}},{key:"handleDelete",value:function(t){var e=this,n=this.state.projects.filter((function(e){return e.id!==t}));this.setState({projects:n}),this.handlePageItemsNumChange(-1,(function(){e.refresh()}))}},{key:"render",value:function(){var e=this;return this.state.loading?t.createElement("div",{className:"project-list text-center"},t.createElement("i",{className:"fa fa-sync fa-spin fa-2x fa-fw"})):t.createElement("div",{className:"project-list"},t.createElement(C,{bind:[this,"error"]}),t.createElement(Gi,Ki({},this.state.pagination,this.props),t.createElement("ul",{key:"1",className:"list-group project-list "+(this.state.refreshing?"refreshing":"")},this.state.projects.map((function(n){return t.createElement(Vr,{ref:function(t){e["projectListItem_"+n.id]=t},key:n.id,data:n,onDelete:e.handleDelete,onTaskMoved:e.handleTaskMoved,onProjectDuplicated:e.handleProjectDuplicated,history:e.props.history})})))))}}])&&Qi(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(oi);na(ra,"propTypes",{history:g().object.isRequired});const ia=ra;var aa=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function sa(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var la=function(e){function n(){var t,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=o=sa(this,e.call.apply(e,[this].concat(i))),o.state={match:o.computeMatch(o.props.history.location.pathname)},sa(o,t)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),n.prototype.getChildContext=function(){return{router:aa({},this.context.router,{history:this.props.history,route:{location:this.props.history.location,match:this.state.match}})}},n.prototype.computeMatch=function(t){return{path:"/",url:"/",params:{},isExact:"/"===t}},n.prototype.componentWillMount=function(){var e=this,n=this.props,o=n.children,r=n.history;ii()(null==o||1===t.Children.count(o),"A <Router> may have only one child element"),this.unlisten=r.listen((function(){e.setState({match:e.computeMatch(r.location.pathname)})}))},n.prototype.componentWillReceiveProps=function(t){xi()(this.props.history===t.history,"You cannot change <Router history>")},n.prototype.componentWillUnmount=function(){this.unlisten()},n.prototype.render=function(){var e=this.props.children;return e?t.Children.only(e):null},n}(t.Component);la.propTypes={history:g().object.isRequired,children:g().node},la.contextTypes={router:g().object},la.childContextTypes={router:g().object.isRequired};const ua=la;function ca(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var ha=function(e){function n(){var t,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=o=ca(this,e.call.apply(e,[this].concat(i))),o.history=gi(o.props),ca(o,t)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),n.prototype.componentWillMount=function(){xi()(!this.props.history,"<BrowserRouter> ignores the history prop. To use a custom history, use `import { Router }` instead of `import { BrowserRouter as Router }`.")},n.prototype.render=function(){return t.createElement(ua,{history:this.history,children:this.props.children})},n}(t.Component);ha.propTypes={basename:g().string,forceRefresh:g().bool,getUserConfirmation:g().func,keyLength:g().number,children:g().node};const pa=ha,fa=Ii;function da(t){return da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},da(t)}function ma(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,ya(o.key),o)}}function ya(t){var e=function(t,e){if("object"!=da(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,"string");if("object"!=da(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==da(e)?e:e+""}function ga(t,e,n){return e=ba(e),function(t,e){if(e&&("object"===da(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,va()?Reflect.construct(e,n||[],ba(t).constructor):e.apply(t,n))}function va(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(va=function(){return!!t})()}function ba(t){return ba=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ba(t)}function _a(t,e){return _a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_a(t,e)}var wa=function(e){function n(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(t=ga(this,n)).handleAddProject=t.handleAddProject.bind(t),t.addNewProject=t.addNewProject.bind(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_a(t,e)}(n,e),r=n,(i=[{key:"handleAddProject",value:function(){this.projectDialog.show()}},{key:"addNewProject",value:function(t){var e=this;return t.name?o().ajax({url:"/api/projects/",type:"POST",contentType:"application/json",data:JSON.stringify({name:t.name,description:t.descr,tags:t.tags})}).done((function(){e.projectList.refresh()})):(new(o().Deferred)).reject((0,s._)("Name field is required"))}},{key:"render",value:function(){var e=this;return t.createElement(pa,{basename:"/dashboard"},t.createElement("div",null,t.createElement("div",{className:"text-right add-button"},t.createElement("button",{type:"button",className:"btn btn-primary btn-sm",onClick:this.handleAddProject},t.createElement("i",{className:"glyphicon glyphicon-plus"}),(0,s._)("Add Project"))),t.createElement(Sr,{saveAction:this.addNewProject,ref:function(t){e.projectDialog=t}}),t.createElement(fa,{path:"/",component:function(n){var o=n.location,r=n.history,i=j.A.queryParams(o);return void 0===i.page?i.page=1:i.page=parseInt(i.page),t.createElement(ia,{source:"/api/projects/".concat(j.A.toSearchQuery(i)),ref:function(t){e.projectList=t},currentPage:i.page,currentSearch:i.search,history:r})}})))}}])&&ma(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i}(t.Component);o()((function(){o()("[data-dashboard]").each((function(){window.ReactDOM.render(t.createElement(wa,null),o()(this).get(0))})),window.onbeforeunload=function(){var t=!1;return o()(".progress-bar:visible").each((function(){try{var e=parseFloat(o()(this).text());!isNaN(e)&&e>0&&e<100&&(t=!0)}catch(t){}})),t?(0,s._)("Your changes will be lost. Are you sure you want to leave?"):void 0}}))})()})();